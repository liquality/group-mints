import{aF as Lc,aG as ui,aH as Io,aI as ne,aJ as Or,aK as Am,aL as rf,aM as nf,aN as jc,aO as xo,aP as Tm,aQ as jr,aR as ec,aS as sf,aT as xi,aU as Cm,aV as Nm,aW as Z,aX as $m,aY as mc,aZ as Dm,a_ as Fm,a$ as Lm,b0 as Wh,b1 as jm,b2 as qm,b3 as Mm,b4 as Jh,b5 as zm,b6 as Um,b7 as Yn,b8 as Qh,b9 as Hm,ba as Bm,bb as qc,bc as of,bd as Fr,be as km,bf as Km,bg as gn,bh as $t,bi as tr,bj as Ii,bk as hr,bl as Vm,bm as yn,bn as af,bo as Gm,bp as Wm,bq as Jm,br as cf,bs as Qm,bt as uf,bu as hf,bv as vn,bw as _c,bx as go,by as _n,bz as Ym,bA as yo,bB as Xm,bC as Zm,bD as e1,bE as co,bF as t1,bG as r1,bH as tc,bI as Yh,bJ as i1,bK as n1,bL as s1,bM as Xh,bN as o1,bO as a1,bP as c1,bQ as u1,bR as h1,bS as l1,bT as f1,bU as Gn,bV as lf,bW as rc,bX as p1,bY as d1,aD as g1}from"./index-97e4a7ae.js";const y1=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,v1=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,m1=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function _1(a,r){if(a==="__proto__"||a==="constructor"&&r&&typeof r=="object"&&"prototype"in r){w1(a);return}return r}function w1(a){console.warn(`[destr] Dropping "${a}" key to prevent prototype pollution.`)}function uo(a,r={}){if(typeof a!="string")return a;const t=a.trim();if(a[0]==='"'&&a.at(-1)==='"'&&!a.includes("\\"))return t.slice(1,-1);if(t.length<=9){const n=t.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!m1.test(a)){if(r.strict)throw new SyntaxError("[destr] Invalid JSON");return a}try{if(y1.test(a)||v1.test(a)){if(r.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(a,_1)}return JSON.parse(a)}catch(n){if(r.strict)throw n;return a}}function b1(a){return!a||typeof a.then!="function"?Promise.resolve(a):a}function zt(a,...r){try{return b1(a(...r))}catch(t){return Promise.reject(t)}}function E1(a){const r=typeof a;return a===null||r!=="object"&&r!=="function"}function I1(a){const r=Object.getPrototypeOf(a);return!r||r.isPrototypeOf(Object)}function vo(a){if(E1(a))return String(a);if(I1(a)||Array.isArray(a))return JSON.stringify(a);if(typeof a.toJSON=="function")return vo(a.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function ff(){if(typeof Lc.Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const wc="base64:";function x1(a){if(typeof a=="string")return a;ff();const r=Lc.Buffer.from(a).toString("base64");return wc+r}function P1(a){return typeof a!="string"||!a.startsWith(wc)?a:(ff(),Lc.Buffer.from(a.slice(wc.length),"base64"))}function ur(a){return a?a.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function S1(...a){return ur(a.join(":"))}function ho(a){return a=ur(a),a?a+":":""}const O1="memory",R1=()=>{const a=new Map;return{name:O1,options:{},hasItem(r){return a.has(r)},getItem(r){return a.get(r)??null},getItemRaw(r){return a.get(r)??null},setItem(r,t){a.set(r,t)},setItemRaw(r,t){a.set(r,t)},removeItem(r){a.delete(r)},getKeys(){return Array.from(a.keys())},clear(){a.clear()},dispose(){a.clear()}}};function A1(a={}){const r={mounts:{"":a.driver||R1()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},t=p=>{for(const b of r.mountpoints)if(p.startsWith(b))return{base:b,relativeKey:p.slice(b.length),driver:r.mounts[b]};return{base:"",relativeKey:p,driver:r.mounts[""]}},n=(p,b)=>r.mountpoints.filter(A=>A.startsWith(p)||b&&p.startsWith(A)).map(A=>({relativeBase:p.length>A.length?p.slice(A.length):void 0,mountpoint:A,driver:r.mounts[A]})),o=(p,b)=>{if(r.watching){b=ur(b);for(const A of r.watchListeners)A(p,b)}},c=async()=>{if(!r.watching){r.watching=!0;for(const p in r.mounts)r.unwatch[p]=await Zh(r.mounts[p],o,p)}},f=async()=>{if(r.watching){for(const p in r.unwatch)await r.unwatch[p]();r.unwatch={},r.watching=!1}},g=(p,b,A)=>{const x=new Map,D=C=>{let K=x.get(C.base);return K||(K={driver:C.driver,base:C.base,items:[]},x.set(C.base,K)),K};for(const C of p){const K=typeof C=="string",re=ur(K?C:C.key),he=K?void 0:C.value,le=K||!C.options?b:{...b,...C.options},fe=t(re);D(fe).items.push({key:re,value:he,relativeKey:fe.relativeKey,options:le})}return Promise.all([...x.values()].map(C=>A(C))).then(C=>C.flat())},_={hasItem(p,b={}){p=ur(p);const{relativeKey:A,driver:x}=t(p);return zt(x.hasItem,A,b)},getItem(p,b={}){p=ur(p);const{relativeKey:A,driver:x}=t(p);return zt(x.getItem,A,b).then(D=>uo(D))},getItems(p,b){return g(p,b,A=>A.driver.getItems?zt(A.driver.getItems,A.items.map(x=>({key:x.relativeKey,options:x.options})),b).then(x=>x.map(D=>({key:S1(A.base,D.key),value:uo(D.value)}))):Promise.all(A.items.map(x=>zt(A.driver.getItem,x.relativeKey,x.options).then(D=>({key:x.key,value:uo(D)})))))},getItemRaw(p,b={}){p=ur(p);const{relativeKey:A,driver:x}=t(p);return x.getItemRaw?zt(x.getItemRaw,A,b):zt(x.getItem,A,b).then(D=>P1(D))},async setItem(p,b,A={}){if(b===void 0)return _.removeItem(p);p=ur(p);const{relativeKey:x,driver:D}=t(p);D.setItem&&(await zt(D.setItem,x,vo(b),A),D.watch||o("update",p))},async setItems(p,b){await g(p,b,async A=>{A.driver.setItems&&await zt(A.driver.setItems,A.items.map(x=>({key:x.relativeKey,value:vo(x.value),options:x.options})),b),A.driver.setItem&&await Promise.all(A.items.map(x=>zt(A.driver.setItem,x.relativeKey,vo(x.value),x.options)))})},async setItemRaw(p,b,A={}){if(b===void 0)return _.removeItem(p,A);p=ur(p);const{relativeKey:x,driver:D}=t(p);if(D.setItemRaw)await zt(D.setItemRaw,x,b,A);else if(D.setItem)await zt(D.setItem,x,x1(b),A);else return;D.watch||o("update",p)},async removeItem(p,b={}){typeof b=="boolean"&&(b={removeMeta:b}),p=ur(p);const{relativeKey:A,driver:x}=t(p);x.removeItem&&(await zt(x.removeItem,A,b),(b.removeMeta||b.removeMata)&&await zt(x.removeItem,A+"$",b),x.watch||o("remove",p))},async getMeta(p,b={}){typeof b=="boolean"&&(b={nativeOnly:b}),p=ur(p);const{relativeKey:A,driver:x}=t(p),D=Object.create(null);if(x.getMeta&&Object.assign(D,await zt(x.getMeta,A,b)),!b.nativeOnly){const C=await zt(x.getItem,A+"$",b).then(K=>uo(K));C&&typeof C=="object"&&(typeof C.atime=="string"&&(C.atime=new Date(C.atime)),typeof C.mtime=="string"&&(C.mtime=new Date(C.mtime)),Object.assign(D,C))}return D},setMeta(p,b,A={}){return this.setItem(p+"$",b,A)},removeMeta(p,b={}){return this.removeItem(p+"$",b)},async getKeys(p,b={}){p=ho(p);const A=n(p,!0);let x=[];const D=[];for(const C of A){const re=(await zt(C.driver.getKeys,C.relativeBase,b)).map(he=>C.mountpoint+ur(he)).filter(he=>!x.some(le=>he.startsWith(le)));D.push(...re),x=[C.mountpoint,...x.filter(he=>!he.startsWith(C.mountpoint))]}return p?D.filter(C=>C.startsWith(p)&&!C.endsWith("$")):D.filter(C=>!C.endsWith("$"))},async clear(p,b={}){p=ho(p),await Promise.all(n(p,!1).map(async A=>{if(A.driver.clear)return zt(A.driver.clear,A.relativeBase,b);if(A.driver.removeItem){const x=await A.driver.getKeys(A.relativeBase||"",b);return Promise.all(x.map(D=>A.driver.removeItem(D,b)))}}))},async dispose(){await Promise.all(Object.values(r.mounts).map(p=>el(p)))},async watch(p){return await c(),r.watchListeners.push(p),async()=>{r.watchListeners=r.watchListeners.filter(b=>b!==p),r.watchListeners.length===0&&await f()}},async unwatch(){r.watchListeners=[],await f()},mount(p,b){if(p=ho(p),p&&r.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(r.mountpoints.push(p),r.mountpoints.sort((A,x)=>x.length-A.length)),r.mounts[p]=b,r.watching&&Promise.resolve(Zh(b,o,p)).then(A=>{r.unwatch[p]=A}).catch(console.error),_},async unmount(p,b=!0){p=ho(p),!(!p||!r.mounts[p])&&(r.watching&&p in r.unwatch&&(r.unwatch[p](),delete r.unwatch[p]),b&&await el(r.mounts[p]),r.mountpoints=r.mountpoints.filter(A=>A!==p),delete r.mounts[p])},getMount(p=""){p=ur(p)+":";const b=t(p);return{driver:b.driver,base:b.base}},getMounts(p="",b={}){return p=ur(p),n(p,b.parents).map(x=>({driver:x.driver,base:x.mountpoint}))}};return _}function Zh(a,r,t){return a.watch?a.watch((n,o)=>r(n,t+o)):()=>{}}async function el(a){typeof a.dispose=="function"&&await zt(a.dispose)}function Ki(a){return new Promise((r,t)=>{a.oncomplete=a.onsuccess=()=>r(a.result),a.onabort=a.onerror=()=>t(a.error)})}function pf(a,r){const t=indexedDB.open(a);t.onupgradeneeded=()=>t.result.createObjectStore(r);const n=Ki(t);return(o,c)=>n.then(f=>c(f.transaction(r,o).objectStore(r)))}let ic;function ts(){return ic||(ic=pf("keyval-store","keyval")),ic}function tl(a,r=ts()){return r("readonly",t=>Ki(t.get(a)))}function T1(a,r,t=ts()){return t("readwrite",n=>(n.put(r,a),Ki(n.transaction)))}function C1(a,r=ts()){return r("readwrite",t=>(t.delete(a),Ki(t.transaction)))}function N1(a=ts()){return a("readwrite",r=>(r.clear(),Ki(r.transaction)))}function $1(a,r){return a.openCursor().onsuccess=function(){this.result&&(r(this.result),this.result.continue())},Ki(a.transaction)}function D1(a=ts()){return a("readonly",r=>{if(r.getAllKeys)return Ki(r.getAllKeys());const t=[];return $1(r,n=>t.push(n.key)).then(()=>t)})}const F1=a=>JSON.stringify(a,(r,t)=>typeof t=="bigint"?t.toString()+"n":t),L1=a=>{const r=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=a.replace(r,'$1"$2n"$3');return JSON.parse(t,(n,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function rs(a){if(typeof a!="string")throw new Error(`Cannot safe json parse value of type ${typeof a}`);try{return L1(a)}catch{return a}}function ki(a){return typeof a=="string"?a:F1(a)||""}const j1="idb-keyval";var q1=(a={})=>{const r=a.base&&a.base.length>0?`${a.base}:`:"",t=o=>r+o;let n;return a.dbName&&a.storeName&&(n=pf(a.dbName,a.storeName)),{name:j1,options:a,async hasItem(o){return!(typeof await tl(t(o),n)>"u")},async getItem(o){return await tl(t(o),n)??null},setItem(o,c){return T1(t(o),c,n)},removeItem(o){return C1(t(o),n)},getKeys(){return D1(n)},clear(){return N1(n)}}};const M1="WALLET_CONNECT_V2_INDEXED_DB",z1="keyvaluestorage";let U1=class{constructor(){this.indexedDb=A1({driver:q1({dbName:M1,storeName:z1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(r=>[r.key,r.value])}async getItem(r){const t=await this.indexedDb.getItem(r);if(t!==null)return t}async setItem(r,t){await this.indexedDb.setItem(r,ki(t))}async removeItem(r){await this.indexedDb.removeItem(r)}};var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ui<"u"?ui:typeof self<"u"?self:{},mo={exports:{}};(function(){let a;function r(){}a=r,a.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},a.prototype.setItem=function(t,n){this[t]=String(n)},a.prototype.removeItem=function(t){delete this[t]},a.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(n){t[n]=void 0,delete t[n]})},a.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},a.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof nc<"u"&&nc.localStorage?mo.exports=nc.localStorage:typeof window<"u"&&window.localStorage?mo.exports=window.localStorage:mo.exports=new r})();function H1(a){var r;return[a[0],rs((r=a[1])!=null?r:"")]}let B1=class{constructor(){this.localStorage=mo.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(H1)}async getItem(r){const t=this.localStorage.getItem(r);if(t!==null)return rs(t)}async setItem(r,t){this.localStorage.setItem(r,ki(t))}async removeItem(r){this.localStorage.removeItem(r)}};const k1="wc_storage_version",rl=1,K1=async(a,r,t)=>{const n=k1,o=await r.getItem(n);if(o&&o>=rl){t(r);return}const c=await a.getKeys();if(!c.length){t(r);return}const f=[];for(;c.length;){const g=c.shift();if(!g)continue;const _=g.toLowerCase();if(_.includes("wc@")||_.includes("walletconnect")||_.includes("wc_")||_.includes("wallet_connect")){const p=await a.getItem(g);await r.setItem(g,p),f.push(g)}}await r.setItem(n,rl),t(r),V1(a,f)},V1=async(a,r)=>{r.length&&r.forEach(async t=>{await a.removeItem(t)})};let G1=class{constructor(){this.initialized=!1,this.setInitialized=t=>{this.storage=t,this.initialized=!0};const r=new B1;this.storage=r;try{const t=new U1;K1(r,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(r){return await this.initialize(),this.storage.getItem(r)}async setItem(r,t){return await this.initialize(),this.storage.setItem(r,t)}async removeItem(r){return await this.initialize(),this.storage.removeItem(r)}async initialize(){this.initialized||await new Promise(r=>{const t=setInterval(()=>{this.initialized&&(clearInterval(t),r())},20)})}};var wn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var bc=function(a,r){return bc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},bc(a,r)};function W1(a,r){bc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Ec=function(){return Ec=Object.assign||function(r){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},Ec.apply(this,arguments)};function J1(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(t[n[o]]=a[n[o]]);return t}function Q1(a,r,t,n){var o=arguments.length,c=o<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var g=a.length-1;g>=0;g--)(f=a[g])&&(c=(o<3?f(c):o>3?f(r,t,c):f(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c}function Y1(a,r){return function(t,n){r(t,n,a)}}function X1(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function Z1(a,r,t,n){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function g(b){try{p(n.next(b))}catch(A){f(A)}}function _(b){try{p(n.throw(b))}catch(A){f(A)}}function p(b){b.done?c(b.value):o(b.value).then(g,_)}p((n=n.apply(a,r||[])).next())})}function e_(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=r.call(a,t)}catch(b){p=[6,b],o=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function t_(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function r_(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function Ic(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function df(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),o,c=[],f;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(f)throw f.error}}return c}function i_(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(df(arguments[r]));return a}function n_(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),o=0,r=0;r<t;r++)for(var c=arguments[r],f=0,g=c.length;f<g;f++,o++)n[o]=c[f];return n}function Xn(a){return this instanceof Xn?(this.v=a,this):new Xn(a)}function s_(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(x){n[x]&&(o[x]=function(D){return new Promise(function(C,K){c.push([x,D,C,K])>1||g(x,D)})})}function g(x,D){try{_(n[x](D))}catch(C){A(c[0][3],C)}}function _(x){x.value instanceof Xn?Promise.resolve(x.value.v).then(p,b):A(c[0][2],x)}function p(x){g("next",x)}function b(x){g("throw",x)}function A(x,D){x(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function o_(a){var r,t;return r={},n("next"),n("throw",function(o){throw o}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(o,c){r[o]=a[o]?function(f){return(t=!t)?{value:Xn(a[o](f)),done:o==="return"}:c?c(f):f}:c}}function a_(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof Ic=="function"?Ic(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(f){return new Promise(function(g,_){f=a[c](f),o(g,_,f.done,f.value)})}}function o(c,f,g,_){Promise.resolve(_).then(function(p){c({value:p,done:g})},f)}}function c_(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function u_(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function h_(a){return a&&a.__esModule?a:{default:a}}function l_(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function f_(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const p_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ec},__asyncDelegator:o_,__asyncGenerator:s_,__asyncValues:a_,__await:Xn,__awaiter:Z1,__classPrivateFieldGet:l_,__classPrivateFieldSet:f_,__createBinding:t_,__decorate:Q1,__exportStar:r_,__extends:W1,__generator:e_,__importDefault:h_,__importStar:u_,__makeTemplateObject:c_,__metadata:X1,__param:Y1,__read:df,__rest:J1,__spread:i_,__spreadArrays:n_,__values:Ic},Symbol.toStringTag,{value:"Module"})),Po=Io(p_);var zn={},sc={},Un={};let Vi=class{};const d_=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Vi},Symbol.toStringTag,{value:"Module"})),g_=Io(d_);var il;function y_(){if(il)return Un;il=1,Object.defineProperty(Un,"__esModule",{value:!0}),Un.IHeartBeat=void 0;const a=g_;class r extends a.IEvents{constructor(n){super()}}return Un.IHeartBeat=r,Un}var nl;function gf(){return nl||(nl=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Po.__exportStar(y_(),a)}(sc)),sc}var oc={},Hi={},sl;function v_(){if(sl)return Hi;sl=1,Object.defineProperty(Hi,"__esModule",{value:!0}),Hi.HEARTBEAT_EVENTS=Hi.HEARTBEAT_INTERVAL=void 0;const a=ne;return Hi.HEARTBEAT_INTERVAL=a.FIVE_SECONDS,Hi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Hi}var ol;function yf(){return ol||(ol=1,function(a){Object.defineProperty(a,"__esModule",{value:!0}),Po.__exportStar(v_(),a)}(oc)),oc}var al;function m_(){if(al)return zn;al=1,Object.defineProperty(zn,"__esModule",{value:!0}),zn.HeartBeat=void 0;const a=Po,r=Or,t=ne,n=gf(),o=yf();class c extends n.IHeartBeat{constructor(g){super(g),this.events=new r.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=g?.interval||o.HEARTBEAT_INTERVAL}static init(g){return a.__awaiter(this,void 0,void 0,function*(){const _=new c(g);return yield _.init(),_})}init(){return a.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,_){this.events.on(g,_)}once(g,_){this.events.once(g,_)}off(g,_){this.events.off(g,_)}removeListener(g,_){this.events.removeListener(g,_)}initialize(){return a.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return zn.HeartBeat=c,zn}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Po;r.__exportStar(m_(),a),r.__exportStar(gf(),a),r.__exportStar(yf(),a)})(wn);var Te={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var xc=function(a,r){return xc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},xc(a,r)};function __(a,r){xc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Pc=function(){return Pc=Object.assign||function(r){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},Pc.apply(this,arguments)};function w_(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(t[n[o]]=a[n[o]]);return t}function b_(a,r,t,n){var o=arguments.length,c=o<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var g=a.length-1;g>=0;g--)(f=a[g])&&(c=(o<3?f(c):o>3?f(r,t,c):f(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c}function E_(a,r){return function(t,n){r(t,n,a)}}function I_(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function x_(a,r,t,n){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function g(b){try{p(n.next(b))}catch(A){f(A)}}function _(b){try{p(n.throw(b))}catch(A){f(A)}}function p(b){b.done?c(b.value):o(b.value).then(g,_)}p((n=n.apply(a,r||[])).next())})}function P_(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=r.call(a,t)}catch(b){p=[6,b],o=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function S_(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function O_(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function Sc(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function vf(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),o,c=[],f;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(f)throw f.error}}return c}function R_(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(vf(arguments[r]));return a}function A_(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),o=0,r=0;r<t;r++)for(var c=arguments[r],f=0,g=c.length;f<g;f++,o++)n[o]=c[f];return n}function Zn(a){return this instanceof Zn?(this.v=a,this):new Zn(a)}function T_(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(x){n[x]&&(o[x]=function(D){return new Promise(function(C,K){c.push([x,D,C,K])>1||g(x,D)})})}function g(x,D){try{_(n[x](D))}catch(C){A(c[0][3],C)}}function _(x){x.value instanceof Zn?Promise.resolve(x.value.v).then(p,b):A(c[0][2],x)}function p(x){g("next",x)}function b(x){g("throw",x)}function A(x,D){x(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function C_(a){var r,t;return r={},n("next"),n("throw",function(o){throw o}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(o,c){r[o]=a[o]?function(f){return(t=!t)?{value:Zn(a[o](f)),done:o==="return"}:c?c(f):f}:c}}function N_(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof Sc=="function"?Sc(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(f){return new Promise(function(g,_){f=a[c](f),o(g,_,f.done,f.value)})}}function o(c,f,g,_){Promise.resolve(_).then(function(p){c({value:p,done:g})},f)}}function $_(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function D_(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function F_(a){return a&&a.__esModule?a:{default:a}}function L_(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function j_(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const q_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Pc},__asyncDelegator:C_,__asyncGenerator:T_,__asyncValues:N_,__await:Zn,__awaiter:x_,__classPrivateFieldGet:L_,__classPrivateFieldSet:j_,__createBinding:S_,__decorate:b_,__exportStar:O_,__extends:__,__generator:P_,__importDefault:F_,__importStar:D_,__makeTemplateObject:$_,__metadata:I_,__param:E_,__read:vf,__rest:w_,__spread:R_,__spreadArrays:A_,__values:Sc},Symbol.toStringTag,{value:"Module"})),M_=Io(q_);var ac,cl;function z_(){if(cl)return ac;cl=1;function a(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}ac=r;function r(t,n,o){var c=o&&o.stringify||a,f=1;if(typeof t=="object"&&t!==null){var g=n.length+f;if(g===1)return t;var _=new Array(g);_[0]=c(t);for(var p=1;p<g;p++)_[p]=c(n[p]);return _.join(" ")}if(typeof t!="string")return t;var b=n.length;if(b===0)return t;for(var A="",x=1-f,D=-1,C=t&&t.length||0,K=0;K<C;){if(t.charCodeAt(K)===37&&K+1<C){switch(D=D>-1?D:0,t.charCodeAt(K+1)){case 100:case 102:if(x>=b||n[x]==null)break;D<K&&(A+=t.slice(D,K)),A+=Number(n[x]),D=K+2,K++;break;case 105:if(x>=b||n[x]==null)break;D<K&&(A+=t.slice(D,K)),A+=Math.floor(Number(n[x])),D=K+2,K++;break;case 79:case 111:case 106:if(x>=b||n[x]===void 0)break;D<K&&(A+=t.slice(D,K));var re=typeof n[x];if(re==="string"){A+="'"+n[x]+"'",D=K+2,K++;break}if(re==="function"){A+=n[x].name||"<anonymous>",D=K+2,K++;break}A+=c(n[x]),D=K+2,K++;break;case 115:if(x>=b)break;D<K&&(A+=t.slice(D,K)),A+=String(n[x]),D=K+2,K++;break;case 37:D<K&&(A+=t.slice(D,K)),A+="%",D=K+2,K++,x--;break}++x}++K}return D===-1?t:(D<C&&(A+=t.slice(D)),A)}return ac}var cc,ul;function U_(){if(ul)return cc;ul=1;const a=z_();cc=o;const r=de().console||{},t={mapHttpRequest:C,mapHttpResponse:C,wrapRequestSerializer:K,wrapResponseSerializer:K,wrapErrorSerializer:K,req:C,res:C,err:x};function n(L,U){return Array.isArray(L)?L.filter(function(ve){return ve!=="!stdSerializers.err"}):L===!0?Object.keys(U):!1}function o(L){L=L||{},L.browser=L.browser||{};const U=L.browser.transmit;if(U&&typeof U.send!="function")throw Error("pino: transmit option must have a send function");const W=L.browser.write||r;L.browser.write&&(L.browser.asObject=!0);const ve=L.serializers||{},ie=n(L.browser.serialize,ve);let ue=L.browser.serialize;Array.isArray(L.browser.serialize)&&L.browser.serialize.indexOf("!stdSerializers.err")>-1&&(ue=!1);const Ce=["error","fatal","warn","info","debug","trace"];typeof W=="function"&&(W.error=W.fatal=W.warn=W.info=W.debug=W.trace=W),L.enabled===!1&&(L.level="silent");const ze=L.level||"info",m=Object.create(W);m.log||(m.log=re),Object.defineProperty(m,"levelVal",{get:Y}),Object.defineProperty(m,"level",{get:ce,set:V});const P={transmit:U,serialize:ie,asObject:L.browser.asObject,levels:Ce,timestamp:D(L)};m.levels=o.levels,m.level=ze,m.setMaxListeners=m.getMaxListeners=m.emit=m.addListener=m.on=m.prependListener=m.once=m.prependOnceListener=m.removeListener=m.removeAllListeners=m.listeners=m.listenerCount=m.eventNames=m.write=m.flush=re,m.serializers=ve,m._serialize=ie,m._stdErrSerialize=ue,m.child=H,U&&(m._logEvent=A());function Y(){return this.level==="silent"?1/0:this.levels.values[this.level]}function ce(){return this._level}function V(k){if(k!=="silent"&&!this.levels.values[k])throw Error("unknown level "+k);this._level=k,c(P,m,"error","log"),c(P,m,"fatal","error"),c(P,m,"warn","error"),c(P,m,"info","log"),c(P,m,"debug","log"),c(P,m,"trace","log")}function H(k,G){if(!k)throw new Error("missing bindings for child Pino");G=G||{},ie&&k.serializers&&(G.serializers=k.serializers);const Je=G.serializers;if(ie&&Je){var Be=Object.assign({},ve,Je),qr=L.browser.serialize===!0?Object.keys(Be):ie;delete k.serializers,_([k],qr,Be,this._stdErrSerialize)}function Ie(It){this._childLevel=(It._childLevel|0)+1,this.error=p(It,k,"error"),this.fatal=p(It,k,"fatal"),this.warn=p(It,k,"warn"),this.info=p(It,k,"info"),this.debug=p(It,k,"debug"),this.trace=p(It,k,"trace"),Be&&(this.serializers=Be,this._serialize=qr),U&&(this._logEvent=A([].concat(It._logEvent.bindings,k)))}return Ie.prototype=this,new Ie(this)}return m}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:he,epochTime:le,unixTime:fe,isoTime:pe});function c(L,U,W,ve){const ie=Object.getPrototypeOf(U);U[W]=U.levelVal>U.levels.values[W]?re:ie[W]?ie[W]:r[W]||r[ve]||re,f(L,U,W)}function f(L,U,W){!L.transmit&&U[W]===re||(U[W]=function(ve){return function(){const ue=L.timestamp(),Ce=new Array(arguments.length),ze=Object.getPrototypeOf&&Object.getPrototypeOf(this)===r?r:this;for(var m=0;m<Ce.length;m++)Ce[m]=arguments[m];if(L.serialize&&!L.asObject&&_(Ce,this._serialize,this.serializers,this._stdErrSerialize),L.asObject?ve.call(ze,g(this,W,Ce,ue)):ve.apply(ze,Ce),L.transmit){const P=L.transmit.level||U.level,Y=o.levels.values[P],ce=o.levels.values[W];if(ce<Y)return;b(this,{ts:ue,methodLevel:W,methodValue:ce,transmitLevel:P,transmitValue:o.levels.values[L.transmit.level||U.level],send:L.transmit.send,val:U.levelVal},Ce)}}}(U[W]))}function g(L,U,W,ve){L._serialize&&_(W,L._serialize,L.serializers,L._stdErrSerialize);const ie=W.slice();let ue=ie[0];const Ce={};ve&&(Ce.time=ve),Ce.level=o.levels.values[U];let ze=(L._childLevel|0)+1;if(ze<1&&(ze=1),ue!==null&&typeof ue=="object"){for(;ze--&&typeof ie[0]=="object";)Object.assign(Ce,ie.shift());ue=ie.length?a(ie.shift(),ie):void 0}else typeof ue=="string"&&(ue=a(ie.shift(),ie));return ue!==void 0&&(Ce.msg=ue),Ce}function _(L,U,W,ve){for(const ie in L)if(ve&&L[ie]instanceof Error)L[ie]=o.stdSerializers.err(L[ie]);else if(typeof L[ie]=="object"&&!Array.isArray(L[ie]))for(const ue in L[ie])U&&U.indexOf(ue)>-1&&ue in W&&(L[ie][ue]=W[ue](L[ie][ue]))}function p(L,U,W){return function(){const ve=new Array(1+arguments.length);ve[0]=U;for(var ie=1;ie<ve.length;ie++)ve[ie]=arguments[ie-1];return L[W].apply(this,ve)}}function b(L,U,W){const ve=U.send,ie=U.ts,ue=U.methodLevel,Ce=U.methodValue,ze=U.val,m=L._logEvent.bindings;_(W,L._serialize||Object.keys(L.serializers),L.serializers,L._stdErrSerialize===void 0?!0:L._stdErrSerialize),L._logEvent.ts=ie,L._logEvent.messages=W.filter(function(P){return m.indexOf(P)===-1}),L._logEvent.level.label=ue,L._logEvent.level.value=Ce,ve(ue,L._logEvent,ze),L._logEvent=A(m)}function A(L){return{ts:0,messages:[],bindings:L||[],level:{label:"",value:0}}}function x(L){const U={type:L.constructor.name,msg:L.message,stack:L.stack};for(const W in L)U[W]===void 0&&(U[W]=L[W]);return U}function D(L){return typeof L.timestamp=="function"?L.timestamp:L.timestamp===!1?he:le}function C(){return{}}function K(L){return L}function re(){}function he(){return!1}function le(){return Date.now()}function fe(){return Math.round(Date.now()/1e3)}function pe(){return new Date(Date.now()).toISOString()}function de(){function L(U){return typeof U<"u"&&U}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return L(self)||L(window)||L(this)||{}}}return cc}var Bi={},hl;function mf(){return hl||(hl=1,Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.PINO_CUSTOM_CONTEXT_KEY=Bi.PINO_LOGGER_DEFAULTS=void 0,Bi.PINO_LOGGER_DEFAULTS={level:"info"},Bi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Bi}var er={},ll;function H_(){if(ll)return er;ll=1,Object.defineProperty(er,"__esModule",{value:!0}),er.generateChildLogger=er.formatChildLoggerContext=er.getLoggerContext=er.setBrowserLoggerContext=er.getBrowserLoggerContext=er.getDefaultLoggerOptions=void 0;const a=mf();function r(g){return Object.assign(Object.assign({},g),{level:g?.level||a.PINO_LOGGER_DEFAULTS.level})}er.getDefaultLoggerOptions=r;function t(g,_=a.PINO_CUSTOM_CONTEXT_KEY){return g[_]||""}er.getBrowserLoggerContext=t;function n(g,_,p=a.PINO_CUSTOM_CONTEXT_KEY){return g[p]=_,g}er.setBrowserLoggerContext=n;function o(g,_=a.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof g.bindings>"u"?p=t(g,_):p=g.bindings().context||"",p}er.getLoggerContext=o;function c(g,_,p=a.PINO_CUSTOM_CONTEXT_KEY){const b=o(g,p);return b.trim()?`${b}/${_}`:_}er.formatChildLoggerContext=c;function f(g,_,p=a.PINO_CUSTOM_CONTEXT_KEY){const b=c(g,_,p),A=g.child({context:b});return n(A,b,p)}return er.generateChildLogger=f,er}(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.pino=void 0;const r=M_,t=r.__importDefault(U_());Object.defineProperty(a,"pino",{enumerable:!0,get:function(){return t.default}}),r.__exportStar(mf(),a),r.__exportStar(H_(),a)})(Te);class B_ extends Vi{constructor(r){super(),this.opts=r,this.protocol="wc",this.version=2}}class k_ extends Vi{constructor(r,t){super(),this.core=r,this.logger=t,this.records=new Map}}class K_{constructor(r,t){this.logger=r,this.core=t}}let V_=class extends Vi{constructor(r,t){super(),this.relayer=r,this.logger=t}},G_=class extends Vi{constructor(r){super()}},W_=class{constructor(r,t,n,o){this.core=r,this.logger=t,this.name=n}};class J_ extends Vi{constructor(r,t){super(),this.relayer=r,this.logger=t}}let Q_=class extends Vi{constructor(r,t){super(),this.core=r,this.logger=t}},Y_=class{constructor(r,t){this.projectId=r,this.logger=t}},X_=class{constructor(r){this.opts=r,this.protocol="wc",this.version=2}},Z_=class{constructor(r){this.client=r}};var Mc={},_f={};(function(a){Object.defineProperty(a,"__esModule",{value:!0});var r=Am,t=rf;a.DIGEST_LENGTH=64,a.BLOCK_SIZE=128;var n=function(){function g(){this.digestLength=a.DIGEST_LENGTH,this.blockSize=a.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},g.prototype.update=function(_,p){if(p===void 0&&(p=_.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<a.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=_[b++],p--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(b=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,_,b,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=_[b++],p--;return this},g.prototype.finish=function(_){if(!this._finished){var p=this._bytesHashed,b=this._bufferLength,A=p/536870912|0,x=p<<3,D=p%128<112?128:256;this._buffer[b]=128;for(var C=b+1;C<D-8;C++)this._buffer[C]=0;r.writeUint32BE(A,this._buffer,D-8),r.writeUint32BE(x,this._buffer,D-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,D),this._finished=!0}for(var C=0;C<this.digestLength/8;C++)r.writeUint32BE(this._stateHi[C],_,C*8),r.writeUint32BE(this._stateLo[C],_,C*8+4);return this},g.prototype.digest=function(){var _=new Uint8Array(this.digestLength);return this.finish(_),_},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(_){return this._stateHi.set(_.stateHi),this._stateLo.set(_.stateLo),this._bufferLength=_.bufferLength,_.buffer&&this._buffer.set(_.buffer),this._bytesHashed=_.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(_){t.wipe(_.stateHi),t.wipe(_.stateLo),_.buffer&&t.wipe(_.buffer),_.bufferLength=0,_.bytesHashed=0},g}();a.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(g,_,p,b,A,x,D){for(var C=p[0],K=p[1],re=p[2],he=p[3],le=p[4],fe=p[5],pe=p[6],de=p[7],L=b[0],U=b[1],W=b[2],ve=b[3],ie=b[4],ue=b[5],Ce=b[6],ze=b[7],m,P,Y,ce,V,H,k,G;D>=128;){for(var Je=0;Je<16;Je++){var Be=8*Je+x;g[Je]=r.readUint32BE(A,Be),_[Je]=r.readUint32BE(A,Be+4)}for(var Je=0;Je<80;Je++){var qr=C,Ie=K,It=re,F=he,$=le,T=fe,h=pe,I=de,ee=L,ge=U,be=W,Ne=ve,De=ie,Se=ue,xt=Ce,mt=ze;if(m=de,P=ze,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=(le>>>14|ie<<32-14)^(le>>>18|ie<<32-18)^(ie>>>41-32|le<<32-(41-32)),P=(ie>>>14|le<<32-14)^(ie>>>18|le<<32-18)^(le>>>41-32|ie<<32-(41-32)),V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,m=le&fe^~le&pe,P=ie&ue^~ie&Ce,V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,m=o[Je*2],P=o[Je*2+1],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,m=g[Je%16],P=_[Je%16],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,Y=k&65535|G<<16,ce=V&65535|H<<16,m=Y,P=ce,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=(C>>>28|L<<32-28)^(L>>>34-32|C<<32-(34-32))^(L>>>39-32|C<<32-(39-32)),P=(L>>>28|C<<32-28)^(C>>>34-32|L<<32-(34-32))^(C>>>39-32|L<<32-(39-32)),V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,m=C&K^C&re^K&re,P=L&U^L&W^U&W,V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,I=k&65535|G<<16,mt=V&65535|H<<16,m=F,P=Ne,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=Y,P=ce,V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,F=k&65535|G<<16,Ne=V&65535|H<<16,K=qr,re=Ie,he=It,le=F,fe=$,pe=T,de=h,C=I,U=ee,W=ge,ve=be,ie=Ne,ue=De,Ce=Se,ze=xt,L=mt,Je%16===15)for(var Be=0;Be<16;Be++)m=g[Be],P=_[Be],V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=g[(Be+9)%16],P=_[(Be+9)%16],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,Y=g[(Be+1)%16],ce=_[(Be+1)%16],m=(Y>>>1|ce<<32-1)^(Y>>>8|ce<<32-8)^Y>>>7,P=(ce>>>1|Y<<32-1)^(ce>>>8|Y<<32-8)^(ce>>>7|Y<<32-7),V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,Y=g[(Be+14)%16],ce=_[(Be+14)%16],m=(Y>>>19|ce<<32-19)^(ce>>>61-32|Y<<32-(61-32))^Y>>>6,P=(ce>>>19|Y<<32-19)^(Y>>>61-32|ce<<32-(61-32))^(ce>>>6|Y<<32-6),V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,g[Be]=k&65535|G<<16,_[Be]=V&65535|H<<16}m=C,P=L,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[0],P=b[0],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[0]=C=k&65535|G<<16,b[0]=L=V&65535|H<<16,m=K,P=U,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[1],P=b[1],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[1]=K=k&65535|G<<16,b[1]=U=V&65535|H<<16,m=re,P=W,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[2],P=b[2],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[2]=re=k&65535|G<<16,b[2]=W=V&65535|H<<16,m=he,P=ve,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[3],P=b[3],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[3]=he=k&65535|G<<16,b[3]=ve=V&65535|H<<16,m=le,P=ie,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[4],P=b[4],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[4]=le=k&65535|G<<16,b[4]=ie=V&65535|H<<16,m=fe,P=ue,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[5],P=b[5],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[5]=fe=k&65535|G<<16,b[5]=ue=V&65535|H<<16,m=pe,P=Ce,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[6],P=b[6],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[6]=pe=k&65535|G<<16,b[6]=Ce=V&65535|H<<16,m=de,P=ze,V=P&65535,H=P>>>16,k=m&65535,G=m>>>16,m=p[7],P=b[7],V+=P&65535,H+=P>>>16,k+=m&65535,G+=m>>>16,H+=V>>>16,k+=H>>>16,G+=k>>>16,p[7]=de=k&65535|G<<16,b[7]=ze=V&65535|H<<16,x+=128,D-=128}return x}function f(g){var _=new n;_.update(g);var p=_.digest();return _.clean(),p}a.hash=f})(_f);(function(a){Object.defineProperty(a,"__esModule",{value:!0}),a.convertSecretKeyToX25519=a.convertPublicKeyToX25519=a.verify=a.sign=a.extractPublicKeyFromSecretKey=a.generateKeyPair=a.generateKeyPairFromSeed=a.SEED_LENGTH=a.SECRET_KEY_LENGTH=a.PUBLIC_KEY_LENGTH=a.SIGNATURE_LENGTH=void 0;const r=nf,t=_f,n=rf;a.SIGNATURE_LENGTH=64,a.PUBLIC_KEY_LENGTH=32,a.SECRET_KEY_LENGTH=64,a.SEED_LENGTH=32;function o(F){const $=new Float64Array(16);if(F)for(let T=0;T<F.length;T++)$[T]=F[T];return $}const c=new Uint8Array(32);c[0]=9;const f=o(),g=o([1]),_=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),A=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),x=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function D(F,$){for(let T=0;T<16;T++)F[T]=$[T]|0}function C(F){let $=1;for(let T=0;T<16;T++){let h=F[T]+$+65535;$=Math.floor(h/65536),F[T]=h-$*65536}F[0]+=$-1+37*($-1)}function K(F,$,T){const h=~(T-1);for(let I=0;I<16;I++){const ee=h&(F[I]^$[I]);F[I]^=ee,$[I]^=ee}}function re(F,$){const T=o(),h=o();for(let I=0;I<16;I++)h[I]=$[I];C(h),C(h),C(h);for(let I=0;I<2;I++){T[0]=h[0]-65517;for(let ge=1;ge<15;ge++)T[ge]=h[ge]-65535-(T[ge-1]>>16&1),T[ge-1]&=65535;T[15]=h[15]-32767-(T[14]>>16&1);const ee=T[15]>>16&1;T[14]&=65535,K(h,T,1-ee)}for(let I=0;I<16;I++)F[2*I]=h[I]&255,F[2*I+1]=h[I]>>8}function he(F,$){let T=0;for(let h=0;h<32;h++)T|=F[h]^$[h];return(1&T-1>>>8)-1}function le(F,$){const T=new Uint8Array(32),h=new Uint8Array(32);return re(T,F),re(h,$),he(T,h)}function fe(F){const $=new Uint8Array(32);return re($,F),$[0]&1}function pe(F,$){for(let T=0;T<16;T++)F[T]=$[2*T]+($[2*T+1]<<8);F[15]&=32767}function de(F,$,T){for(let h=0;h<16;h++)F[h]=$[h]+T[h]}function L(F,$,T){for(let h=0;h<16;h++)F[h]=$[h]-T[h]}function U(F,$,T){let h,I,ee=0,ge=0,be=0,Ne=0,De=0,Se=0,xt=0,mt=0,ot=0,Le=0,Ye=0,Xe=0,at=0,Ue=0,Ze=0,$e=0,ke=0,ht=0,qe=0,Pt=0,Dt=0,Ut=0,Ht=0,jt=0,Wt=0,rr=0,Mr=0,Jt=0,Vr=0,fi=0,Ri=0,lt=T[0],rt=T[1],ft=T[2],pt=T[3],ct=T[4],it=T[5],St=T[6],Ot=T[7],dt=T[8],Rt=T[9],gt=T[10],_t=T[11],yt=T[12],Qe=T[13],At=T[14],Tt=T[15];h=$[0],ee+=h*lt,ge+=h*rt,be+=h*ft,Ne+=h*pt,De+=h*ct,Se+=h*it,xt+=h*St,mt+=h*Ot,ot+=h*dt,Le+=h*Rt,Ye+=h*gt,Xe+=h*_t,at+=h*yt,Ue+=h*Qe,Ze+=h*At,$e+=h*Tt,h=$[1],ge+=h*lt,be+=h*rt,Ne+=h*ft,De+=h*pt,Se+=h*ct,xt+=h*it,mt+=h*St,ot+=h*Ot,Le+=h*dt,Ye+=h*Rt,Xe+=h*gt,at+=h*_t,Ue+=h*yt,Ze+=h*Qe,$e+=h*At,ke+=h*Tt,h=$[2],be+=h*lt,Ne+=h*rt,De+=h*ft,Se+=h*pt,xt+=h*ct,mt+=h*it,ot+=h*St,Le+=h*Ot,Ye+=h*dt,Xe+=h*Rt,at+=h*gt,Ue+=h*_t,Ze+=h*yt,$e+=h*Qe,ke+=h*At,ht+=h*Tt,h=$[3],Ne+=h*lt,De+=h*rt,Se+=h*ft,xt+=h*pt,mt+=h*ct,ot+=h*it,Le+=h*St,Ye+=h*Ot,Xe+=h*dt,at+=h*Rt,Ue+=h*gt,Ze+=h*_t,$e+=h*yt,ke+=h*Qe,ht+=h*At,qe+=h*Tt,h=$[4],De+=h*lt,Se+=h*rt,xt+=h*ft,mt+=h*pt,ot+=h*ct,Le+=h*it,Ye+=h*St,Xe+=h*Ot,at+=h*dt,Ue+=h*Rt,Ze+=h*gt,$e+=h*_t,ke+=h*yt,ht+=h*Qe,qe+=h*At,Pt+=h*Tt,h=$[5],Se+=h*lt,xt+=h*rt,mt+=h*ft,ot+=h*pt,Le+=h*ct,Ye+=h*it,Xe+=h*St,at+=h*Ot,Ue+=h*dt,Ze+=h*Rt,$e+=h*gt,ke+=h*_t,ht+=h*yt,qe+=h*Qe,Pt+=h*At,Dt+=h*Tt,h=$[6],xt+=h*lt,mt+=h*rt,ot+=h*ft,Le+=h*pt,Ye+=h*ct,Xe+=h*it,at+=h*St,Ue+=h*Ot,Ze+=h*dt,$e+=h*Rt,ke+=h*gt,ht+=h*_t,qe+=h*yt,Pt+=h*Qe,Dt+=h*At,Ut+=h*Tt,h=$[7],mt+=h*lt,ot+=h*rt,Le+=h*ft,Ye+=h*pt,Xe+=h*ct,at+=h*it,Ue+=h*St,Ze+=h*Ot,$e+=h*dt,ke+=h*Rt,ht+=h*gt,qe+=h*_t,Pt+=h*yt,Dt+=h*Qe,Ut+=h*At,Ht+=h*Tt,h=$[8],ot+=h*lt,Le+=h*rt,Ye+=h*ft,Xe+=h*pt,at+=h*ct,Ue+=h*it,Ze+=h*St,$e+=h*Ot,ke+=h*dt,ht+=h*Rt,qe+=h*gt,Pt+=h*_t,Dt+=h*yt,Ut+=h*Qe,Ht+=h*At,jt+=h*Tt,h=$[9],Le+=h*lt,Ye+=h*rt,Xe+=h*ft,at+=h*pt,Ue+=h*ct,Ze+=h*it,$e+=h*St,ke+=h*Ot,ht+=h*dt,qe+=h*Rt,Pt+=h*gt,Dt+=h*_t,Ut+=h*yt,Ht+=h*Qe,jt+=h*At,Wt+=h*Tt,h=$[10],Ye+=h*lt,Xe+=h*rt,at+=h*ft,Ue+=h*pt,Ze+=h*ct,$e+=h*it,ke+=h*St,ht+=h*Ot,qe+=h*dt,Pt+=h*Rt,Dt+=h*gt,Ut+=h*_t,Ht+=h*yt,jt+=h*Qe,Wt+=h*At,rr+=h*Tt,h=$[11],Xe+=h*lt,at+=h*rt,Ue+=h*ft,Ze+=h*pt,$e+=h*ct,ke+=h*it,ht+=h*St,qe+=h*Ot,Pt+=h*dt,Dt+=h*Rt,Ut+=h*gt,Ht+=h*_t,jt+=h*yt,Wt+=h*Qe,rr+=h*At,Mr+=h*Tt,h=$[12],at+=h*lt,Ue+=h*rt,Ze+=h*ft,$e+=h*pt,ke+=h*ct,ht+=h*it,qe+=h*St,Pt+=h*Ot,Dt+=h*dt,Ut+=h*Rt,Ht+=h*gt,jt+=h*_t,Wt+=h*yt,rr+=h*Qe,Mr+=h*At,Jt+=h*Tt,h=$[13],Ue+=h*lt,Ze+=h*rt,$e+=h*ft,ke+=h*pt,ht+=h*ct,qe+=h*it,Pt+=h*St,Dt+=h*Ot,Ut+=h*dt,Ht+=h*Rt,jt+=h*gt,Wt+=h*_t,rr+=h*yt,Mr+=h*Qe,Jt+=h*At,Vr+=h*Tt,h=$[14],Ze+=h*lt,$e+=h*rt,ke+=h*ft,ht+=h*pt,qe+=h*ct,Pt+=h*it,Dt+=h*St,Ut+=h*Ot,Ht+=h*dt,jt+=h*Rt,Wt+=h*gt,rr+=h*_t,Mr+=h*yt,Jt+=h*Qe,Vr+=h*At,fi+=h*Tt,h=$[15],$e+=h*lt,ke+=h*rt,ht+=h*ft,qe+=h*pt,Pt+=h*ct,Dt+=h*it,Ut+=h*St,Ht+=h*Ot,jt+=h*dt,Wt+=h*Rt,rr+=h*gt,Mr+=h*_t,Jt+=h*yt,Vr+=h*Qe,fi+=h*At,Ri+=h*Tt,ee+=38*ke,ge+=38*ht,be+=38*qe,Ne+=38*Pt,De+=38*Dt,Se+=38*Ut,xt+=38*Ht,mt+=38*jt,ot+=38*Wt,Le+=38*rr,Ye+=38*Mr,Xe+=38*Jt,at+=38*Vr,Ue+=38*fi,Ze+=38*Ri,I=1,h=ee+I+65535,I=Math.floor(h/65536),ee=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=be+I+65535,I=Math.floor(h/65536),be=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=xt+I+65535,I=Math.floor(h/65536),xt=h-I*65536,h=mt+I+65535,I=Math.floor(h/65536),mt=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=Le+I+65535,I=Math.floor(h/65536),Le=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=Ue+I+65535,I=Math.floor(h/65536),Ue=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,ee+=I-1+37*(I-1),I=1,h=ee+I+65535,I=Math.floor(h/65536),ee=h-I*65536,h=ge+I+65535,I=Math.floor(h/65536),ge=h-I*65536,h=be+I+65535,I=Math.floor(h/65536),be=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Se+I+65535,I=Math.floor(h/65536),Se=h-I*65536,h=xt+I+65535,I=Math.floor(h/65536),xt=h-I*65536,h=mt+I+65535,I=Math.floor(h/65536),mt=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=Le+I+65535,I=Math.floor(h/65536),Le=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Xe+I+65535,I=Math.floor(h/65536),Xe=h-I*65536,h=at+I+65535,I=Math.floor(h/65536),at=h-I*65536,h=Ue+I+65535,I=Math.floor(h/65536),Ue=h-I*65536,h=Ze+I+65535,I=Math.floor(h/65536),Ze=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,ee+=I-1+37*(I-1),F[0]=ee,F[1]=ge,F[2]=be,F[3]=Ne,F[4]=De,F[5]=Se,F[6]=xt,F[7]=mt,F[8]=ot,F[9]=Le,F[10]=Ye,F[11]=Xe,F[12]=at,F[13]=Ue,F[14]=Ze,F[15]=$e}function W(F,$){U(F,$,$)}function ve(F,$){const T=o();let h;for(h=0;h<16;h++)T[h]=$[h];for(h=253;h>=0;h--)W(T,T),h!==2&&h!==4&&U(T,T,$);for(h=0;h<16;h++)F[h]=T[h]}function ie(F,$){const T=o();let h;for(h=0;h<16;h++)T[h]=$[h];for(h=250;h>=0;h--)W(T,T),h!==1&&U(T,T,$);for(h=0;h<16;h++)F[h]=T[h]}function ue(F,$){const T=o(),h=o(),I=o(),ee=o(),ge=o(),be=o(),Ne=o(),De=o(),Se=o();L(T,F[1],F[0]),L(Se,$[1],$[0]),U(T,T,Se),de(h,F[0],F[1]),de(Se,$[0],$[1]),U(h,h,Se),U(I,F[3],$[3]),U(I,I,p),U(ee,F[2],$[2]),de(ee,ee,ee),L(ge,h,T),L(be,ee,I),de(Ne,ee,I),de(De,h,T),U(F[0],ge,be),U(F[1],De,Ne),U(F[2],Ne,be),U(F[3],ge,De)}function Ce(F,$,T){for(let h=0;h<4;h++)K(F[h],$[h],T)}function ze(F,$){const T=o(),h=o(),I=o();ve(I,$[2]),U(T,$[0],I),U(h,$[1],I),re(F,h),F[31]^=fe(T)<<7}function m(F,$,T){D(F[0],f),D(F[1],g),D(F[2],g),D(F[3],f);for(let h=255;h>=0;--h){const I=T[h/8|0]>>(h&7)&1;Ce(F,$,I),ue($,F),ue(F,F),Ce(F,$,I)}}function P(F,$){const T=[o(),o(),o(),o()];D(T[0],b),D(T[1],A),D(T[2],g),U(T[3],b,A),m(F,T,$)}function Y(F){if(F.length!==a.SEED_LENGTH)throw new Error(`ed25519: seed must be ${a.SEED_LENGTH} bytes`);const $=(0,t.hash)(F);$[0]&=248,$[31]&=127,$[31]|=64;const T=new Uint8Array(32),h=[o(),o(),o(),o()];P(h,$),ze(T,h);const I=new Uint8Array(64);return I.set(F),I.set(T,32),{publicKey:T,secretKey:I}}a.generateKeyPairFromSeed=Y;function ce(F){const $=(0,r.randomBytes)(32,F),T=Y($);return(0,n.wipe)($),T}a.generateKeyPair=ce;function V(F){if(F.length!==a.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${a.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(F.subarray(32))}a.extractPublicKeyFromSecretKey=V;const H=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function k(F,$){let T,h,I,ee;for(h=63;h>=32;--h){for(T=0,I=h-32,ee=h-12;I<ee;++I)$[I]+=T-16*$[h]*H[I-(h-32)],T=Math.floor(($[I]+128)/256),$[I]-=T*256;$[I]+=T,$[h]=0}for(T=0,I=0;I<32;I++)$[I]+=T-($[31]>>4)*H[I],T=$[I]>>8,$[I]&=255;for(I=0;I<32;I++)$[I]-=T*H[I];for(h=0;h<32;h++)$[h+1]+=$[h]>>8,F[h]=$[h]&255}function G(F){const $=new Float64Array(64);for(let T=0;T<64;T++)$[T]=F[T];for(let T=0;T<64;T++)F[T]=0;k(F,$)}function Je(F,$){const T=new Float64Array(64),h=[o(),o(),o(),o()],I=(0,t.hash)(F.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ee=new Uint8Array(64);ee.set(I.subarray(32),32);const ge=new t.SHA512;ge.update(ee.subarray(32)),ge.update($);const be=ge.digest();ge.clean(),G(be),P(h,be),ze(ee,h),ge.reset(),ge.update(ee.subarray(0,32)),ge.update(F.subarray(32)),ge.update($);const Ne=ge.digest();G(Ne);for(let De=0;De<32;De++)T[De]=be[De];for(let De=0;De<32;De++)for(let Se=0;Se<32;Se++)T[De+Se]+=Ne[De]*I[Se];return k(ee.subarray(32),T),ee}a.sign=Je;function Be(F,$){const T=o(),h=o(),I=o(),ee=o(),ge=o(),be=o(),Ne=o();return D(F[2],g),pe(F[1],$),W(I,F[1]),U(ee,I,_),L(I,I,F[2]),de(ee,F[2],ee),W(ge,ee),W(be,ge),U(Ne,be,ge),U(T,Ne,I),U(T,T,ee),ie(T,T),U(T,T,I),U(T,T,ee),U(T,T,ee),U(F[0],T,ee),W(h,F[0]),U(h,h,ee),le(h,I)&&U(F[0],F[0],x),W(h,F[0]),U(h,h,ee),le(h,I)?-1:(fe(F[0])===$[31]>>7&&L(F[0],f,F[0]),U(F[3],F[0],F[1]),0)}function qr(F,$,T){const h=new Uint8Array(32),I=[o(),o(),o(),o()],ee=[o(),o(),o(),o()];if(T.length!==a.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${a.SIGNATURE_LENGTH} bytes`);if(Be(ee,F))return!1;const ge=new t.SHA512;ge.update(T.subarray(0,32)),ge.update(F),ge.update($);const be=ge.digest();return G(be),m(I,ee,be),P(ee,T.subarray(32)),ue(I,ee),ze(h,I),!he(T,h)}a.verify=qr;function Ie(F){let $=[o(),o(),o(),o()];if(Be($,F))throw new Error("Ed25519: invalid public key");let T=o(),h=o(),I=$[1];de(T,g,I),L(h,g,I),ve(h,h),U(T,T,h);let ee=new Uint8Array(32);return re(ee,T),ee}a.convertPublicKeyToX25519=Ie;function It(F){const $=(0,t.hash)(F.subarray(0,32));$[0]&=248,$[31]&=127,$[31]|=64;const T=new Uint8Array($.subarray(0,32));return(0,n.wipe)($),T}a.convertSecretKeyToX25519=It})(Mc);const ew="EdDSA",tw="JWT",wf=".",bf="base64url",rw="utf8",iw="utf8",nw=":",sw="did",ow="key",fl="base58btc",aw="z",cw="K36",uw=32;function wo(a){return xo(jc(ki(a),rw),bf)}function Ef(a){const r=jc(cw,fl),t=aw+xo(Tm([r,a]),fl);return[sw,ow,t].join(nw)}function hw(a){return xo(a,bf)}function lw(a){return jc([wo(a.header),wo(a.payload)].join(wf),iw)}function fw(a){return[wo(a.header),wo(a.payload),hw(a.signature)].join(wf)}function pl(a=nf.randomBytes(uw)){return Mc.generateKeyPairFromSeed(a)}async function pw(a,r,t,n,o=ne.fromMiliseconds(Date.now())){const c={alg:ew,typ:tw},f=Ef(n.publicKey),g=o+t,_={iss:f,sub:a,aud:r,iat:o,exp:g},p=lw({header:c,payload:_}),b=Mc.sign(n.secretKey,p);return fw({header:c,payload:_,signature:b})}const dw="PARSE_ERROR",gw="INVALID_REQUEST",yw="METHOD_NOT_FOUND",vw="INVALID_PARAMS",If="INTERNAL_ERROR",zc="SERVER_ERROR",mw=[-32700,-32600,-32601,-32602,-32603],Qn={[dw]:{code:-32700,message:"Parse error"},[gw]:{code:-32600,message:"Invalid Request"},[yw]:{code:-32601,message:"Method not found"},[vw]:{code:-32602,message:"Invalid params"},[If]:{code:-32603,message:"Internal error"},[zc]:{code:-32e3,message:"Server error"}},xf=zc;function _w(a){return mw.includes(a)}function dl(a){return Object.keys(Qn).includes(a)?Qn[a]:Qn[xf]}function ww(a){const r=Object.values(Qn).find(t=>t.code===a);return r||Qn[xf]}function Pf(a,r,t){return a.message.includes("getaddrinfo ENOTFOUND")||a.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${r}`):a}var Sf={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Oc=function(a,r){return Oc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var o in n)n.hasOwnProperty(o)&&(t[o]=n[o])},Oc(a,r)};function bw(a,r){Oc(a,r);function t(){this.constructor=a}a.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Rc=function(){return Rc=Object.assign||function(r){for(var t,n=1,o=arguments.length;n<o;n++){t=arguments[n];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(r[c]=t[c])}return r},Rc.apply(this,arguments)};function Ew(a,r){var t={};for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&r.indexOf(n)<0&&(t[n]=a[n]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(a);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(a,n[o])&&(t[n[o]]=a[n[o]]);return t}function Iw(a,r,t,n){var o=arguments.length,c=o<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(a,r,t,n);else for(var g=a.length-1;g>=0;g--)(f=a[g])&&(c=(o<3?f(c):o>3?f(r,t,c):f(r,t))||c);return o>3&&c&&Object.defineProperty(r,t,c),c}function xw(a,r){return function(t,n){r(t,n,a)}}function Pw(a,r){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(a,r)}function Sw(a,r,t,n){function o(c){return c instanceof t?c:new t(function(f){f(c)})}return new(t||(t=Promise))(function(c,f){function g(b){try{p(n.next(b))}catch(A){f(A)}}function _(b){try{p(n.throw(b))}catch(A){f(A)}}function p(b){b.done?c(b.value):o(b.value).then(g,_)}p((n=n.apply(a,r||[])).next())})}function Ow(a,r){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},n,o,c,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(b){return _([p,b])}}function _(p){if(n)throw new TypeError("Generator is already executing.");for(;t;)try{if(n=1,o&&(c=p[0]&2?o.return:p[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,p[1])).done)return c;switch(o=0,c&&(p=[p[0]&2,c.value]),p[0]){case 0:case 1:c=p;break;case 4:return t.label++,{value:p[1],done:!1};case 5:t.label++,o=p[1],p=[0];continue;case 7:p=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(p[0]===6||p[0]===2)){t=0;continue}if(p[0]===3&&(!c||p[1]>c[0]&&p[1]<c[3])){t.label=p[1];break}if(p[0]===6&&t.label<c[1]){t.label=c[1],c=p;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(p);break}c[2]&&t.ops.pop(),t.trys.pop();continue}p=r.call(a,t)}catch(b){p=[6,b],o=0}finally{n=c=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Rw(a,r,t,n){n===void 0&&(n=t),a[n]=r[t]}function Aw(a,r){for(var t in a)t!=="default"&&!r.hasOwnProperty(t)&&(r[t]=a[t])}function Ac(a){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&a[r],n=0;if(t)return t.call(a);if(a&&typeof a.length=="number")return{next:function(){return a&&n>=a.length&&(a=void 0),{value:a&&a[n++],done:!a}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function Of(a,r){var t=typeof Symbol=="function"&&a[Symbol.iterator];if(!t)return a;var n=t.call(a),o,c=[],f;try{for(;(r===void 0||r-- >0)&&!(o=n.next()).done;)c.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(t=n.return)&&t.call(n)}finally{if(f)throw f.error}}return c}function Tw(){for(var a=[],r=0;r<arguments.length;r++)a=a.concat(Of(arguments[r]));return a}function Cw(){for(var a=0,r=0,t=arguments.length;r<t;r++)a+=arguments[r].length;for(var n=Array(a),o=0,r=0;r<t;r++)for(var c=arguments[r],f=0,g=c.length;f<g;f++,o++)n[o]=c[f];return n}function es(a){return this instanceof es?(this.v=a,this):new es(a)}function Nw(a,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=t.apply(a,r||[]),o,c=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(x){n[x]&&(o[x]=function(D){return new Promise(function(C,K){c.push([x,D,C,K])>1||g(x,D)})})}function g(x,D){try{_(n[x](D))}catch(C){A(c[0][3],C)}}function _(x){x.value instanceof es?Promise.resolve(x.value.v).then(p,b):A(c[0][2],x)}function p(x){g("next",x)}function b(x){g("throw",x)}function A(x,D){x(D),c.shift(),c.length&&g(c[0][0],c[0][1])}}function $w(a){var r,t;return r={},n("next"),n("throw",function(o){throw o}),n("return"),r[Symbol.iterator]=function(){return this},r;function n(o,c){r[o]=a[o]?function(f){return(t=!t)?{value:es(a[o](f)),done:o==="return"}:c?c(f):f}:c}}function Dw(a){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=a[Symbol.asyncIterator],t;return r?r.call(a):(a=typeof Ac=="function"?Ac(a):a[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(c){t[c]=a[c]&&function(f){return new Promise(function(g,_){f=a[c](f),o(g,_,f.done,f.value)})}}function o(c,f,g,_){Promise.resolve(_).then(function(p){c({value:p,done:g})},f)}}function Fw(a,r){return Object.defineProperty?Object.defineProperty(a,"raw",{value:r}):a.raw=r,a}function Lw(a){if(a&&a.__esModule)return a;var r={};if(a!=null)for(var t in a)Object.hasOwnProperty.call(a,t)&&(r[t]=a[t]);return r.default=a,r}function jw(a){return a&&a.__esModule?a:{default:a}}function qw(a,r){if(!r.has(a))throw new TypeError("attempted to get private field on non-instance");return r.get(a)}function Mw(a,r,t){if(!r.has(a))throw new TypeError("attempted to set private field on non-instance");return r.set(a,t),t}const zw=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Rc},__asyncDelegator:$w,__asyncGenerator:Nw,__asyncValues:Dw,__await:es,__awaiter:Sw,__classPrivateFieldGet:qw,__classPrivateFieldSet:Mw,__createBinding:Rw,__decorate:Iw,__exportStar:Aw,__extends:bw,__generator:Ow,__importDefault:jw,__importStar:Lw,__makeTemplateObject:Fw,__metadata:Pw,__param:xw,__read:Of,__rest:Ew,__spread:Tw,__spreadArrays:Cw,__values:Ac},Symbol.toStringTag,{value:"Module"})),Uw=Io(zw);var ni={},gl;function Hw(){if(gl)return ni;gl=1,Object.defineProperty(ni,"__esModule",{value:!0}),ni.isBrowserCryptoAvailable=ni.getSubtleCrypto=ni.getBrowerCrypto=void 0;function a(){return(jr===null||jr===void 0?void 0:jr.crypto)||(jr===null||jr===void 0?void 0:jr.msCrypto)||{}}ni.getBrowerCrypto=a;function r(){const n=a();return n.subtle||n.webkitSubtle}ni.getSubtleCrypto=r;function t(){return!!a()&&!!r()}return ni.isBrowserCryptoAvailable=t,ni}var si={},yl;function Bw(){if(yl)return si;yl=1,Object.defineProperty(si,"__esModule",{value:!0}),si.isBrowser=si.isNode=si.isReactNative=void 0;function a(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}si.isReactNative=a;function r(){return typeof ec<"u"&&typeof ec.versions<"u"&&typeof ec.versions.node<"u"}si.isNode=r;function t(){return!a()&&!r()}return si.isBrowser=t,si}(function(a){Object.defineProperty(a,"__esModule",{value:!0});const r=Uw;r.__exportStar(Hw(),a),r.__exportStar(Bw(),a)})(Sf);function Uc(a=3){const r=Date.now()*Math.pow(10,a),t=Math.floor(Math.random()*Math.pow(10,a));return r+t}function Rf(a=6){return BigInt(Uc(a))}function mn(a,r,t){return{id:t||Uc(),jsonrpc:"2.0",method:a,params:r}}function Hc(a,r){return{id:a,jsonrpc:"2.0",result:r}}function So(a,r,t){return{id:a,jsonrpc:"2.0",error:kw(r,t)}}function kw(a,r){return typeof a>"u"?dl(If):(typeof a=="string"&&(a=Object.assign(Object.assign({},dl(zc)),{message:a})),typeof r<"u"&&(a.data=r),_w(a.code)&&(a=ww(a.code)),a)}class Kw{}class Vw extends Kw{constructor(){super()}}class Gw extends Vw{constructor(r){super()}}const Ww="^https?:",Jw="^wss?:";function Qw(a){const r=a.match(new RegExp(/^\w+:/,"gi"));if(!(!r||!r.length))return r[0]}function Af(a,r){const t=Qw(a);return typeof t>"u"?!1:new RegExp(r).test(t)}function vl(a){return Af(a,Ww)}function ml(a){return Af(a,Jw)}function Yw(a){return new RegExp("wss?://localhost(:d{2,5})?").test(a)}function Tf(a){return typeof a=="object"&&"id"in a&&"jsonrpc"in a&&a.jsonrpc==="2.0"}function Bc(a){return Tf(a)&&"method"in a}function Oo(a){return Tf(a)&&(ci(a)||Lr(a))}function ci(a){return"result"in a}function Lr(a){return"error"in a}class hi extends Gw{constructor(r){super(r),this.events=new Or.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(r),this.connection.connected&&this.registerEventListeners()}async connect(r=this.connection){await this.open(r)}async disconnect(){await this.close()}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async request(r,t){return this.requestStrict(mn(r.method,r.params||[],r.id||Rf().toString()),t)}async requestStrict(r,t){return new Promise(async(n,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${r.id}`,c=>{Lr(c)?o(c.error):n(c.result)});try{await this.connection.send(r,t)}catch(c){o(c)}})}setConnection(r=this.connection){return r}onPayload(r){this.events.emit("payload",r),Oo(r)?this.events.emit(`${r.id}`,r):this.events.emit("message",{type:r.method,data:r.params})}onClose(r){r&&r.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${r.code} ${r.reason?`(${r.reason})`:""}`)),this.events.emit("disconnect")}async open(r=this.connection){this.connection===r&&this.connection.connected||(this.connection.connected&&this.close(),typeof r=="string"&&(await this.connection.open(r),r=this.connection),this.connection=this.setConnection(r),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",r=>this.onPayload(r)),this.connection.on("close",r=>this.onClose(r)),this.connection.on("error",r=>this.events.emit("error",r)),this.connection.on("register_error",r=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const Xw=()=>typeof WebSocket<"u"?WebSocket:typeof ui<"u"&&typeof ui.WebSocket<"u"?ui.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),Zw=()=>typeof WebSocket<"u"||typeof ui<"u"&&typeof ui.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",_l=a=>a.split("?")[0],wl=10,eb=Xw();class tb{constructor(r){if(this.url=r,this.events=new Or.EventEmitter,this.registering=!1,!ml(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);this.url=r}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){return new Promise((r,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),r()},this.socket.close()})}async send(r,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(ki(r))}catch(n){this.onError(r.id,n)}}register(r=this.url){if(!ml(r))throw new Error(`Provided URL is not compatible with WebSocket connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=r,this.registering=!0,new Promise((t,n)=>{const o=Sf.isReactNative()?void 0:{rejectUnauthorized:!Yw(r)},c=new eb(r,[],o);Zw()?c.onerror=f=>{const g=f;n(this.emitError(g.error))}:c.on("error",f=>{n(this.emitError(f))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(r){r.onmessage=t=>this.onPayload(t),r.onclose=t=>this.onClose(t),this.socket=r,this.registering=!1,this.events.emit("open")}onClose(r){this.socket=void 0,this.registering=!1,this.events.emit("close",r)}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?rs(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),o=n.message||n.toString(),c=So(r,o);this.events.emit("payload",c)}parseError(r,t=this.url){return Pf(r,_l(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>wl&&this.events.setMaxListeners(wl)}emitError(r){const t=this.parseError(new Error(r?.message||`WebSocket connection failed for host: ${_l(this.url)}`));return this.events.emit("register_error",t),t}}var bo={exports:{}};bo.exports;(function(a,r){var t=200,n="__lodash_hash_undefined__",o=1,c=2,f=9007199254740991,g="[object Arguments]",_="[object Array]",p="[object AsyncFunction]",b="[object Boolean]",A="[object Date]",x="[object Error]",D="[object Function]",C="[object GeneratorFunction]",K="[object Map]",re="[object Number]",he="[object Null]",le="[object Object]",fe="[object Promise]",pe="[object Proxy]",de="[object RegExp]",L="[object Set]",U="[object String]",W="[object Symbol]",ve="[object Undefined]",ie="[object WeakMap]",ue="[object ArrayBuffer]",Ce="[object DataView]",ze="[object Float32Array]",m="[object Float64Array]",P="[object Int8Array]",Y="[object Int16Array]",ce="[object Int32Array]",V="[object Uint8Array]",H="[object Uint8ClampedArray]",k="[object Uint16Array]",G="[object Uint32Array]",Je=/[\\^$.*+?()[\]{}|]/g,Be=/^\[object .+?Constructor\]$/,qr=/^(?:0|[1-9]\d*)$/,Ie={};Ie[ze]=Ie[m]=Ie[P]=Ie[Y]=Ie[ce]=Ie[V]=Ie[H]=Ie[k]=Ie[G]=!0,Ie[g]=Ie[_]=Ie[ue]=Ie[b]=Ie[Ce]=Ie[A]=Ie[x]=Ie[D]=Ie[K]=Ie[re]=Ie[le]=Ie[de]=Ie[L]=Ie[U]=Ie[ie]=!1;var It=typeof jr=="object"&&jr&&jr.Object===Object&&jr,F=typeof self=="object"&&self&&self.Object===Object&&self,$=It||F||Function("return this")(),T=r&&!r.nodeType&&r,h=T&&!0&&a&&!a.nodeType&&a,I=h&&h.exports===T,ee=I&&It.process,ge=function(){try{return ee&&ee.binding&&ee.binding("util")}catch{}}(),be=ge&&ge.isTypedArray;function Ne(v,S){for(var z=-1,Q=v==null?0:v.length,Ve=0,me=[];++z<Q;){var et=v[z];S(et,z,v)&&(me[Ve++]=et)}return me}function De(v,S){for(var z=-1,Q=S.length,Ve=v.length;++z<Q;)v[Ve+z]=S[z];return v}function Se(v,S){for(var z=-1,Q=v==null?0:v.length;++z<Q;)if(S(v[z],z,v))return!0;return!1}function xt(v,S){for(var z=-1,Q=Array(v);++z<v;)Q[z]=S(z);return Q}function mt(v){return function(S){return v(S)}}function ot(v,S){return v.has(S)}function Le(v,S){return v?.[S]}function Ye(v){var S=-1,z=Array(v.size);return v.forEach(function(Q,Ve){z[++S]=[Ve,Q]}),z}function Xe(v,S){return function(z){return v(S(z))}}function at(v){var S=-1,z=Array(v.size);return v.forEach(function(Q){z[++S]=Q}),z}var Ue=Array.prototype,Ze=Function.prototype,$e=Object.prototype,ke=$["__core-js_shared__"],ht=Ze.toString,qe=$e.hasOwnProperty,Pt=function(){var v=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return v?"Symbol(src)_1."+v:""}(),Dt=$e.toString,Ut=RegExp("^"+ht.call(qe).replace(Je,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ht=I?$.Buffer:void 0,jt=$.Symbol,Wt=$.Uint8Array,rr=$e.propertyIsEnumerable,Mr=Ue.splice,Jt=jt?jt.toStringTag:void 0,Vr=Object.getOwnPropertySymbols,fi=Ht?Ht.isBuffer:void 0,Ri=Xe(Object.keys,Object),lt=lr($,"DataView"),rt=lr($,"Map"),ft=lr($,"Promise"),pt=lr($,"Set"),ct=lr($,"WeakMap"),it=lr(Object,"create"),St=Wr(lt),Ot=Wr(rt),dt=Wr(ft),Rt=Wr(pt),gt=Wr(ct),_t=jt?jt.prototype:void 0,yt=_t?_t.valueOf:void 0;function Qe(v){var S=-1,z=v==null?0:v.length;for(this.clear();++S<z;){var Q=v[S];this.set(Q[0],Q[1])}}function At(){this.__data__=it?it(null):{},this.size=0}function Tt(v){var S=this.has(v)&&delete this.__data__[v];return this.size-=S?1:0,S}function To(v){var S=this.__data__;if(it){var z=S[v];return z===n?void 0:z}return qe.call(S,v)?S[v]:void 0}function Co(v){var S=this.__data__;return it?S[v]!==void 0:qe.call(S,v)}function No(v,S){var z=this.__data__;return this.size+=this.has(v)?0:1,z[v]=it&&S===void 0?n:S,this}Qe.prototype.clear=At,Qe.prototype.delete=Tt,Qe.prototype.get=To,Qe.prototype.has=Co,Qe.prototype.set=No;function vr(v){var S=-1,z=v==null?0:v.length;for(this.clear();++S<z;){var Q=v[S];this.set(Q[0],Q[1])}}function $o(){this.__data__=[],this.size=0}function Do(v){var S=this.__data__,z=Ai(S,v);if(z<0)return!1;var Q=S.length-1;return z==Q?S.pop():Mr.call(S,z,1),--this.size,!0}function Fo(v){var S=this.__data__,z=Ai(S,v);return z<0?void 0:S[z][1]}function Lo(v){return Ai(this.__data__,v)>-1}function jo(v,S){var z=this.__data__,Q=Ai(z,v);return Q<0?(++this.size,z.push([v,S])):z[Q][1]=S,this}vr.prototype.clear=$o,vr.prototype.delete=Do,vr.prototype.get=Fo,vr.prototype.has=Lo,vr.prototype.set=jo;function Gr(v){var S=-1,z=v==null?0:v.length;for(this.clear();++S<z;){var Q=v[S];this.set(Q[0],Q[1])}}function Wi(){this.size=0,this.__data__={hash:new Qe,map:new(rt||vr),string:new Qe}}function qo(v){var S=pi(this,v).delete(v);return this.size-=S?1:0,S}function Ji(v){return pi(this,v).get(v)}function Mo(v){return pi(this,v).has(v)}function zo(v,S){var z=pi(this,v),Q=z.size;return z.set(v,S),this.size+=z.size==Q?0:1,this}Gr.prototype.clear=Wi,Gr.prototype.delete=qo,Gr.prototype.get=Ji,Gr.prototype.has=Mo,Gr.prototype.set=zo;function Qi(v){var S=-1,z=v==null?0:v.length;for(this.__data__=new Gr;++S<z;)this.add(v[S])}function ns(v){return this.__data__.set(v,n),this}function ss(v){return this.__data__.has(v)}Qi.prototype.add=Qi.prototype.push=ns,Qi.prototype.has=ss;function Rr(v){var S=this.__data__=new vr(v);this.size=S.size}function Uo(){this.__data__=new vr,this.size=0}function Ho(v){var S=this.__data__,z=S.delete(v);return this.size=S.size,z}function Bo(v){return this.__data__.get(v)}function ko(v){return this.__data__.has(v)}function os(v,S){var z=this.__data__;if(z instanceof vr){var Q=z.__data__;if(!rt||Q.length<t-1)return Q.push([v,S]),this.size=++z.size,this;z=this.__data__=new Gr(Q)}return z.set(v,S),this.size=z.size,this}Rr.prototype.clear=Uo,Rr.prototype.delete=Ho,Rr.prototype.get=Bo,Rr.prototype.has=ko,Rr.prototype.set=os;function as(v,S){var z=Zi(v),Q=!z&&_s(v),Ve=!z&&!Q&&In(v),me=!z&&!Q&&!Ve&&Es(v),et=z||Q||Ve||me,Ct=et?xt(v.length,String):[],Re=Ct.length;for(var Ge in v)(S||qe.call(v,Ge))&&!(et&&(Ge=="length"||Ve&&(Ge=="offset"||Ge=="parent")||me&&(Ge=="buffer"||Ge=="byteLength"||Ge=="byteOffset")||ds(Ge,Re)))&&Ct.push(Ge);return Ct}function Ai(v,S){for(var z=v.length;z--;)if(ms(v[z][0],S))return z;return-1}function bn(v,S,z){var Q=S(v);return Zi(v)?Q:De(Q,z(v))}function Ti(v){return v==null?v===void 0?ve:he:Jt&&Jt in Object(v)?fs(v):Go(v)}function En(v){return Ni(v)&&Ti(v)==g}function Ci(v,S,z,Q,Ve){return v===S?!0:v==null||S==null||!Ni(v)&&!Ni(S)?v!==v&&S!==S:cs(v,S,z,Q,Ci,Ve)}function cs(v,S,z,Q,Ve,me){var et=Zi(v),Ct=Zi(S),Re=et?_:zr(v),Ge=Ct?_:zr(S);Re=Re==g?le:Re,Ge=Ge==g?le:Ge;var wt=Re==le,ir=Ge==le,Nt=Re==Ge;if(Nt&&In(v)){if(!In(S))return!1;et=!0,wt=!1}if(Nt&&!wt)return me||(me=new Rr),et||Es(v)?Yi(v,S,z,Q,Ve,me):Vo(v,S,Re,z,Q,Ve,me);if(!(z&o)){var tt=wt&&qe.call(v,"__wrapped__"),Qt=ir&&qe.call(S,"__wrapped__");if(tt||Qt){var Ar=tt?v.value():v,mr=Qt?S.value():S;return me||(me=new Rr),Ve(Ar,mr,z,Q,me)}}return Nt?(me||(me=new Rr),ls(v,S,z,Q,Ve,me)):!1}function Ko(v){if(!bs(v)||ys(v))return!1;var S=en(v)?Ut:Be;return S.test(Wr(v))}function us(v){return Ni(v)&&ws(v.length)&&!!Ie[Ti(v)]}function hs(v){if(!vs(v))return Ri(v);var S=[];for(var z in Object(v))qe.call(v,z)&&z!="constructor"&&S.push(z);return S}function Yi(v,S,z,Q,Ve,me){var et=z&o,Ct=v.length,Re=S.length;if(Ct!=Re&&!(et&&Re>Ct))return!1;var Ge=me.get(v);if(Ge&&me.get(S))return Ge==S;var wt=-1,ir=!0,Nt=z&c?new Qi:void 0;for(me.set(v,S),me.set(S,v);++wt<Ct;){var tt=v[wt],Qt=S[wt];if(Q)var Ar=et?Q(Qt,tt,wt,S,v,me):Q(tt,Qt,wt,v,S,me);if(Ar!==void 0){if(Ar)continue;ir=!1;break}if(Nt){if(!Se(S,function(mr,Ur){if(!ot(Nt,Ur)&&(tt===mr||Ve(tt,mr,z,Q,me)))return Nt.push(Ur)})){ir=!1;break}}else if(!(tt===Qt||Ve(tt,Qt,z,Q,me))){ir=!1;break}}return me.delete(v),me.delete(S),ir}function Vo(v,S,z,Q,Ve,me,et){switch(z){case Ce:if(v.byteLength!=S.byteLength||v.byteOffset!=S.byteOffset)return!1;v=v.buffer,S=S.buffer;case ue:return!(v.byteLength!=S.byteLength||!me(new Wt(v),new Wt(S)));case b:case A:case re:return ms(+v,+S);case x:return v.name==S.name&&v.message==S.message;case de:case U:return v==S+"";case K:var Ct=Ye;case L:var Re=Q&o;if(Ct||(Ct=at),v.size!=S.size&&!Re)return!1;var Ge=et.get(v);if(Ge)return Ge==S;Q|=c,et.set(v,S);var wt=Yi(Ct(v),Ct(S),Q,Ve,me,et);return et.delete(v),wt;case W:if(yt)return yt.call(v)==yt.call(S)}return!1}function ls(v,S,z,Q,Ve,me){var et=z&o,Ct=Xi(v),Re=Ct.length,Ge=Xi(S),wt=Ge.length;if(Re!=wt&&!et)return!1;for(var ir=Re;ir--;){var Nt=Ct[ir];if(!(et?Nt in S:qe.call(S,Nt)))return!1}var tt=me.get(v);if(tt&&me.get(S))return tt==S;var Qt=!0;me.set(v,S),me.set(S,v);for(var Ar=et;++ir<Re;){Nt=Ct[ir];var mr=v[Nt],Ur=S[Nt];if(Q)var xn=et?Q(Ur,mr,Nt,S,v,me):Q(mr,Ur,Nt,v,S,me);if(!(xn===void 0?mr===Ur||Ve(mr,Ur,z,Q,me):xn)){Qt=!1;break}Ar||(Ar=Nt=="constructor")}if(Qt&&!Ar){var $i=v.constructor,qt=S.constructor;$i!=qt&&"constructor"in v&&"constructor"in S&&!(typeof $i=="function"&&$i instanceof $i&&typeof qt=="function"&&qt instanceof qt)&&(Qt=!1)}return me.delete(v),me.delete(S),Qt}function Xi(v){return bn(v,Qo,ps)}function pi(v,S){var z=v.__data__;return gs(S)?z[typeof S=="string"?"string":"hash"]:z.map}function lr(v,S){var z=Le(v,S);return Ko(z)?z:void 0}function fs(v){var S=qe.call(v,Jt),z=v[Jt];try{v[Jt]=void 0;var Q=!0}catch{}var Ve=Dt.call(v);return Q&&(S?v[Jt]=z:delete v[Jt]),Ve}var ps=Vr?function(v){return v==null?[]:(v=Object(v),Ne(Vr(v),function(S){return rr.call(v,S)}))}:Ke,zr=Ti;(lt&&zr(new lt(new ArrayBuffer(1)))!=Ce||rt&&zr(new rt)!=K||ft&&zr(ft.resolve())!=fe||pt&&zr(new pt)!=L||ct&&zr(new ct)!=ie)&&(zr=function(v){var S=Ti(v),z=S==le?v.constructor:void 0,Q=z?Wr(z):"";if(Q)switch(Q){case St:return Ce;case Ot:return K;case dt:return fe;case Rt:return L;case gt:return ie}return S});function ds(v,S){return S=S??f,!!S&&(typeof v=="number"||qr.test(v))&&v>-1&&v%1==0&&v<S}function gs(v){var S=typeof v;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?v!=="__proto__":v===null}function ys(v){return!!Pt&&Pt in v}function vs(v){var S=v&&v.constructor,z=typeof S=="function"&&S.prototype||$e;return v===z}function Go(v){return Dt.call(v)}function Wr(v){if(v!=null){try{return ht.call(v)}catch{}try{return v+""}catch{}}return""}function ms(v,S){return v===S||v!==v&&S!==S}var _s=En(function(){return arguments}())?En:function(v){return Ni(v)&&qe.call(v,"callee")&&!rr.call(v,"callee")},Zi=Array.isArray;function Wo(v){return v!=null&&ws(v.length)&&!en(v)}var In=fi||He;function Jo(v,S){return Ci(v,S)}function en(v){if(!bs(v))return!1;var S=Ti(v);return S==D||S==C||S==p||S==pe}function ws(v){return typeof v=="number"&&v>-1&&v%1==0&&v<=f}function bs(v){var S=typeof v;return v!=null&&(S=="object"||S=="function")}function Ni(v){return v!=null&&typeof v=="object"}var Es=be?mt(be):us;function Qo(v){return Wo(v)?as(v):hs(v)}function Ke(){return[]}function He(){return!1}a.exports=Jo})(bo,bo.exports);var rb=bo.exports;const ib=sf(rb);function nb(a,r){if(a.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var o=0;o<a.length;o++){var c=a.charAt(o),f=c.charCodeAt(0);if(t[f]!==255)throw new TypeError(c+" is ambiguous");t[f]=o}var g=a.length,_=a.charAt(0),p=Math.log(g)/Math.log(256),b=Math.log(256)/Math.log(g);function A(C){if(C instanceof Uint8Array||(ArrayBuffer.isView(C)?C=new Uint8Array(C.buffer,C.byteOffset,C.byteLength):Array.isArray(C)&&(C=Uint8Array.from(C))),!(C instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(C.length===0)return"";for(var K=0,re=0,he=0,le=C.length;he!==le&&C[he]===0;)he++,K++;for(var fe=(le-he)*b+1>>>0,pe=new Uint8Array(fe);he!==le;){for(var de=C[he],L=0,U=fe-1;(de!==0||L<re)&&U!==-1;U--,L++)de+=256*pe[U]>>>0,pe[U]=de%g>>>0,de=de/g>>>0;if(de!==0)throw new Error("Non-zero carry");re=L,he++}for(var W=fe-re;W!==fe&&pe[W]===0;)W++;for(var ve=_.repeat(K);W<fe;++W)ve+=a.charAt(pe[W]);return ve}function x(C){if(typeof C!="string")throw new TypeError("Expected String");if(C.length===0)return new Uint8Array;var K=0;if(C[K]!==" "){for(var re=0,he=0;C[K]===_;)re++,K++;for(var le=(C.length-K)*p+1>>>0,fe=new Uint8Array(le);C[K];){var pe=t[C.charCodeAt(K)];if(pe===255)return;for(var de=0,L=le-1;(pe!==0||de<he)&&L!==-1;L--,de++)pe+=g*fe[L]>>>0,fe[L]=pe%256>>>0,pe=pe/256>>>0;if(pe!==0)throw new Error("Non-zero carry");he=de,K++}if(C[K]!==" "){for(var U=le-he;U!==le&&fe[U]===0;)U++;for(var W=new Uint8Array(re+(le-U)),ve=re;U!==le;)W[ve++]=fe[U++];return W}}}function D(C){var K=x(C);if(K)return K;throw new Error(`Non-${r} character`)}return{encode:A,decodeUnsafe:x,decode:D}}var sb=nb,ob=sb;const Cf=a=>{if(a instanceof Uint8Array&&a.constructor.name==="Uint8Array")return a;if(a instanceof ArrayBuffer)return new Uint8Array(a);if(ArrayBuffer.isView(a))return new Uint8Array(a.buffer,a.byteOffset,a.byteLength);throw new Error("Unknown type, must be binary type")},ab=a=>new TextEncoder().encode(a),cb=a=>new TextDecoder().decode(a);class ub{constructor(r,t,n){this.name=r,this.prefix=t,this.baseEncode=n}encode(r){if(r instanceof Uint8Array)return`${this.prefix}${this.baseEncode(r)}`;throw Error("Unknown type, must be binary type")}}class hb{constructor(r,t,n){if(this.name=r,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(r){if(typeof r=="string"){if(r.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(r)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(r.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(r){return Nf(this,r)}}class lb{constructor(r){this.decoders=r}or(r){return Nf(this,r)}decode(r){const t=r[0],n=this.decoders[t];if(n)return n.decode(r);throw RangeError(`Unable to decode multibase string ${JSON.stringify(r)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Nf=(a,r)=>new lb({...a.decoders||{[a.prefix]:a},...r.decoders||{[r.prefix]:r}});class fb{constructor(r,t,n,o){this.name=r,this.prefix=t,this.baseEncode=n,this.baseDecode=o,this.encoder=new ub(r,t,n),this.decoder=new hb(r,t,o)}encode(r){return this.encoder.encode(r)}decode(r){return this.decoder.decode(r)}}const Ro=({name:a,prefix:r,encode:t,decode:n})=>new fb(a,r,t,n),is=({prefix:a,name:r,alphabet:t})=>{const{encode:n,decode:o}=ob(t,r);return Ro({prefix:a,name:r,encode:n,decode:c=>Cf(o(c))})},pb=(a,r,t,n)=>{const o={};for(let b=0;b<r.length;++b)o[r[b]]=b;let c=a.length;for(;a[c-1]==="=";)--c;const f=new Uint8Array(c*t/8|0);let g=0,_=0,p=0;for(let b=0;b<c;++b){const A=o[a[b]];if(A===void 0)throw new SyntaxError(`Non-${n} character`);_=_<<t|A,g+=t,g>=8&&(g-=8,f[p++]=255&_>>g)}if(g>=t||255&_<<8-g)throw new SyntaxError("Unexpected end of data");return f},db=(a,r,t)=>{const n=r[r.length-1]==="=",o=(1<<t)-1;let c="",f=0,g=0;for(let _=0;_<a.length;++_)for(g=g<<8|a[_],f+=8;f>t;)f-=t,c+=r[o&g>>f];if(f&&(c+=r[o&g<<t-f]),n)for(;c.length*t&7;)c+="=";return c},kt=({name:a,prefix:r,bitsPerChar:t,alphabet:n})=>Ro({prefix:r,name:a,encode(o){return db(o,n,t)},decode(o){return pb(o,n,t,a)}}),gb=Ro({prefix:"\0",name:"identity",encode:a=>cb(a),decode:a=>ab(a)});var yb=Object.freeze({__proto__:null,identity:gb});const vb=kt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var mb=Object.freeze({__proto__:null,base2:vb});const _b=kt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var wb=Object.freeze({__proto__:null,base8:_b});const bb=is({prefix:"9",name:"base10",alphabet:"0123456789"});var Eb=Object.freeze({__proto__:null,base10:bb});const Ib=kt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xb=kt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Pb=Object.freeze({__proto__:null,base16:Ib,base16upper:xb});const Sb=kt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ob=kt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Rb=kt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ab=kt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Tb=kt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Cb=kt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Nb=kt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),$b=kt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Db=kt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Fb=Object.freeze({__proto__:null,base32:Sb,base32upper:Ob,base32pad:Rb,base32padupper:Ab,base32hex:Tb,base32hexupper:Cb,base32hexpad:Nb,base32hexpadupper:$b,base32z:Db});const Lb=is({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jb=is({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var qb=Object.freeze({__proto__:null,base36:Lb,base36upper:jb});const Mb=is({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zb=is({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ub=Object.freeze({__proto__:null,base58btc:Mb,base58flickr:zb});const Hb=kt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Bb=kt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),kb=kt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Kb=kt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Vb=Object.freeze({__proto__:null,base64:Hb,base64pad:Bb,base64url:kb,base64urlpad:Kb});const $f=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),Gb=$f.reduce((a,r,t)=>(a[t]=r,a),[]),Wb=$f.reduce((a,r,t)=>(a[r.codePointAt(0)]=t,a),[]);function Jb(a){return a.reduce((r,t)=>(r+=Gb[t],r),"")}function Qb(a){const r=[];for(const t of a){const n=Wb[t.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${t}`);r.push(n)}return new Uint8Array(r)}const Yb=Ro({prefix:"🚀",name:"base256emoji",encode:Jb,decode:Qb});var Xb=Object.freeze({__proto__:null,base256emoji:Yb}),Zb=Df,bl=128,eE=127,tE=~eE,rE=Math.pow(2,31);function Df(a,r,t){r=r||[],t=t||0;for(var n=t;a>=rE;)r[t++]=a&255|bl,a/=128;for(;a&tE;)r[t++]=a&255|bl,a>>>=7;return r[t]=a|0,Df.bytes=t-n+1,r}var iE=Tc,nE=128,El=127;function Tc(a,n){var t=0,n=n||0,o=0,c=n,f,g=a.length;do{if(c>=g)throw Tc.bytes=0,new RangeError("Could not decode varint");f=a[c++],t+=o<28?(f&El)<<o:(f&El)*Math.pow(2,o),o+=7}while(f>=nE);return Tc.bytes=c-n,t}var sE=Math.pow(2,7),oE=Math.pow(2,14),aE=Math.pow(2,21),cE=Math.pow(2,28),uE=Math.pow(2,35),hE=Math.pow(2,42),lE=Math.pow(2,49),fE=Math.pow(2,56),pE=Math.pow(2,63),dE=function(a){return a<sE?1:a<oE?2:a<aE?3:a<cE?4:a<uE?5:a<hE?6:a<lE?7:a<fE?8:a<pE?9:10},gE={encode:Zb,decode:iE,encodingLength:dE},Ff=gE;const Il=(a,r,t=0)=>(Ff.encode(a,r,t),r),xl=a=>Ff.encodingLength(a),Cc=(a,r)=>{const t=r.byteLength,n=xl(a),o=n+xl(t),c=new Uint8Array(o+t);return Il(a,c,0),Il(t,c,n),c.set(r,o),new yE(a,t,r,c)};class yE{constructor(r,t,n,o){this.code=r,this.size=t,this.digest=n,this.bytes=o}}const Lf=({name:a,code:r,encode:t})=>new vE(a,r,t);class vE{constructor(r,t,n){this.name=r,this.code=t,this.encode=n}digest(r){if(r instanceof Uint8Array){const t=this.encode(r);return t instanceof Uint8Array?Cc(this.code,t):t.then(n=>Cc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const jf=a=>async r=>new Uint8Array(await crypto.subtle.digest(a,r)),mE=Lf({name:"sha2-256",code:18,encode:jf("SHA-256")}),_E=Lf({name:"sha2-512",code:19,encode:jf("SHA-512")});var wE=Object.freeze({__proto__:null,sha256:mE,sha512:_E});const qf=0,bE="identity",Mf=Cf,EE=a=>Cc(qf,Mf(a)),IE={code:qf,name:bE,encode:Mf,digest:EE};var xE=Object.freeze({__proto__:null,identity:IE});new TextEncoder,new TextDecoder;const Pl={...yb,...mb,...wb,...Eb,...Pb,...Fb,...qb,...Ub,...Vb,...Xb};({...wE,...xE});function zf(a){return globalThis.Buffer!=null?new Uint8Array(a.buffer,a.byteOffset,a.byteLength):a}function PE(a=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?zf(globalThis.Buffer.allocUnsafe(a)):new Uint8Array(a)}function Uf(a,r,t,n){return{name:a,prefix:r,encoder:{name:a,prefix:r,encode:t},decoder:{decode:n}}}const Sl=Uf("utf8","u",a=>"u"+new TextDecoder("utf8").decode(a),a=>new TextEncoder().encode(a.substring(1))),uc=Uf("ascii","a",a=>{let r="a";for(let t=0;t<a.length;t++)r+=String.fromCharCode(a[t]);return r},a=>{a=a.substring(1);const r=PE(a.length);for(let t=0;t<a.length;t++)r[t]=a.charCodeAt(t);return r}),SE={utf8:Sl,"utf-8":Sl,hex:Pl.base16,latin1:uc,ascii:uc,binary:uc,...Pl};function OE(a,r="utf8"){const t=SE[r];if(!t)throw new Error(`Unsupported encoding "${r}"`);return(r==="utf8"||r==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?zf(globalThis.Buffer.from(a,"utf-8")):t.decoder.decode(`${t.prefix}${a}`)}const Hf="wc",RE=2,kc="core",Pi=`${Hf}@2:${kc}:`,AE={name:kc,logger:"error"},TE={database:":memory:"},CE="crypto",Ol="client_ed25519_seed",NE=ne.ONE_DAY,$E="keychain",DE="0.3",FE="messages",LE="0.3",jE=ne.SIX_HOURS,qE="publisher",Bf="irn",ME="error",kf="wss://relay.walletconnect.com",Rl="wss://relay.walletconnect.org",zE="relayer",Gt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},UE="_subscription",oi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},HE=ne.ONE_SECOND,BE="2.10.2",kE=1e4,KE="0.3",VE="WALLETCONNECT_CLIENT_ID",Dr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},GE="subscription",WE="0.3",JE=ne.FIVE_SECONDS*1e3,QE="pairing",YE="0.3",Hn={wc_pairingDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:0},res:{ttl:ne.ONE_DAY,prompt:!1,tag:0}}},Wn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Kr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},XE="history",ZE="0.3",eI="expirer",Sr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},tI="0.3",hc="verify-api",_o="https://verify.walletconnect.com",Al="https://verify.walletconnect.org";class rI{constructor(r,t){this.core=r,this.logger=t,this.keychain=new Map,this.name=$E,this.version=DE,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:c}=Z("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(c)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=r,this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(r){await this.core.storage.setItem(this.storageKey,uf(r))}async getKeyChain(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?hf(r):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class iI{constructor(r,t,n){this.core=r,this.logger=t,this.name=CE,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=pl(o);return Ef(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=$m();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),f=pl(c),g=mc();return await pw(g,o,NE,f)},this.generateSharedKey=(o,c,f)=>{this.isInitialized();const g=this.getPrivateKey(o),_=Dm(g,c);return this.setSymKey(_,f)},this.setSymKey=async(o,c)=>{this.isInitialized();const f=c||Fm(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,f)=>{this.isInitialized();const g=Lm(f),_=ki(c);if(Wh(g)){const x=g.senderPublicKey,D=g.receiverPublicKey;o=await this.generateSharedKey(x,D)}const p=this.getSymKey(o),{type:b,senderPublicKey:A}=g;return jm({type:b,symKey:p,message:_,senderPublicKey:A})},this.decode=async(o,c,f)=>{this.isInitialized();const g=qm(c,f);if(Wh(g)){const _=g.receiverPublicKey,p=g.senderPublicKey;o=await this.generateSharedKey(_,p)}try{const _=this.getSymKey(o),p=Mm({symKey:_,encoded:c});return rs(p)}catch(_){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(_)}},this.getPayloadType=o=>{const c=Jh(o);return zm(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Jh(o);return c.senderPublicKey?xo(c.senderPublicKey,Um):void 0},this.core=r,this.logger=Te.generateChildLogger(t,this.name),this.keychain=n||new rI(this.core,this.logger)}get context(){return Te.getLoggerContext(this.logger)}async setPrivateKey(r,t){return await this.keychain.set(r,t),r}getPrivateKey(r){return this.keychain.get(r)}async getClientSeed(){let r="";try{r=this.keychain.get(Ol)}catch{r=mc(),await this.keychain.set(Ol,r)}return OE(r,"base16")}getSymKey(r){return this.keychain.get(r)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class nI extends K_{constructor(r,t){super(r,t),this.logger=r,this.core=t,this.messages=new Map,this.name=FE,this.version=LE,this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const c=vn(o);let f=this.messages.get(n);return typeof f>"u"&&(f={}),typeof f[c]<"u"||(f[c]=o,this.messages.set(n,f),await this.persist()),c},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const c=this.get(n),f=vn(o);return typeof c[f]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Te.generateChildLogger(r,this.name),this.core=t}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(r){await this.core.storage.setItem(this.storageKey,uf(r))}async getRelayerMessages(){const r=await this.core.storage.getItem(this.storageKey);return typeof r<"u"?hf(r):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class sI extends V_{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.events=new Or.EventEmitter,this.name=qE,this.queue=new Map,this.publishTimeout=ne.toMiliseconds(ne.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,c)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}});try{const g=c?.ttl||jE,_=_c(c),p=c?.prompt||!1,b=c?.tag||0,A=c?.id||Rf().toString(),x={topic:n,message:o,opts:{ttl:g,relay:_,prompt:p,tag:b,id:A}},D=setTimeout(()=>this.queue.set(A,x),this.publishTimeout);try{await await Yn(this.rpcPublish(n,o,g,_,p,b,A),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(A),this.relayer.events.emit(Gt.publish,x)}catch(C){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=c?.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(A),C;return}finally{clearTimeout(D)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:c}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=r,this.logger=Te.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return Te.getLoggerContext(this.logger)}rpcPublish(r,t,n,o,c,f,g){var _,p,b,A;const x={method:go(o.protocol).publish,params:{topic:r,message:t,ttl:n,prompt:c,tag:f},id:g};return xi((_=x.params)==null?void 0:_.prompt)&&((p=x.params)==null||delete p.prompt),xi((b=x.params)==null?void 0:b.tag)&&((A=x.params)==null||delete A.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:x}),this.relayer.request(x)}removeRequestFromQueue(r){this.queue.delete(r)}checkQueue(){this.queue.forEach(async r=>{const{topic:t,message:n,opts:o}=r;await this.publish(t,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Gt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Gt.message_ack,r=>{this.removeRequestFromQueue(r.id.toString())})}}class oI{constructor(){this.map=new Map,this.set=(r,t)=>{const n=this.get(r);this.exists(r,t)||this.map.set(r,[...n,t])},this.get=r=>this.map.get(r)||[],this.exists=(r,t)=>this.get(r).includes(t),this.delete=(r,t)=>{if(typeof t>"u"){this.map.delete(r);return}if(!this.map.has(r))return;const n=this.get(r);if(!this.exists(r,t))return;const o=n.filter(c=>c!==t);if(!o.length){this.map.delete(r);return}this.map.set(r,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var aI=Object.defineProperty,cI=Object.defineProperties,uI=Object.getOwnPropertyDescriptors,Tl=Object.getOwnPropertySymbols,hI=Object.prototype.hasOwnProperty,lI=Object.prototype.propertyIsEnumerable,Cl=(a,r,t)=>r in a?aI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Bn=(a,r)=>{for(var t in r||(r={}))hI.call(r,t)&&Cl(a,t,r[t]);if(Tl)for(var t of Tl(r))lI.call(r,t)&&Cl(a,t,r[t]);return a},lc=(a,r)=>cI(a,uI(r));class fI extends J_{constructor(r,t){super(r,t),this.relayer=r,this.logger=t,this.subscriptions=new Map,this.topicMap=new oI,this.events=new Or.EventEmitter,this.name=GE,this.version=WE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Pi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const c=_c(o),f={topic:n,relay:c};this.pending.set(n,f);const g=await this.rpcSubscribe(n,c);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),g}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof o?.id<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,c)=>{const f=new ne.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=JE&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=r,this.logger=Te.generateChildLogger(t,this.name),this.clientId=""}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(r,t){let n=!1;try{n=this.getSubscription(r).topic===t}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(r,t){const n=this.topicMap.get(r);await Promise.all(n.map(async o=>await this.unsubscribeById(r,o,t)))}async unsubscribeById(r,t,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}});try{const o=_c(n);await this.rpcUnsubscribe(r,t,o);const c=tr("USER_DISCONNECTED",`${this.name}, ${r}`);await this.onUnsubscribe(r,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:r,id:t,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(r,t){const n={method:go(t.protocol).subscribe,params:{topic:r}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Yn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}return vn(r+this.clientId)}async rpcBatchSubscribe(r){if(!r.length)return;const t=r[0].relay,n={method:go(t.protocol).batchSubscribe,params:{topics:r.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await Yn(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Gt.connection_stalled)}}rpcUnsubscribe(r,t,n){const o={method:go(n.protocol).unsubscribe,params:{topic:r,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(r,t){this.setSubscription(r,lc(Bn({},t),{id:r})),this.pending.delete(t.topic)}onBatchSubscribe(r){r.length&&r.forEach(t=>{this.setSubscription(t.id,Bn({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(r,t,n){this.events.removeAllListeners(t),this.hasSubscription(t,r)&&this.deleteSubscription(t,n),await this.relayer.messages.del(r)}async setRelayerSubscriptions(r){await this.relayer.core.storage.setItem(this.storageKey,r)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(r,t){this.subscriptions.has(r)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:r,subscription:t}),this.addSubscription(r,t))}addSubscription(r,t){this.subscriptions.set(r,Bn({},t)),this.topicMap.set(t.topic,r),this.events.emit(Dr.created,t)}getSubscription(r){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:r});const t=this.subscriptions.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}deleteSubscription(r,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:r,reason:t});const n=this.getSubscription(r);this.subscriptions.delete(r),this.topicMap.delete(n.topic,r),this.events.emit(Dr.deleted,lc(Bn({},n),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Dr.sync)}async reset(){if(this.cached.length){const r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<r;t++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Dr.resubscribed)}async restore(){try{const r=await this.getRelayerSubscriptions();if(typeof r>"u"||!r.length)return;if(this.subscriptions.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(r){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(r)}}async batchSubscribe(r){if(!r.length)return;const t=await this.rpcBatchSubscribe(r);_n(t)&&this.onBatchSubscribe(t.map((n,o)=>lc(Bn({},r[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const r=[];this.pending.forEach(t=>{r.push(t)}),await this.batchSubscribe(r)}registerEventListeners(){this.relayer.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Gt.connect,async()=>{await this.onConnect()}),this.relayer.on(Gt.disconnect,()=>{this.onDisconnect()}),this.events.on(Dr.created,async r=>{const t=Dr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()}),this.events.on(Dr.deleted,async r=>{const t=Dr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}async restartToComplete(){this.restartInProgress&&await new Promise(r=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),r())},this.pollingInterval)})}}var pI=Object.defineProperty,Nl=Object.getOwnPropertySymbols,dI=Object.prototype.hasOwnProperty,gI=Object.prototype.propertyIsEnumerable,$l=(a,r,t)=>r in a?pI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,yI=(a,r)=>{for(var t in r||(r={}))dI.call(r,t)&&$l(a,t,r[t]);if(Nl)for(var t of Nl(r))gI.call(r,t)&&$l(a,t,r[t]);return a};class vI extends G_{constructor(r){super(r),this.protocol="wc",this.version=2,this.events=new Or.EventEmitter,this.name=zE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(Gt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(Gt.error,t),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(oi.payload,this.onPayloadHandler),this.provider.on(oi.connect,this.onConnectHandler),this.provider.on(oi.disconnect,this.onDisconnectHandler),this.provider.on(oi.error,this.onProviderErrorHandler)},this.core=r.core,this.logger=typeof r.logger<"u"&&typeof r.logger!="string"?Te.generateChildLogger(r.logger,this.name):Te.pino(Te.getDefaultLoggerOptions({level:r.logger||ME})),this.messages=new nI(this.logger,r.core),this.subscriber=new fI(this,this.logger),this.publisher=new sI(this,this.logger),this.relayUrl=r?.relayUrl||kf,this.projectId=r.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Rl}...`),await this.restartTransport(Rl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},kE)}get context(){return Te.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(r,t,n){this.isInitialized(),await this.publisher.publish(r,t,n),await this.recordMessageEvent({topic:r,message:t,publishedAt:Date.now()})}async subscribe(r,t){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(r))==null?void 0:n[0])||"";if(o)return o;let c;const f=g=>{g.topic===r&&(this.subscriber.off(Dr.created,f),c())};return await Promise.all([new Promise(g=>{c=g,this.subscriber.on(Dr.created,f)}),new Promise(async g=>{o=await this.subscriber.subscribe(r,t),g()})]),o}async unsubscribe(r,t){this.isInitialized(),await this.subscriber.unsubscribe(r,t)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Yn(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(r){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){r&&r!==this.relayUrl&&(this.relayUrl=r,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(Dr.resubscribed,()=>{t()})}),new Promise(async(t,n)=>{try{await Yn(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}t()})])}catch(t){this.logger.error(t);const n=t;if(!this.isConnectionStalled(n.message))throw t;this.provider.events.emit(oi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(r){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=r||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Qh())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(r){return this.staleConnectionErrors.some(t=>r.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const r=await this.core.crypto.signJWT(this.relayUrl);this.provider=new hi(new tb(Hm({sdkVersion:BE,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:r,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(r){const{topic:t,message:n}=r;await this.messages.set(t,n)}async shouldIgnoreMessageEvent(r){const{topic:t,message:n}=r;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(r){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:r}),Bc(r)){if(!r.method.endsWith(UE))return;const t=r.params,{topic:n,message:o,publishedAt:c}=t.data,f={topic:n,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(yI({type:"event",event:t.id},f)),this.events.emit(t.id,f),await this.acknowledgePayload(r),await this.onMessageEvent(f)}else Oo(r)&&this.events.emit(Gt.message_ack,r)}async onMessageEvent(r){await this.shouldIgnoreMessageEvent(r)||(this.events.emit(Gt.message,r),await this.recordMessageEvent(r))}async acknowledgePayload(r){const t=Hc(r.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(oi.payload,this.onPayloadHandler),this.provider.off(oi.connect,this.onConnectHandler),this.provider.off(oi.disconnect,this.onDisconnectHandler),this.provider.off(oi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Gt.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let r=await Qh();Bm(async t=>{this.initialized&&r!==t&&(r=t,t?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Gt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(r=>this.logger.error(r))},ne.toMiliseconds(HE)))}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(r=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),r())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var mI=Object.defineProperty,Dl=Object.getOwnPropertySymbols,_I=Object.prototype.hasOwnProperty,wI=Object.prototype.propertyIsEnumerable,Fl=(a,r,t)=>r in a?mI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Ll=(a,r)=>{for(var t in r||(r={}))_I.call(r,t)&&Fl(a,t,r[t]);if(Dl)for(var t of Dl(r))wI.call(r,t)&&Fl(a,t,r[t]);return a};class Ao extends W_{constructor(r,t,n,o=Pi,c=void 0){super(r,t,n,o),this.core=r,this.logger=t,this.name=n,this.map=new Map,this.version=KE,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!xi(f)?this.map.set(this.getKey(f),f):Cm(f)?this.map.set(f.id,f):Nm(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(_=>ib(g[_],f[_]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const _=Ll(Ll({},this.getData(f)),g);this.map.set(f,_),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Te.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(r){await this.core.storage.setItem(this.storageKey,r)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(r){const t=this.map.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const r=await this.getDataStore();if(typeof r>"u"||!r.length)return;if(this.map.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(r){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(r)}}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class bI{constructor(r,t){this.core=r,this.logger=t,this.name=QE,this.version=YE,this.events=new qc,this.initialized=!1,this.storagePrefix=Pi,this.ignoredPayloadTypes=[of],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=mc(),o=await this.core.crypto.setSymKey(n),c=Fr(ne.FIVE_MINUTES),f={protocol:Bf},g={topic:o,expiry:c,relay:f,active:!1},_=km({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:f});return await this.pairings.set(o,g),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:_}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:c,relay:f}=Km(n.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:f}));const _=Fr(ne.FIVE_MINUTES),p={topic:o,relay:f,expiry:_,active:!1};return await this.pairings.set(o,p),this.core.expirer.set(o,_),n.activatePairing&&await this.activate({topic:o}),this.events.emit(Wn.create,p),p},this.activate=async({topic:n})=>{this.isInitialized();const o=Fr(ne.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:g,reject:_}=gn();this.events.once($t("pairing_ping",c),({error:p})=>{p?_(p):g()}),await f()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",tr("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,c)=>{const f=mn(o,c),g=await this.core.crypto.encode(n,f),_=Hn[o].req;return this.core.history.set(n,f),this.core.relayer.publish(n,g,_),f.id},this.sendResult=async(n,o,c)=>{const f=Hc(n,c),g=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,n),p=Hn[_.request.method].res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.sendError=async(n,o,c)=>{const f=So(n,c),g=await this.core.crypto.encode(o,f),_=await this.core.history.get(o,n),p=Hn[_.request.method]?Hn[_.request.method].res:Hn.unregistered_method.res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,tr("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>Ii(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:c}=n;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:c}=n,f=(await this.core.history.get(o,c.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(n,o)=>{const{id:c}=o;try{this.isValidPing({topic:n}),await this.sendResult(c,n,!0),this.events.emit(Wn.ping,{id:c,topic:n})}catch(f){await this.sendError(c,n,f),this.logger.error(f)}},this.onPairingPingResponse=(n,o)=>{const{id:c}=o;setTimeout(()=>{ci(o)?this.events.emit($t("pairing_ping",c),{}):Lr(o)&&this.events.emit($t("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Wn.delete,{id:c,topic:n})}catch(f){await this.sendError(c,n,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:c,method:f}=o;try{if(this.registeredMethods.includes(f))return;const g=tr("WC_METHOD_UNSUPPORTED",f);await this.sendError(c,n,g),this.logger.error(g)}catch(g){await this.sendError(c,n,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(tr("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!hr(n)){const{message:o}=Z("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(o)}if(!Vm(n.uri)){const{message:o}=Z("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(o)}},this.isValidPing=async n=>{if(!hr(n)){const{message:c}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!hr(n)){const{message:c}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(c)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!yn(n,!1)){const{message:o}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(Ii(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Z("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=r,this.logger=Te.generateChildLogger(t,this.name),this.pairings=new Ao(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Te.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}registerRelayerEvents(){this.core.relayer.on(Gt.message,async r=>{const{topic:t,message:n}=r;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(t,n);try{Bc(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Oo(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Sr.expired,async r=>{const{topic:t}=af(r.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(Wn.expire,{topic:t}))})}}class EI extends k_{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.records=new Map,this.events=new Or.EventEmitter,this.name=XE,this.version=ZE,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:c}),this.records.has(o.id))return;const f={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:c,expiry:Fr(ne.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Kr.created,f)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=Lr(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Kr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===n){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(Kr.deleted,c)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const r=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const n={topic:t.topic,request:mn(t.request.method,t.request.params,t.id),chainId:t.chainId};return r.push(n)}),r}async setJsonRpcRecords(r){await this.core.storage.setItem(this.storageKey,r)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(r){this.isInitialized();const t=this.records.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw new Error(n)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Kr.sync)}async restore(){try{const r=await this.getJsonRpcRecords();if(typeof r>"u"||!r.length)return;if(this.records.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(r){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(r)}}registerEventListeners(){this.events.on(Kr.created,r=>{const t=Kr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Kr.updated,r=>{const t=Kr.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.events.on(Kr.deleted,r=>{const t=Kr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:r}),this.persist()}),this.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(r=>{ne.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.delete(r.topic,r.id))})}catch(r){this.logger.warn(r)}}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class II extends Q_{constructor(r,t){super(r,t),this.core=r,this.logger=t,this.expirations=new Map,this.events=new Or.EventEmitter,this.name=eI,this.version=tI,this.cached=[],this.initialized=!1,this.storagePrefix=Pi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const c=this.formatTarget(n),f={target:c,expiry:o};this.expirations.set(c,f),this.checkExpiry(c,f),this.events.emit(Sr.created,{target:c,expiration:f})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Sr.deleted,{target:o,expiration:c})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Te.generateChildLogger(t,this.name)}get context(){return Te.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(r){if(typeof r=="string")return Gm(r);if(typeof r=="number")return Wm(r);const{message:t}=Z("UNKNOWN_TYPE",`Target type: ${typeof r}`);throw new Error(t)}async setExpirations(r){await this.core.storage.setItem(this.storageKey,r)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Sr.sync)}async restore(){try{const r=await this.getExpirations();if(typeof r>"u"||!r.length)return;if(this.expirations.size){const{message:t}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=r,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(r){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(r)}}getExpiration(r){const t=this.expirations.get(r);if(!t){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${r}`);throw this.logger.error(n),new Error(n)}return t}checkExpiry(r,t){const{expiry:n}=t;ne.toMiliseconds(n)-Date.now()<=0&&this.expire(r,t)}expire(r,t){this.expirations.delete(r),this.events.emit(Sr.expired,{target:r,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((r,t)=>this.checkExpiry(t,r))}registerEventListeners(){this.core.heartbeat.on(wn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Sr.created,r=>{const t=Sr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Sr.expired,r=>{const t=Sr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()}),this.events.on(Sr.deleted,r=>{const t=Sr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:r}),this.persist()})}isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}}}class xI extends Y_{constructor(r,t){super(r,t),this.projectId=r,this.logger=t,this.name=hc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async()=>{if(this.verifyDisabled||Jm()||!cf())return;const n=_o;this.verifyUrl!==n&&this.removeIframe(),this.verifyUrl=n;try{await this.createIframe()}catch(o){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(o)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Al;try{await this.createIframe()}catch(o){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(o),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=n?.verifyUrl||_o;let c;try{c=await this.fetchAttestation(n.attestationId,o)}catch(f){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(f),c=await this.fetchAttestation(n.attestationId,Al)}return c},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const c=this.startAbortTimer(ne.ONE_SECOND*2),f=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(c),f.status===200?await f.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(c=>{if(document.getElementById(hc))return c();window.addEventListener("message",o);const f=document.createElement("iframe");f.id=hc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,n=c}),new Promise((c,f)=>setTimeout(()=>{window.removeEventListener("message",o),f("verify iframe load timeout")},ne.toMiliseconds(ne.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=Te.generateChildLogger(t,this.name),this.verifyUrl=_o,this.abortController=new AbortController,this.isDevEnv=Qm()&&{}.IS_VITEST}get context(){return Te.getLoggerContext(this.logger)}startAbortTimer(r){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ne.toMiliseconds(r))}}var PI=Object.defineProperty,jl=Object.getOwnPropertySymbols,SI=Object.prototype.hasOwnProperty,OI=Object.prototype.propertyIsEnumerable,ql=(a,r,t)=>r in a?PI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Ml=(a,r)=>{for(var t in r||(r={}))SI.call(r,t)&&ql(a,t,r[t]);if(jl)for(var t of jl(r))OI.call(r,t)&&ql(a,t,r[t]);return a};class Kc extends B_{constructor(r){super(r),this.protocol=Hf,this.version=RE,this.name=kc,this.events=new Or.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=r?.projectId,this.relayUrl=r?.relayUrl||kf,this.customStoragePrefix=r!=null&&r.customStoragePrefix?`:${r.customStoragePrefix}`:"";const t=typeof r?.logger<"u"&&typeof r?.logger!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:r?.logger||AE.logger}));this.logger=Te.generateChildLogger(t,this.name),this.heartbeat=new wn.HeartBeat,this.crypto=new iI(this,this.logger,r?.keychain),this.history=new EI(this,this.logger),this.expirer=new II(this,this.logger),this.storage=r!=null&&r.storage?r.storage:new G1(Ml(Ml({},TE),r?.storageOptions)),this.relayer=new vI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new bI(this,this.logger),this.verify=new xI(this.projectId||"",this.logger)}static async init(r){const t=new Kc(r);await t.initialize();const n=await t.crypto.getClientId();return await t.storage.setItem(VE,n),t}get context(){return Te.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(r){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,r),this.logger.error(r.message),r}}}const RI=Kc,Kf="wc",Vf=2,Gf="client",Vc=`${Kf}@${Vf}:${Gf}:`,fc={name:Gf,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},zl="WALLETCONNECT_DEEPLINK_CHOICE",AI="proposal",Wf="Proposal expired",TI="session",lo=ne.SEVEN_DAYS,CI="engine",kn={wc_sessionPropose:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ne.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ne.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ne.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ne.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ne.THIRTY_SECONDS,prompt:!1,tag:1115}}},pc={min:ne.FIVE_MINUTES,max:ne.SEVEN_DAYS},ai={idle:"IDLE",active:"ACTIVE"},NI="request",$I=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var DI=Object.defineProperty,FI=Object.defineProperties,LI=Object.getOwnPropertyDescriptors,Ul=Object.getOwnPropertySymbols,jI=Object.prototype.hasOwnProperty,qI=Object.prototype.propertyIsEnumerable,Hl=(a,r,t)=>r in a?DI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,cr=(a,r)=>{for(var t in r||(r={}))jI.call(r,t)&&Hl(a,t,r[t]);if(Ul)for(var t of Ul(r))qI.call(r,t)&&Hl(a,t,r[t]);return a},Kn=(a,r)=>FI(a,LI(r));class MI extends Z_{constructor(r){super(r),this.name=CI,this.events=new qc,this.initialized=!1,this.ignoredPayloadTypes=[of],this.requestQueue={state:ai.idle,queue:[]},this.sessionRequestQueue={state:ai.idle,queue:[]},this.requestQueueDelay=ne.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(kn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const n=Kn(cr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:f,sessionProperties:g,relays:_}=n;let p=o,b,A=!1;if(p&&(A=this.client.core.pairing.pairings.get(p).active),!p||!A){const{topic:fe,uri:pe}=await this.client.core.pairing.create();p=fe,b=pe}const x=await this.client.core.crypto.generateKeyPair(),D=cr({requiredNamespaces:c,optionalNamespaces:f,relays:_??[{protocol:Bf}],proposer:{publicKey:x,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:C,resolve:K,done:re}=gn(ne.FIVE_MINUTES,Wf);if(this.events.once($t("session_connect"),async({error:fe,session:pe})=>{if(fe)C(fe);else if(pe){pe.self.publicKey=x;const de=Kn(cr({},pe),{requiredNamespaces:pe.requiredNamespaces,optionalNamespaces:pe.optionalNamespaces});await this.client.session.set(pe.topic,de),await this.setExpiry(pe.topic,pe.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:pe.peer.metadata}),K(de)}}),!p){const{message:fe}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error(fe)}const he=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:D}),le=Fr(ne.FIVE_MINUTES);return await this.setProposal(he,cr({id:he,expiry:le},D)),{uri:b,approval:re}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:n,relayProtocol:o,namespaces:c,sessionProperties:f}=t,g=this.client.proposal.get(n);let{pairingTopic:_,proposer:p,requiredNamespaces:b,optionalNamespaces:A}=g;_=_||"",yo(b)||(b=Xm(c,"approve()"));const x=await this.client.core.crypto.generateKeyPair(),D=p.publicKey,C=await this.client.core.crypto.generateSharedKey(x,D);_&&n&&(await this.client.core.pairing.updateMetadata({topic:_,metadata:p.metadata}),await this.sendResult({id:n,topic:_,result:{relay:{protocol:o??"irn"},responderPublicKey:x}}),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:_}));const K=cr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:b,optionalNamespaces:A,pairingTopic:_,controller:{publicKey:x,metadata:this.client.metadata},expiry:Fr(lo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(C),await this.sendRequest({topic:C,method:"wc_sessionSettle",params:K,throwOnFailedPublish:!0});const re=Kn(cr({},K),{topic:C,pairingTopic:_,acknowledged:!1,self:K.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:x});return await this.client.session.set(C,re),await this.setExpiry(C,Fr(lo)),{topic:C,acknowledged:()=>new Promise(he=>setTimeout(()=>he(this.client.session.get(C)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:n,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(n);c&&(await this.sendError(n,c,o),await this.client.proposal.delete(n,tr("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:n,namespaces:o}=t,c=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:f,resolve:g,reject:_}=gn();return this.events.once($t("session_update",c),({error:p})=>{p?_(p):g()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:f}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:n}=t,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:c,resolve:f,reject:g}=gn();return this.events.once($t("session_extend",o),({error:_})=>{_?g(_):f()}),await this.setExpiry(n,Fr(lo)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:n,request:o,topic:c,expiry:f}=t,g=Uc(),{done:_,resolve:p,reject:b}=gn(f,"Request expired. Please try again.");return this.events.once($t("session_request",g),({error:A,result:x})=>{A?b(A):p(x)}),await Promise.all([new Promise(async A=>{await this.sendRequest({clientRpcId:g,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:f,throwOnFailedPublish:!0}).catch(x=>b(x)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:n,id:g}),A()}),new Promise(async A=>{const x=await this.client.core.storage.getItem(zl);Zm({id:g,topic:c,wcDeepLink:x}),A()}),_()]).then(A=>A[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:n,response:o}=t,{id:c}=o;ci(o)?await this.sendResult({id:c,topic:n,result:o.result,throwOnFailedPublish:!0}):Lr(o)&&await this.sendError(c,n,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:n}=t;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:c,resolve:f,reject:g}=gn();this.events.once($t("session_ping",o),({error:_})=>{_?g(_):f()}),await c()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:n,event:o,chainId:c}=t;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:n}=t;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:tr("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(n=>e1(n,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const n=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var f,g;return((f=c.peerMetadata)==null?void 0:f.url)&&((g=c.peerMetadata)==null?void 0:g.url)===t.peer.metadata.url&&c.topic&&c.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(t,n)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,tr("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),n||this.client.core.expirer.del(t),this.client.core.storage.removeItem(zl).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(t,n)=>{await Promise.all([this.client.proposal.delete(t,tr("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,n),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=ai.idle)},this.setExpiry=async(t,n)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:n}),this.client.core.expirer.set(t,n)},this.setProposal=async(t,n)=>{await this.client.proposal.set(t,n),this.client.core.expirer.set(t,n.expiry)},this.setPendingSessionRequest=async t=>{const n=kn.wc_sessionRequest.req.ttl,{id:o,topic:c,params:f,verifyContext:g}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:f,verifyContext:g}),n&&this.client.core.expirer.set(o,Fr(n))},this.sendRequest=async t=>{const{topic:n,method:o,params:c,expiry:f,relayRpcId:g,clientRpcId:_,throwOnFailedPublish:p}=t,b=mn(o,c,_);if(cf()&&$I.includes(o)){const D=vn(JSON.stringify(b));this.client.core.verify.register({attestationId:D})}const A=await this.client.core.crypto.encode(n,b),x=kn[o].req;return f&&(x.ttl=f),g&&(x.id=g),this.client.core.history.set(n,b),p?(x.internal=Kn(cr({},x.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,A,x)):this.client.core.relayer.publish(n,A,x).catch(D=>this.client.logger.error(D)),b.id},this.sendResult=async t=>{const{id:n,topic:o,result:c,throwOnFailedPublish:f}=t,g=Hc(n,c),_=await this.client.core.crypto.encode(o,g),p=await this.client.core.history.get(o,n),b=kn[p.request.method].res;f?(b.internal=Kn(cr({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,_,b)):this.client.core.relayer.publish(o,_,b).catch(A=>this.client.logger.error(A)),await this.client.core.history.resolve(g)},this.sendError=async(t,n,o)=>{const c=So(t,o),f=await this.client.core.crypto.encode(n,c),g=await this.client.core.history.get(n,t),_=kn[g.request.method].res;this.client.core.relayer.publish(n,f,_),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],n=[];this.client.session.getAll().forEach(o=>{Ii(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Ii(o.expiry)&&n.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===ai.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=ai.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=ai.idle},this.processRequest=t=>{const{topic:n,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:n,payload:o}=t,c=(await this.client.core.history.get(n,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:n}=t,{message:o}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,n)=>{const{params:o,id:c}=n;try{this.isValidConnect(cr({},n.params));const f=Fr(ne.FIVE_MINUTES),g=cr({id:c,pairingTopic:t,expiry:f},o);await this.setProposal(c,g);const _=vn(JSON.stringify(n)),p=await this.getVerifyContext(_,g.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:g,verifyContext:p})}catch(f){await this.sendError(c,t,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(t,n)=>{const{id:o}=n;if(ci(n)){const{result:c}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const _=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:_});const p=await this.client.core.crypto.generateSharedKey(g,_);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const b=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:t})}else Lr(n)&&(await this.client.proposal.delete(o,tr("USER_DISCONNECTED")),this.events.emit($t("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(t,n)=>{const{id:o,params:c}=n;try{this.isValidSessionSettleRequest(c);const{relay:f,controller:g,expiry:_,namespaces:p,requiredNamespaces:b,optionalNamespaces:A,sessionProperties:x,pairingTopic:D}=n.params,C=cr({topic:t,relay:f,expiry:_,namespaces:p,acknowledged:!0,pairingTopic:D,requiredNamespaces:b,optionalNamespaces:A,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},x&&{sessionProperties:x});await this.sendResult({id:n.id,topic:t,result:!0}),this.events.emit($t("session_connect"),{session:C}),this.cleanupDuplicatePairings(C)}catch(f){await this.sendError(o,t,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(t,n)=>{const{id:o}=n;ci(n)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit($t("session_approve",o),{})):Lr(n)&&(await this.client.session.delete(t,tr("USER_DISCONNECTED")),this.events.emit($t("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(t,n)=>{const{params:o,id:c}=n;try{const f=`${t}_session_update`,g=co.get(f);if(g&&this.isRequestOutOfSync(g,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(cr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),co.set(f,c)}catch(f){await this.sendError(c,t,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(t,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,n)=>{const{id:o}=n;ci(n)?this.events.emit($t("session_update",o),{}):Lr(n)&&this.events.emit($t("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(t,n)=>{const{id:o}=n;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Fr(lo)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,n)=>{const{id:o}=n;ci(n)?this.events.emit($t("session_extend",o),{}):Lr(n)&&this.events.emit($t("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(t,n)=>{const{id:o}=n;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,n)=>{const{id:o}=n;setTimeout(()=>{ci(n)?this.events.emit($t("session_ping",o),{}):Lr(n)&&this.events.emit($t("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(t,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:t,reason:n.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(Gt.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:o,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,n)=>{const{id:o,params:c}=n;try{this.isValidRequest(cr({topic:t},c));const f=vn(JSON.stringify(mn("wc_sessionRequest",c,o))),g=this.client.session.get(t),_=await this.getVerifyContext(f,g.peer.metadata),p={id:o,topic:t,params:c,verifyContext:_};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(f){await this.sendError(o,t,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(t,n)=>{const{id:o}=n;ci(n)?this.events.emit($t("session_request",o),{result:n.result}):Lr(n)&&this.events.emit($t("session_request",o),{error:n.error})},this.onSessionEventRequest=async(t,n)=>{const{id:o,params:c}=n;try{const f=`${t}_session_event_${c.event.name}`,g=co.get(f);if(g&&this.isRequestOutOfSync(g,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(cr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),co.set(f,o)}catch(f){await this.sendError(o,t,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=ai.idle,this.processSessionRequestQueue()},ne.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===ai.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=ai.active,this.client.events.emit("session_request",t)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=t=>{if(t.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===t.topic);n&&this.onSessionProposeRequest(t.topic,mn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer},n.id))},this.isValidConnect=async t=>{if(!hr(t)){const{message:_}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(_)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:f,relays:g}=t;if(xi(n)||await this.isValidPairingTopic(n),!t1(g,!0)){const{message:_}=Z("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(_)}!xi(o)&&yo(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!xi(c)&&yo(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),xi(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(t,n)=>{const o=r1(t,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!hr(t))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:n,namespaces:o,relayProtocol:c,sessionProperties:f}=t;await this.isValidProposalId(n);const g=this.client.proposal.get(n),_=tc(o,"approve()");if(_)throw new Error(_.message);const p=Yh(g.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!yn(c,!0)){const{message:b}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(b)}xi(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async t=>{if(!hr(t)){const{message:c}=Z("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:n,reason:o}=t;if(await this.isValidProposalId(n),!i1(o)){const{message:c}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!hr(t)){const{message:p}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(p)}const{relay:n,controller:o,namespaces:c,expiry:f}=t;if(!n1(n)){const{message:p}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const g=s1(o,"onSessionSettleRequest()");if(g)throw new Error(g.message);const _=tc(c,"onSessionSettleRequest()");if(_)throw new Error(_.message);if(Ii(f)){const{message:p}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async t=>{if(!hr(t)){const{message:_}=Z("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(_)}const{topic:n,namespaces:o}=t;await this.isValidSessionTopic(n);const c=this.client.session.get(n),f=tc(o,"update()");if(f)throw new Error(f.message);const g=Yh(c.requiredNamespaces,o,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async t=>{if(!hr(t)){const{message:o}=Z("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:n}=t;await this.isValidSessionTopic(n)},this.isValidRequest=async t=>{if(!hr(t)){const{message:_}=Z("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(_)}const{topic:n,request:o,chainId:c,expiry:f}=t;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!Xh(g,c)){const{message:_}=Z("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(_)}if(!o1(o)){const{message:_}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(_)}if(!a1(g,c,o.method)){const{message:_}=Z("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(_)}if(f&&!c1(f,pc)){const{message:_}=Z("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${pc.min} and ${pc.max}`);throw new Error(_)}},this.isValidRespond=async t=>{if(!hr(t)){const{message:c}=Z("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:n,response:o}=t;if(await this.isValidSessionTopic(n),!u1(o)){const{message:c}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!hr(t)){const{message:o}=Z("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async t=>{if(!hr(t)){const{message:g}=Z("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(g)}const{topic:n,event:o,chainId:c}=t;await this.isValidSessionTopic(n);const{namespaces:f}=this.client.session.get(n);if(!Xh(f,c)){const{message:g}=Z("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(g)}if(!h1(o)){const{message:g}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}if(!l1(f,c,o.name)){const{message:g}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidDisconnect=async t=>{if(!hr(t)){const{message:o}=Z("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:n}=t;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(t,n)=>{const o={verified:{verifyUrl:n.verifyUrl||_o,validation:"UNKNOWN",origin:n.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:n.verifyUrl});c&&(o.verified.origin=c.origin,o.verified.isScam=c.isScam,o.verified.validation=c.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.info(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,n)=>{Object.values(t).forEach(o=>{if(!yn(o,!1)){const{message:c}=Z("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:r}=Z("NOT_INITIALIZED",this.name);throw new Error(r)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Gt.message,async r=>{const{topic:t,message:n}=r;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(t,n);try{Bc(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):Oo(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Sr.expired,async r=>{const{topic:t,id:n}=af(r.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Z("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Wn.create,r=>this.onPairingCreated(r))}isValidPairingTopic(r){if(!yn(r,!1)){const{message:t}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${r}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(r)){const{message:t}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${r}`);throw new Error(t)}if(Ii(this.client.core.pairing.pairings.get(r).expiry)){const{message:t}=Z("EXPIRED",`pairing topic: ${r}`);throw new Error(t)}}async isValidSessionTopic(r){if(!yn(r,!1)){const{message:t}=Z("MISSING_OR_INVALID",`session topic should be a string: ${r}`);throw new Error(t)}if(!this.client.session.keys.includes(r)){const{message:t}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${r}`);throw new Error(t)}if(Ii(this.client.session.get(r).expiry)){await this.deleteSession(r);const{message:t}=Z("EXPIRED",`session topic: ${r}`);throw new Error(t)}}async isValidSessionOrPairingTopic(r){if(this.client.session.keys.includes(r))await this.isValidSessionTopic(r);else if(this.client.core.pairing.pairings.keys.includes(r))this.isValidPairingTopic(r);else if(yn(r,!1)){const{message:t}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${r}`);throw new Error(t)}else{const{message:t}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${r}`);throw new Error(t)}}async isValidProposalId(r){if(!f1(r)){const{message:t}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${r}`);throw new Error(t)}if(!this.client.proposal.keys.includes(r)){const{message:t}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${r}`);throw new Error(t)}if(Ii(this.client.proposal.get(r).expiry)){await this.deleteProposal(r);const{message:t}=Z("EXPIRED",`proposal id: ${r}`);throw new Error(t)}}}class zI extends Ao{constructor(r,t){super(r,t,AI,Vc),this.core=r,this.logger=t}}class UI extends Ao{constructor(r,t){super(r,t,TI,Vc),this.core=r,this.logger=t}}class HI extends Ao{constructor(r,t){super(r,t,NI,Vc,n=>n.id),this.core=r,this.logger=t}}let BI=class Jf extends X_{constructor(r){super(r),this.protocol=Kf,this.version=Vf,this.name=fc.name,this.events=new Or.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=r?.name||fc.name,this.metadata=r?.metadata||Ym();const t=typeof r?.logger<"u"&&typeof r?.logger!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:r?.logger||fc.logger}));this.core=r?.core||new RI(r),this.logger=Te.generateChildLogger(t,this.name),this.session=new UI(this.core,this.logger),this.proposal=new zI(this.core,this.logger),this.pendingRequest=new HI(this.core,this.logger),this.engine=new MI(this)}static async init(r){const t=new Jf(r);return await t.initialize(),t}get context(){return Te.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(r){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(r.message),r}}};var Nc={exports:{}};(function(a,r){var t=typeof self<"u"?self:jr,n=function(){function c(){this.fetch=!1,this.DOMException=t.DOMException}return c.prototype=t,new c}();(function(c){(function(f){var g={searchParams:"URLSearchParams"in c,iterable:"Symbol"in c&&"iterator"in Symbol,blob:"FileReader"in c&&"Blob"in c&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in c,arrayBuffer:"ArrayBuffer"in c};function _(m){return m&&DataView.prototype.isPrototypeOf(m)}if(g.arrayBuffer)var p=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],b=ArrayBuffer.isView||function(m){return m&&p.indexOf(Object.prototype.toString.call(m))>-1};function A(m){if(typeof m!="string"&&(m=String(m)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(m))throw new TypeError("Invalid character in header field name");return m.toLowerCase()}function x(m){return typeof m!="string"&&(m=String(m)),m}function D(m){var P={next:function(){var Y=m.shift();return{done:Y===void 0,value:Y}}};return g.iterable&&(P[Symbol.iterator]=function(){return P}),P}function C(m){this.map={},m instanceof C?m.forEach(function(P,Y){this.append(Y,P)},this):Array.isArray(m)?m.forEach(function(P){this.append(P[0],P[1])},this):m&&Object.getOwnPropertyNames(m).forEach(function(P){this.append(P,m[P])},this)}C.prototype.append=function(m,P){m=A(m),P=x(P);var Y=this.map[m];this.map[m]=Y?Y+", "+P:P},C.prototype.delete=function(m){delete this.map[A(m)]},C.prototype.get=function(m){return m=A(m),this.has(m)?this.map[m]:null},C.prototype.has=function(m){return this.map.hasOwnProperty(A(m))},C.prototype.set=function(m,P){this.map[A(m)]=x(P)},C.prototype.forEach=function(m,P){for(var Y in this.map)this.map.hasOwnProperty(Y)&&m.call(P,this.map[Y],Y,this)},C.prototype.keys=function(){var m=[];return this.forEach(function(P,Y){m.push(Y)}),D(m)},C.prototype.values=function(){var m=[];return this.forEach(function(P){m.push(P)}),D(m)},C.prototype.entries=function(){var m=[];return this.forEach(function(P,Y){m.push([Y,P])}),D(m)},g.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function K(m){if(m.bodyUsed)return Promise.reject(new TypeError("Already read"));m.bodyUsed=!0}function re(m){return new Promise(function(P,Y){m.onload=function(){P(m.result)},m.onerror=function(){Y(m.error)}})}function he(m){var P=new FileReader,Y=re(P);return P.readAsArrayBuffer(m),Y}function le(m){var P=new FileReader,Y=re(P);return P.readAsText(m),Y}function fe(m){for(var P=new Uint8Array(m),Y=new Array(P.length),ce=0;ce<P.length;ce++)Y[ce]=String.fromCharCode(P[ce]);return Y.join("")}function pe(m){if(m.slice)return m.slice(0);var P=new Uint8Array(m.byteLength);return P.set(new Uint8Array(m)),P.buffer}function de(){return this.bodyUsed=!1,this._initBody=function(m){this._bodyInit=m,m?typeof m=="string"?this._bodyText=m:g.blob&&Blob.prototype.isPrototypeOf(m)?this._bodyBlob=m:g.formData&&FormData.prototype.isPrototypeOf(m)?this._bodyFormData=m:g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)?this._bodyText=m.toString():g.arrayBuffer&&g.blob&&_(m)?(this._bodyArrayBuffer=pe(m.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):g.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(m)||b(m))?this._bodyArrayBuffer=pe(m):this._bodyText=m=Object.prototype.toString.call(m):this._bodyText="",this.headers.get("content-type")||(typeof m=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):g.searchParams&&URLSearchParams.prototype.isPrototypeOf(m)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},g.blob&&(this.blob=function(){var m=K(this);if(m)return m;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?K(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(he)}),this.text=function(){var m=K(this);if(m)return m;if(this._bodyBlob)return le(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(fe(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},g.formData&&(this.formData=function(){return this.text().then(ve)}),this.json=function(){return this.text().then(JSON.parse)},this}var L=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function U(m){var P=m.toUpperCase();return L.indexOf(P)>-1?P:m}function W(m,P){P=P||{};var Y=P.body;if(m instanceof W){if(m.bodyUsed)throw new TypeError("Already read");this.url=m.url,this.credentials=m.credentials,P.headers||(this.headers=new C(m.headers)),this.method=m.method,this.mode=m.mode,this.signal=m.signal,!Y&&m._bodyInit!=null&&(Y=m._bodyInit,m.bodyUsed=!0)}else this.url=String(m);if(this.credentials=P.credentials||this.credentials||"same-origin",(P.headers||!this.headers)&&(this.headers=new C(P.headers)),this.method=U(P.method||this.method||"GET"),this.mode=P.mode||this.mode||null,this.signal=P.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&Y)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(Y)}W.prototype.clone=function(){return new W(this,{body:this._bodyInit})};function ve(m){var P=new FormData;return m.trim().split("&").forEach(function(Y){if(Y){var ce=Y.split("="),V=ce.shift().replace(/\+/g," "),H=ce.join("=").replace(/\+/g," ");P.append(decodeURIComponent(V),decodeURIComponent(H))}}),P}function ie(m){var P=new C,Y=m.replace(/\r?\n[\t ]+/g," ");return Y.split(/\r?\n/).forEach(function(ce){var V=ce.split(":"),H=V.shift().trim();if(H){var k=V.join(":").trim();P.append(H,k)}}),P}de.call(W.prototype);function ue(m,P){P||(P={}),this.type="default",this.status=P.status===void 0?200:P.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in P?P.statusText:"OK",this.headers=new C(P.headers),this.url=P.url||"",this._initBody(m)}de.call(ue.prototype),ue.prototype.clone=function(){return new ue(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},ue.error=function(){var m=new ue(null,{status:0,statusText:""});return m.type="error",m};var Ce=[301,302,303,307,308];ue.redirect=function(m,P){if(Ce.indexOf(P)===-1)throw new RangeError("Invalid status code");return new ue(null,{status:P,headers:{location:m}})},f.DOMException=c.DOMException;try{new f.DOMException}catch{f.DOMException=function(P,Y){this.message=P,this.name=Y;var ce=Error(P);this.stack=ce.stack},f.DOMException.prototype=Object.create(Error.prototype),f.DOMException.prototype.constructor=f.DOMException}function ze(m,P){return new Promise(function(Y,ce){var V=new W(m,P);if(V.signal&&V.signal.aborted)return ce(new f.DOMException("Aborted","AbortError"));var H=new XMLHttpRequest;function k(){H.abort()}H.onload=function(){var G={status:H.status,statusText:H.statusText,headers:ie(H.getAllResponseHeaders()||"")};G.url="responseURL"in H?H.responseURL:G.headers.get("X-Request-URL");var Je="response"in H?H.response:H.responseText;Y(new ue(Je,G))},H.onerror=function(){ce(new TypeError("Network request failed"))},H.ontimeout=function(){ce(new TypeError("Network request failed"))},H.onabort=function(){ce(new f.DOMException("Aborted","AbortError"))},H.open(V.method,V.url,!0),V.credentials==="include"?H.withCredentials=!0:V.credentials==="omit"&&(H.withCredentials=!1),"responseType"in H&&g.blob&&(H.responseType="blob"),V.headers.forEach(function(G,Je){H.setRequestHeader(Je,G)}),V.signal&&(V.signal.addEventListener("abort",k),H.onreadystatechange=function(){H.readyState===4&&V.signal.removeEventListener("abort",k)}),H.send(typeof V._bodyInit>"u"?null:V._bodyInit)})}return ze.polyfill=!0,c.fetch||(c.fetch=ze,c.Headers=C,c.Request=W,c.Response=ue),f.Headers=C,f.Request=W,f.Response=ue,f.fetch=ze,Object.defineProperty(f,"__esModule",{value:!0}),f})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var o=n;r=o.fetch,r.default=o.fetch,r.fetch=o.fetch,r.Headers=o.Headers,r.Request=o.Request,r.Response=o.Response,a.exports=r})(Nc,Nc.exports);var kI=Nc.exports;const Bl=sf(kI),KI={Accept:"application/json","Content-Type":"application/json"},VI="POST",kl={headers:KI,method:VI},Kl=10;class Oi{constructor(r,t=!1){if(this.url=r,this.disableProviderPing=t,this.events=new Or.EventEmitter,this.isAvailable=!1,this.registering=!1,!vl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);this.url=r,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}off(r,t){this.events.off(r,t)}removeListener(r,t){this.events.removeListener(r,t)}async open(r=this.url){await this.register(r)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(r,t){this.isAvailable||await this.register();try{const n=ki(r),c=await(await Bl(this.url,Object.assign(Object.assign({},kl),{body:n}))).json();this.onPayload({data:c})}catch(n){this.onError(r.id,n)}}async register(r=this.url){if(!vl(r))throw new Error(`Provided URL is not compatible with HTTP connection: ${r}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((n,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));n()})})}this.url=r,this.registering=!0;try{if(!this.disableProviderPing){const t=ki({id:1,jsonrpc:"2.0",method:"test",params:[]});await Bl(r,Object.assign(Object.assign({},kl),{body:t}))}this.onOpen()}catch(t){const n=this.parseError(t);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(r){if(typeof r.data>"u")return;const t=typeof r.data=="string"?rs(r.data):r.data;this.events.emit("payload",t)}onError(r,t){const n=this.parseError(t),o=n.message||n.toString(),c=So(r,o);this.events.emit("payload",c)}parseError(r,t=this.url){return Pf(r,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Kl&&this.events.setMaxListeners(Kl)}}const Vl="error",GI="wss://relay.walletconnect.com",WI="wc",JI="universal_provider",Gl=`${WI}@2:${JI}:`,QI="https://rpc.walletconnect.com/v1/",li={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Vn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ui<"u"?ui:typeof self<"u"?self:{},$c={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(a,r){(function(){var t,n="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",_="__lodash_hash_undefined__",p=500,b="__lodash_placeholder__",A=1,x=2,D=4,C=1,K=2,re=1,he=2,le=4,fe=8,pe=16,de=32,L=64,U=128,W=256,ve=512,ie=30,ue="...",Ce=800,ze=16,m=1,P=2,Y=3,ce=1/0,V=9007199254740991,H=17976931348623157e292,k=0/0,G=4294967295,Je=G-1,Be=G>>>1,qr=[["ary",U],["bind",re],["bindKey",he],["curry",fe],["curryRight",pe],["flip",ve],["partial",de],["partialRight",L],["rearg",W]],Ie="[object Arguments]",It="[object Array]",F="[object AsyncFunction]",$="[object Boolean]",T="[object Date]",h="[object DOMException]",I="[object Error]",ee="[object Function]",ge="[object GeneratorFunction]",be="[object Map]",Ne="[object Number]",De="[object Null]",Se="[object Object]",xt="[object Promise]",mt="[object Proxy]",ot="[object RegExp]",Le="[object Set]",Ye="[object String]",Xe="[object Symbol]",at="[object Undefined]",Ue="[object WeakMap]",Ze="[object WeakSet]",$e="[object ArrayBuffer]",ke="[object DataView]",ht="[object Float32Array]",qe="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",Ut="[object Int32Array]",Ht="[object Uint8Array]",jt="[object Uint8ClampedArray]",Wt="[object Uint16Array]",rr="[object Uint32Array]",Mr=/\b__p \+= '';/g,Jt=/\b(__p \+=) '' \+/g,Vr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,fi=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,lt=RegExp(fi.source),rt=RegExp(Ri.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,ct=/<%=([\s\S]+?)%>/g,it=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,St=/^\w*$/,Ot=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,Rt=RegExp(dt.source),gt=/^\s+/,_t=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Qe=/\{\n\/\* \[wrapped with (.+)\] \*/,At=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,To=/[()=,{}\[\]\/\s]/,Co=/\\(\\)?/g,No=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vr=/\w*$/,$o=/^[-+]0x[0-9a-f]+$/i,Do=/^0b[01]+$/i,Fo=/^\[object .+?Constructor\]$/,Lo=/^0o[0-7]+$/i,jo=/^(?:0|[1-9]\d*)$/,Gr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Wi=/($^)/,qo=/['\n\r\u2028\u2029\\]/g,Ji="\\ud800-\\udfff",Mo="\\u0300-\\u036f",zo="\\ufe20-\\ufe2f",Qi="\\u20d0-\\u20ff",ns=Mo+zo+Qi,ss="\\u2700-\\u27bf",Rr="a-z\\xdf-\\xf6\\xf8-\\xff",Uo="\\xac\\xb1\\xd7\\xf7",Ho="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Bo="\\u2000-\\u206f",ko=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",os="A-Z\\xc0-\\xd6\\xd8-\\xde",as="\\ufe0e\\ufe0f",Ai=Uo+Ho+Bo+ko,bn="['’]",Ti="["+Ji+"]",En="["+Ai+"]",Ci="["+ns+"]",cs="\\d+",Ko="["+ss+"]",us="["+Rr+"]",hs="[^"+Ji+Ai+cs+ss+Rr+os+"]",Yi="\\ud83c[\\udffb-\\udfff]",Vo="(?:"+Ci+"|"+Yi+")",ls="[^"+Ji+"]",Xi="(?:\\ud83c[\\udde6-\\uddff]){2}",pi="[\\ud800-\\udbff][\\udc00-\\udfff]",lr="["+os+"]",fs="\\u200d",ps="(?:"+us+"|"+hs+")",zr="(?:"+lr+"|"+hs+")",ds="(?:"+bn+"(?:d|ll|m|re|s|t|ve))?",gs="(?:"+bn+"(?:D|LL|M|RE|S|T|VE))?",ys=Vo+"?",vs="["+as+"]?",Go="(?:"+fs+"(?:"+[ls,Xi,pi].join("|")+")"+vs+ys+")*",Wr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",ms="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",_s=vs+ys+Go,Zi="(?:"+[Ko,Xi,pi].join("|")+")"+_s,Wo="(?:"+[ls+Ci+"?",Ci,Xi,pi,Ti].join("|")+")",In=RegExp(bn,"g"),Jo=RegExp(Ci,"g"),en=RegExp(Yi+"(?="+Yi+")|"+Wo+_s,"g"),ws=RegExp([lr+"?"+us+"+"+ds+"(?="+[En,lr,"$"].join("|")+")",zr+"+"+gs+"(?="+[En,lr+ps,"$"].join("|")+")",lr+"?"+ps+"+"+ds,lr+"+"+gs,ms,Wr,cs,Zi].join("|"),"g"),bs=RegExp("["+fs+Ji+ns+as+"]"),Ni=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Es=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Qo=-1,Ke={};Ke[ht]=Ke[qe]=Ke[Pt]=Ke[Dt]=Ke[Ut]=Ke[Ht]=Ke[jt]=Ke[Wt]=Ke[rr]=!0,Ke[Ie]=Ke[It]=Ke[$e]=Ke[$]=Ke[ke]=Ke[T]=Ke[I]=Ke[ee]=Ke[be]=Ke[Ne]=Ke[Se]=Ke[ot]=Ke[Le]=Ke[Ye]=Ke[Ue]=!1;var He={};He[Ie]=He[It]=He[$e]=He[ke]=He[$]=He[T]=He[ht]=He[qe]=He[Pt]=He[Dt]=He[Ut]=He[be]=He[Ne]=He[Se]=He[ot]=He[Le]=He[Ye]=He[Xe]=He[Ht]=He[jt]=He[Wt]=He[rr]=!0,He[I]=He[ee]=He[Ue]=!1;var v={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},z={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Q={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,me=parseInt,et=typeof Vn=="object"&&Vn&&Vn.Object===Object&&Vn,Ct=typeof self=="object"&&self&&self.Object===Object&&self,Re=et||Ct||Function("return this")(),Ge=r&&!r.nodeType&&r,wt=Ge&&!0&&a&&!a.nodeType&&a,ir=wt&&wt.exports===Ge,Nt=ir&&et.process,tt=function(){try{var O=wt&&wt.require&&wt.require("util").types;return O||Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),Qt=tt&&tt.isArrayBuffer,Ar=tt&&tt.isDate,mr=tt&&tt.isMap,Ur=tt&&tt.isRegExp,xn=tt&&tt.isSet,$i=tt&&tt.isTypedArray;function qt(O,j,N){switch(N.length){case 0:return O.call(j);case 1:return O.call(j,N[0]);case 2:return O.call(j,N[0],N[1]);case 3:return O.call(j,N[0],N[1],N[2])}return O.apply(j,N)}function Xf(O,j,N,X){for(var ye=-1,Fe=O==null?0:O.length;++ye<Fe;){var Ft=O[ye];j(X,Ft,N(Ft),O)}return X}function _r(O,j){for(var N=-1,X=O==null?0:O.length;++N<X&&j(O[N],N,O)!==!1;);return O}function Zf(O,j){for(var N=O==null?0:O.length;N--&&j(O[N],N,O)!==!1;);return O}function Jc(O,j){for(var N=-1,X=O==null?0:O.length;++N<X;)if(!j(O[N],N,O))return!1;return!0}function di(O,j){for(var N=-1,X=O==null?0:O.length,ye=0,Fe=[];++N<X;){var Ft=O[N];j(Ft,N,O)&&(Fe[ye++]=Ft)}return Fe}function Is(O,j){var N=O==null?0:O.length;return!!N&&tn(O,j,0)>-1}function Yo(O,j,N){for(var X=-1,ye=O==null?0:O.length;++X<ye;)if(N(j,O[X]))return!0;return!1}function nt(O,j){for(var N=-1,X=O==null?0:O.length,ye=Array(X);++N<X;)ye[N]=j(O[N],N,O);return ye}function gi(O,j){for(var N=-1,X=j.length,ye=O.length;++N<X;)O[ye+N]=j[N];return O}function Xo(O,j,N,X){var ye=-1,Fe=O==null?0:O.length;for(X&&Fe&&(N=O[++ye]);++ye<Fe;)N=j(N,O[ye],ye,O);return N}function ep(O,j,N,X){var ye=O==null?0:O.length;for(X&&ye&&(N=O[--ye]);ye--;)N=j(N,O[ye],ye,O);return N}function Zo(O,j){for(var N=-1,X=O==null?0:O.length;++N<X;)if(j(O[N],N,O))return!0;return!1}var tp=ea("length");function rp(O){return O.split("")}function ip(O){return O.match(Tt)||[]}function Qc(O,j,N){var X;return N(O,function(ye,Fe,Ft){if(j(ye,Fe,Ft))return X=Fe,!1}),X}function xs(O,j,N,X){for(var ye=O.length,Fe=N+(X?1:-1);X?Fe--:++Fe<ye;)if(j(O[Fe],Fe,O))return Fe;return-1}function tn(O,j,N){return j===j?gp(O,j,N):xs(O,Yc,N)}function np(O,j,N,X){for(var ye=N-1,Fe=O.length;++ye<Fe;)if(X(O[ye],j))return ye;return-1}function Yc(O){return O!==O}function Xc(O,j){var N=O==null?0:O.length;return N?ra(O,j)/N:k}function ea(O){return function(j){return j==null?t:j[O]}}function ta(O){return function(j){return O==null?t:O[j]}}function Zc(O,j,N,X,ye){return ye(O,function(Fe,Ft,We){N=X?(X=!1,Fe):j(N,Fe,Ft,We)}),N}function sp(O,j){var N=O.length;for(O.sort(j);N--;)O[N]=O[N].value;return O}function ra(O,j){for(var N,X=-1,ye=O.length;++X<ye;){var Fe=j(O[X]);Fe!==t&&(N=N===t?Fe:N+Fe)}return N}function ia(O,j){for(var N=-1,X=Array(O);++N<O;)X[N]=j(N);return X}function op(O,j){return nt(j,function(N){return[N,O[N]]})}function eu(O){return O&&O.slice(0,nu(O)+1).replace(gt,"")}function fr(O){return function(j){return O(j)}}function na(O,j){return nt(j,function(N){return O[N]})}function Pn(O,j){return O.has(j)}function tu(O,j){for(var N=-1,X=O.length;++N<X&&tn(j,O[N],0)>-1;);return N}function ru(O,j){for(var N=O.length;N--&&tn(j,O[N],0)>-1;);return N}function ap(O,j){for(var N=O.length,X=0;N--;)O[N]===j&&++X;return X}var cp=ta(v),up=ta(S);function hp(O){return"\\"+Q[O]}function lp(O,j){return O==null?t:O[j]}function rn(O){return bs.test(O)}function fp(O){return Ni.test(O)}function pp(O){for(var j,N=[];!(j=O.next()).done;)N.push(j.value);return N}function sa(O){var j=-1,N=Array(O.size);return O.forEach(function(X,ye){N[++j]=[ye,X]}),N}function iu(O,j){return function(N){return O(j(N))}}function yi(O,j){for(var N=-1,X=O.length,ye=0,Fe=[];++N<X;){var Ft=O[N];(Ft===j||Ft===b)&&(O[N]=b,Fe[ye++]=N)}return Fe}function Ps(O){var j=-1,N=Array(O.size);return O.forEach(function(X){N[++j]=X}),N}function dp(O){var j=-1,N=Array(O.size);return O.forEach(function(X){N[++j]=[X,X]}),N}function gp(O,j,N){for(var X=N-1,ye=O.length;++X<ye;)if(O[X]===j)return X;return-1}function yp(O,j,N){for(var X=N+1;X--;)if(O[X]===j)return X;return X}function nn(O){return rn(O)?mp(O):tp(O)}function Tr(O){return rn(O)?_p(O):rp(O)}function nu(O){for(var j=O.length;j--&&_t.test(O.charAt(j)););return j}var vp=ta(z);function mp(O){for(var j=en.lastIndex=0;en.test(O);)++j;return j}function _p(O){return O.match(en)||[]}function wp(O){return O.match(ws)||[]}var bp=function O(j){j=j==null?Re:sn.defaults(Re.Object(),j,sn.pick(Re,Es));var N=j.Array,X=j.Date,ye=j.Error,Fe=j.Function,Ft=j.Math,We=j.Object,oa=j.RegExp,Ep=j.String,wr=j.TypeError,Ss=N.prototype,Ip=Fe.prototype,on=We.prototype,Os=j["__core-js_shared__"],Rs=Ip.toString,Me=on.hasOwnProperty,xp=0,su=function(){var e=/[^.]+$/.exec(Os&&Os.keys&&Os.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),As=on.toString,Pp=Rs.call(We),Sp=Re._,Op=oa("^"+Rs.call(Me).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ts=ir?j.Buffer:t,vi=j.Symbol,Cs=j.Uint8Array,ou=Ts?Ts.allocUnsafe:t,Ns=iu(We.getPrototypeOf,We),au=We.create,cu=on.propertyIsEnumerable,$s=Ss.splice,uu=vi?vi.isConcatSpreadable:t,Sn=vi?vi.iterator:t,Di=vi?vi.toStringTag:t,Ds=function(){try{var e=Mi(We,"defineProperty");return e({},"",{}),e}catch{}}(),Rp=j.clearTimeout!==Re.clearTimeout&&j.clearTimeout,Ap=X&&X.now!==Re.Date.now&&X.now,Tp=j.setTimeout!==Re.setTimeout&&j.setTimeout,Fs=Ft.ceil,Ls=Ft.floor,aa=We.getOwnPropertySymbols,Cp=Ts?Ts.isBuffer:t,hu=j.isFinite,Np=Ss.join,$p=iu(We.keys,We),Lt=Ft.max,Kt=Ft.min,Dp=X.now,Fp=j.parseInt,lu=Ft.random,Lp=Ss.reverse,ca=Mi(j,"DataView"),On=Mi(j,"Map"),ua=Mi(j,"Promise"),an=Mi(j,"Set"),Rn=Mi(j,"WeakMap"),An=Mi(We,"create"),js=Rn&&new Rn,cn={},jp=zi(ca),qp=zi(On),Mp=zi(ua),zp=zi(an),Up=zi(Rn),qs=vi?vi.prototype:t,Tn=qs?qs.valueOf:t,fu=qs?qs.toString:t;function d(e){if(vt(e)&&!_e(e)&&!(e instanceof Oe)){if(e instanceof br)return e;if(Me.call(e,"__wrapped__"))return ph(e)}return new br(e)}var un=function(){function e(){}return function(i){if(!ut(i))return{};if(au)return au(i);e.prototype=i;var s=new e;return e.prototype=t,s}}();function Ms(){}function br(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=t}d.templateSettings={escape:ft,evaluate:pt,interpolate:ct,variable:"",imports:{_:d}},d.prototype=Ms.prototype,d.prototype.constructor=d,br.prototype=un(Ms.prototype),br.prototype.constructor=br;function Oe(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=G,this.__views__=[]}function Hp(){var e=new Oe(this.__wrapped__);return e.__actions__=nr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=nr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=nr(this.__views__),e}function Bp(){if(this.__filtered__){var e=new Oe(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function kp(){var e=this.__wrapped__.value(),i=this.__dir__,s=_e(e),u=i<0,l=s?e.length:0,y=rg(0,l,this.__views__),w=y.start,E=y.end,R=E-w,q=u?E:w-1,M=this.__iteratees__,B=M.length,J=0,te=Kt(R,this.__takeCount__);if(!s||!u&&l==R&&te==R)return Lu(e,this.__actions__);var oe=[];e:for(;R--&&J<te;){q+=i;for(var Ee=-1,ae=e[q];++Ee<B;){var Pe=M[Ee],Ae=Pe.iteratee,gr=Pe.type,Zt=Ae(ae);if(gr==P)ae=Zt;else if(!Zt){if(gr==m)continue e;break e}}oe[J++]=ae}return oe}Oe.prototype=un(Ms.prototype),Oe.prototype.constructor=Oe;function Fi(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function Kp(){this.__data__=An?An(null):{},this.size=0}function Vp(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function Gp(e){var i=this.__data__;if(An){var s=i[e];return s===_?t:s}return Me.call(i,e)?i[e]:t}function Wp(e){var i=this.__data__;return An?i[e]!==t:Me.call(i,e)}function Jp(e,i){var s=this.__data__;return this.size+=this.has(e)?0:1,s[e]=An&&i===t?_:i,this}Fi.prototype.clear=Kp,Fi.prototype.delete=Vp,Fi.prototype.get=Gp,Fi.prototype.has=Wp,Fi.prototype.set=Jp;function Jr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function Qp(){this.__data__=[],this.size=0}function Yp(e){var i=this.__data__,s=zs(i,e);if(s<0)return!1;var u=i.length-1;return s==u?i.pop():$s.call(i,s,1),--this.size,!0}function Xp(e){var i=this.__data__,s=zs(i,e);return s<0?t:i[s][1]}function Zp(e){return zs(this.__data__,e)>-1}function ed(e,i){var s=this.__data__,u=zs(s,e);return u<0?(++this.size,s.push([e,i])):s[u][1]=i,this}Jr.prototype.clear=Qp,Jr.prototype.delete=Yp,Jr.prototype.get=Xp,Jr.prototype.has=Zp,Jr.prototype.set=ed;function Qr(e){var i=-1,s=e==null?0:e.length;for(this.clear();++i<s;){var u=e[i];this.set(u[0],u[1])}}function td(){this.size=0,this.__data__={hash:new Fi,map:new(On||Jr),string:new Fi}}function rd(e){var i=Xs(this,e).delete(e);return this.size-=i?1:0,i}function id(e){return Xs(this,e).get(e)}function nd(e){return Xs(this,e).has(e)}function sd(e,i){var s=Xs(this,e),u=s.size;return s.set(e,i),this.size+=s.size==u?0:1,this}Qr.prototype.clear=td,Qr.prototype.delete=rd,Qr.prototype.get=id,Qr.prototype.has=nd,Qr.prototype.set=sd;function Li(e){var i=-1,s=e==null?0:e.length;for(this.__data__=new Qr;++i<s;)this.add(e[i])}function od(e){return this.__data__.set(e,_),this}function ad(e){return this.__data__.has(e)}Li.prototype.add=Li.prototype.push=od,Li.prototype.has=ad;function Cr(e){var i=this.__data__=new Jr(e);this.size=i.size}function cd(){this.__data__=new Jr,this.size=0}function ud(e){var i=this.__data__,s=i.delete(e);return this.size=i.size,s}function hd(e){return this.__data__.get(e)}function ld(e){return this.__data__.has(e)}function fd(e,i){var s=this.__data__;if(s instanceof Jr){var u=s.__data__;if(!On||u.length<o-1)return u.push([e,i]),this.size=++s.size,this;s=this.__data__=new Qr(u)}return s.set(e,i),this.size=s.size,this}Cr.prototype.clear=cd,Cr.prototype.delete=ud,Cr.prototype.get=hd,Cr.prototype.has=ld,Cr.prototype.set=fd;function pu(e,i){var s=_e(e),u=!s&&Ui(e),l=!s&&!u&&Ei(e),y=!s&&!u&&!l&&pn(e),w=s||u||l||y,E=w?ia(e.length,Ep):[],R=E.length;for(var q in e)(i||Me.call(e,q))&&!(w&&(q=="length"||l&&(q=="offset"||q=="parent")||y&&(q=="buffer"||q=="byteLength"||q=="byteOffset")||ei(q,R)))&&E.push(q);return E}function du(e){var i=e.length;return i?e[wa(0,i-1)]:t}function pd(e,i){return Zs(nr(e),ji(i,0,e.length))}function dd(e){return Zs(nr(e))}function ha(e,i,s){(s!==t&&!Nr(e[i],s)||s===t&&!(i in e))&&Yr(e,i,s)}function Cn(e,i,s){var u=e[i];(!(Me.call(e,i)&&Nr(u,s))||s===t&&!(i in e))&&Yr(e,i,s)}function zs(e,i){for(var s=e.length;s--;)if(Nr(e[s][0],i))return s;return-1}function gd(e,i,s,u){return mi(e,function(l,y,w){i(u,l,s(l),w)}),u}function gu(e,i){return e&&Br(i,Mt(i),e)}function yd(e,i){return e&&Br(i,or(i),e)}function Yr(e,i,s){i=="__proto__"&&Ds?Ds(e,i,{configurable:!0,enumerable:!0,value:s,writable:!0}):e[i]=s}function la(e,i){for(var s=-1,u=i.length,l=N(u),y=e==null;++s<u;)l[s]=y?t:Ka(e,i[s]);return l}function ji(e,i,s){return e===e&&(s!==t&&(e=e<=s?e:s),i!==t&&(e=e>=i?e:i)),e}function Er(e,i,s,u,l,y){var w,E=i&A,R=i&x,q=i&D;if(s&&(w=l?s(e,u,l,y):s(e)),w!==t)return w;if(!ut(e))return e;var M=_e(e);if(M){if(w=ng(e),!E)return nr(e,w)}else{var B=Vt(e),J=B==ee||B==ge;if(Ei(e))return Mu(e,E);if(B==Se||B==Ie||J&&!l){if(w=R||J?{}:nh(e),!E)return R?Gd(e,yd(w,e)):Vd(e,gu(w,e))}else{if(!He[B])return l?e:{};w=sg(e,B,E)}}y||(y=new Cr);var te=y.get(e);if(te)return te;y.set(e,w),$h(e)?e.forEach(function(ae){w.add(Er(ae,i,s,ae,e,y))}):Ch(e)&&e.forEach(function(ae,Pe){w.set(Pe,Er(ae,i,s,Pe,e,y))});var oe=q?R?Ca:Ta:R?or:Mt,Ee=M?t:oe(e);return _r(Ee||e,function(ae,Pe){Ee&&(Pe=ae,ae=e[Pe]),Cn(w,Pe,Er(ae,i,s,Pe,e,y))}),w}function vd(e){var i=Mt(e);return function(s){return yu(s,e,i)}}function yu(e,i,s){var u=s.length;if(e==null)return!u;for(e=We(e);u--;){var l=s[u],y=i[l],w=e[l];if(w===t&&!(l in e)||!y(w))return!1}return!0}function vu(e,i,s){if(typeof e!="function")throw new wr(f);return qn(function(){e.apply(t,s)},i)}function Nn(e,i,s,u){var l=-1,y=Is,w=!0,E=e.length,R=[],q=i.length;if(!E)return R;s&&(i=nt(i,fr(s))),u?(y=Yo,w=!1):i.length>=o&&(y=Pn,w=!1,i=new Li(i));e:for(;++l<E;){var M=e[l],B=s==null?M:s(M);if(M=u||M!==0?M:0,w&&B===B){for(var J=q;J--;)if(i[J]===B)continue e;R.push(M)}else y(i,B,u)||R.push(M)}return R}var mi=ku(Hr),mu=ku(pa,!0);function md(e,i){var s=!0;return mi(e,function(u,l,y){return s=!!i(u,l,y),s}),s}function Us(e,i,s){for(var u=-1,l=e.length;++u<l;){var y=e[u],w=i(y);if(w!=null&&(E===t?w===w&&!dr(w):s(w,E)))var E=w,R=y}return R}function _d(e,i,s,u){var l=e.length;for(s=we(s),s<0&&(s=-s>l?0:l+s),u=u===t||u>l?l:we(u),u<0&&(u+=l),u=s>u?0:Fh(u);s<u;)e[s++]=i;return e}function _u(e,i){var s=[];return mi(e,function(u,l,y){i(u,l,y)&&s.push(u)}),s}function Bt(e,i,s,u,l){var y=-1,w=e.length;for(s||(s=ag),l||(l=[]);++y<w;){var E=e[y];i>0&&s(E)?i>1?Bt(E,i-1,s,u,l):gi(l,E):u||(l[l.length]=E)}return l}var fa=Ku(),wu=Ku(!0);function Hr(e,i){return e&&fa(e,i,Mt)}function pa(e,i){return e&&wu(e,i,Mt)}function Hs(e,i){return di(i,function(s){return ti(e[s])})}function qi(e,i){i=wi(i,e);for(var s=0,u=i.length;e!=null&&s<u;)e=e[kr(i[s++])];return s&&s==u?e:t}function bu(e,i,s){var u=i(e);return _e(e)?u:gi(u,s(e))}function Yt(e){return e==null?e===t?at:De:Di&&Di in We(e)?tg(e):dg(e)}function da(e,i){return e>i}function wd(e,i){return e!=null&&Me.call(e,i)}function bd(e,i){return e!=null&&i in We(e)}function Ed(e,i,s){return e>=Kt(i,s)&&e<Lt(i,s)}function ga(e,i,s){for(var u=s?Yo:Is,l=e[0].length,y=e.length,w=y,E=N(y),R=1/0,q=[];w--;){var M=e[w];w&&i&&(M=nt(M,fr(i))),R=Kt(M.length,R),E[w]=!s&&(i||l>=120&&M.length>=120)?new Li(w&&M):t}M=e[0];var B=-1,J=E[0];e:for(;++B<l&&q.length<R;){var te=M[B],oe=i?i(te):te;if(te=s||te!==0?te:0,!(J?Pn(J,oe):u(q,oe,s))){for(w=y;--w;){var Ee=E[w];if(!(Ee?Pn(Ee,oe):u(e[w],oe,s)))continue e}J&&J.push(oe),q.push(te)}}return q}function Id(e,i,s,u){return Hr(e,function(l,y,w){i(u,s(l),y,w)}),u}function $n(e,i,s){i=wi(i,e),e=ch(e,i);var u=e==null?e:e[kr(xr(i))];return u==null?t:qt(u,e,s)}function Eu(e){return vt(e)&&Yt(e)==Ie}function xd(e){return vt(e)&&Yt(e)==$e}function Pd(e){return vt(e)&&Yt(e)==T}function Dn(e,i,s,u,l){return e===i?!0:e==null||i==null||!vt(e)&&!vt(i)?e!==e&&i!==i:Sd(e,i,s,u,Dn,l)}function Sd(e,i,s,u,l,y){var w=_e(e),E=_e(i),R=w?It:Vt(e),q=E?It:Vt(i);R=R==Ie?Se:R,q=q==Ie?Se:q;var M=R==Se,B=q==Se,J=R==q;if(J&&Ei(e)){if(!Ei(i))return!1;w=!0,M=!1}if(J&&!M)return y||(y=new Cr),w||pn(e)?th(e,i,s,u,l,y):Zd(e,i,R,s,u,l,y);if(!(s&C)){var te=M&&Me.call(e,"__wrapped__"),oe=B&&Me.call(i,"__wrapped__");if(te||oe){var Ee=te?e.value():e,ae=oe?i.value():i;return y||(y=new Cr),l(Ee,ae,s,u,y)}}return J?(y||(y=new Cr),eg(e,i,s,u,l,y)):!1}function Od(e){return vt(e)&&Vt(e)==be}function ya(e,i,s,u){var l=s.length,y=l,w=!u;if(e==null)return!y;for(e=We(e);l--;){var E=s[l];if(w&&E[2]?E[1]!==e[E[0]]:!(E[0]in e))return!1}for(;++l<y;){E=s[l];var R=E[0],q=e[R],M=E[1];if(w&&E[2]){if(q===t&&!(R in e))return!1}else{var B=new Cr;if(u)var J=u(q,M,R,e,i,B);if(!(J===t?Dn(M,q,C|K,u,B):J))return!1}}return!0}function Iu(e){if(!ut(e)||ug(e))return!1;var i=ti(e)?Op:Fo;return i.test(zi(e))}function Rd(e){return vt(e)&&Yt(e)==ot}function Ad(e){return vt(e)&&Vt(e)==Le}function Td(e){return vt(e)&&so(e.length)&&!!Ke[Yt(e)]}function xu(e){return typeof e=="function"?e:e==null?ar:typeof e=="object"?_e(e)?Ou(e[0],e[1]):Su(e):Vh(e)}function va(e){if(!jn(e))return $p(e);var i=[];for(var s in We(e))Me.call(e,s)&&s!="constructor"&&i.push(s);return i}function Cd(e){if(!ut(e))return pg(e);var i=jn(e),s=[];for(var u in e)u=="constructor"&&(i||!Me.call(e,u))||s.push(u);return s}function ma(e,i){return e<i}function Pu(e,i){var s=-1,u=sr(e)?N(e.length):[];return mi(e,function(l,y,w){u[++s]=i(l,y,w)}),u}function Su(e){var i=$a(e);return i.length==1&&i[0][2]?oh(i[0][0],i[0][1]):function(s){return s===e||ya(s,e,i)}}function Ou(e,i){return Fa(e)&&sh(i)?oh(kr(e),i):function(s){var u=Ka(s,e);return u===t&&u===i?Va(s,e):Dn(i,u,C|K)}}function Bs(e,i,s,u,l){e!==i&&fa(i,function(y,w){if(l||(l=new Cr),ut(y))Nd(e,i,w,s,Bs,u,l);else{var E=u?u(ja(e,w),y,w+"",e,i,l):t;E===t&&(E=y),ha(e,w,E)}},or)}function Nd(e,i,s,u,l,y,w){var E=ja(e,s),R=ja(i,s),q=w.get(R);if(q){ha(e,s,q);return}var M=y?y(E,R,s+"",e,i,w):t,B=M===t;if(B){var J=_e(R),te=!J&&Ei(R),oe=!J&&!te&&pn(R);M=R,J||te||oe?_e(E)?M=E:bt(E)?M=nr(E):te?(B=!1,M=Mu(R,!0)):oe?(B=!1,M=zu(R,!0)):M=[]:Mn(R)||Ui(R)?(M=E,Ui(E)?M=Lh(E):(!ut(E)||ti(E))&&(M=nh(R))):B=!1}B&&(w.set(R,M),l(M,R,u,y,w),w.delete(R)),ha(e,s,M)}function Ru(e,i){var s=e.length;if(s)return i+=i<0?s:0,ei(i,s)?e[i]:t}function Au(e,i,s){i.length?i=nt(i,function(y){return _e(y)?function(w){return qi(w,y.length===1?y[0]:y)}:y}):i=[ar];var u=-1;i=nt(i,fr(se()));var l=Pu(e,function(y,w,E){var R=nt(i,function(q){return q(y)});return{criteria:R,index:++u,value:y}});return sp(l,function(y,w){return Kd(y,w,s)})}function $d(e,i){return Tu(e,i,function(s,u){return Va(e,u)})}function Tu(e,i,s){for(var u=-1,l=i.length,y={};++u<l;){var w=i[u],E=qi(e,w);s(E,w)&&Fn(y,wi(w,e),E)}return y}function Dd(e){return function(i){return qi(i,e)}}function _a(e,i,s,u){var l=u?np:tn,y=-1,w=i.length,E=e;for(e===i&&(i=nr(i)),s&&(E=nt(e,fr(s)));++y<w;)for(var R=0,q=i[y],M=s?s(q):q;(R=l(E,M,R,u))>-1;)E!==e&&$s.call(E,R,1),$s.call(e,R,1);return e}function Cu(e,i){for(var s=e?i.length:0,u=s-1;s--;){var l=i[s];if(s==u||l!==y){var y=l;ei(l)?$s.call(e,l,1):Ia(e,l)}}return e}function wa(e,i){return e+Ls(lu()*(i-e+1))}function Fd(e,i,s,u){for(var l=-1,y=Lt(Fs((i-e)/(s||1)),0),w=N(y);y--;)w[u?y:++l]=e,e+=s;return w}function ba(e,i){var s="";if(!e||i<1||i>V)return s;do i%2&&(s+=e),i=Ls(i/2),i&&(e+=e);while(i);return s}function xe(e,i){return qa(ah(e,i,ar),e+"")}function Ld(e){return du(dn(e))}function jd(e,i){var s=dn(e);return Zs(s,ji(i,0,s.length))}function Fn(e,i,s,u){if(!ut(e))return e;i=wi(i,e);for(var l=-1,y=i.length,w=y-1,E=e;E!=null&&++l<y;){var R=kr(i[l]),q=s;if(R==="__proto__"||R==="constructor"||R==="prototype")return e;if(l!=w){var M=E[R];q=u?u(M,R,E):t,q===t&&(q=ut(M)?M:ei(i[l+1])?[]:{})}Cn(E,R,q),E=E[R]}return e}var Nu=js?function(e,i){return js.set(e,i),e}:ar,qd=Ds?function(e,i){return Ds(e,"toString",{configurable:!0,enumerable:!1,value:Wa(i),writable:!0})}:ar;function Md(e){return Zs(dn(e))}function Ir(e,i,s){var u=-1,l=e.length;i<0&&(i=-i>l?0:l+i),s=s>l?l:s,s<0&&(s+=l),l=i>s?0:s-i>>>0,i>>>=0;for(var y=N(l);++u<l;)y[u]=e[u+i];return y}function zd(e,i){var s;return mi(e,function(u,l,y){return s=i(u,l,y),!s}),!!s}function ks(e,i,s){var u=0,l=e==null?u:e.length;if(typeof i=="number"&&i===i&&l<=Be){for(;u<l;){var y=u+l>>>1,w=e[y];w!==null&&!dr(w)&&(s?w<=i:w<i)?u=y+1:l=y}return l}return Ea(e,i,ar,s)}function Ea(e,i,s,u){var l=0,y=e==null?0:e.length;if(y===0)return 0;i=s(i);for(var w=i!==i,E=i===null,R=dr(i),q=i===t;l<y;){var M=Ls((l+y)/2),B=s(e[M]),J=B!==t,te=B===null,oe=B===B,Ee=dr(B);if(w)var ae=u||oe;else q?ae=oe&&(u||J):E?ae=oe&&J&&(u||!te):R?ae=oe&&J&&!te&&(u||!Ee):te||Ee?ae=!1:ae=u?B<=i:B<i;ae?l=M+1:y=M}return Kt(y,Je)}function $u(e,i){for(var s=-1,u=e.length,l=0,y=[];++s<u;){var w=e[s],E=i?i(w):w;if(!s||!Nr(E,R)){var R=E;y[l++]=w===0?0:w}}return y}function Du(e){return typeof e=="number"?e:dr(e)?k:+e}function pr(e){if(typeof e=="string")return e;if(_e(e))return nt(e,pr)+"";if(dr(e))return fu?fu.call(e):"";var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function _i(e,i,s){var u=-1,l=Is,y=e.length,w=!0,E=[],R=E;if(s)w=!1,l=Yo;else if(y>=o){var q=i?null:Yd(e);if(q)return Ps(q);w=!1,l=Pn,R=new Li}else R=i?[]:E;e:for(;++u<y;){var M=e[u],B=i?i(M):M;if(M=s||M!==0?M:0,w&&B===B){for(var J=R.length;J--;)if(R[J]===B)continue e;i&&R.push(B),E.push(M)}else l(R,B,s)||(R!==E&&R.push(B),E.push(M))}return E}function Ia(e,i){return i=wi(i,e),e=ch(e,i),e==null||delete e[kr(xr(i))]}function Fu(e,i,s,u){return Fn(e,i,s(qi(e,i)),u)}function Ks(e,i,s,u){for(var l=e.length,y=u?l:-1;(u?y--:++y<l)&&i(e[y],y,e););return s?Ir(e,u?0:y,u?y+1:l):Ir(e,u?y+1:0,u?l:y)}function Lu(e,i){var s=e;return s instanceof Oe&&(s=s.value()),Xo(i,function(u,l){return l.func.apply(l.thisArg,gi([u],l.args))},s)}function xa(e,i,s){var u=e.length;if(u<2)return u?_i(e[0]):[];for(var l=-1,y=N(u);++l<u;)for(var w=e[l],E=-1;++E<u;)E!=l&&(y[l]=Nn(y[l]||w,e[E],i,s));return _i(Bt(y,1),i,s)}function ju(e,i,s){for(var u=-1,l=e.length,y=i.length,w={};++u<l;){var E=u<y?i[u]:t;s(w,e[u],E)}return w}function Pa(e){return bt(e)?e:[]}function Sa(e){return typeof e=="function"?e:ar}function wi(e,i){return _e(e)?e:Fa(e,i)?[e]:fh(je(e))}var Ud=xe;function bi(e,i,s){var u=e.length;return s=s===t?u:s,!i&&s>=u?e:Ir(e,i,s)}var qu=Rp||function(e){return Re.clearTimeout(e)};function Mu(e,i){if(i)return e.slice();var s=e.length,u=ou?ou(s):new e.constructor(s);return e.copy(u),u}function Oa(e){var i=new e.constructor(e.byteLength);return new Cs(i).set(new Cs(e)),i}function Hd(e,i){var s=i?Oa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.byteLength)}function Bd(e){var i=new e.constructor(e.source,vr.exec(e));return i.lastIndex=e.lastIndex,i}function kd(e){return Tn?We(Tn.call(e)):{}}function zu(e,i){var s=i?Oa(e.buffer):e.buffer;return new e.constructor(s,e.byteOffset,e.length)}function Uu(e,i){if(e!==i){var s=e!==t,u=e===null,l=e===e,y=dr(e),w=i!==t,E=i===null,R=i===i,q=dr(i);if(!E&&!q&&!y&&e>i||y&&w&&R&&!E&&!q||u&&w&&R||!s&&R||!l)return 1;if(!u&&!y&&!q&&e<i||q&&s&&l&&!u&&!y||E&&s&&l||!w&&l||!R)return-1}return 0}function Kd(e,i,s){for(var u=-1,l=e.criteria,y=i.criteria,w=l.length,E=s.length;++u<w;){var R=Uu(l[u],y[u]);if(R){if(u>=E)return R;var q=s[u];return R*(q=="desc"?-1:1)}}return e.index-i.index}function Hu(e,i,s,u){for(var l=-1,y=e.length,w=s.length,E=-1,R=i.length,q=Lt(y-w,0),M=N(R+q),B=!u;++E<R;)M[E]=i[E];for(;++l<w;)(B||l<y)&&(M[s[l]]=e[l]);for(;q--;)M[E++]=e[l++];return M}function Bu(e,i,s,u){for(var l=-1,y=e.length,w=-1,E=s.length,R=-1,q=i.length,M=Lt(y-E,0),B=N(M+q),J=!u;++l<M;)B[l]=e[l];for(var te=l;++R<q;)B[te+R]=i[R];for(;++w<E;)(J||l<y)&&(B[te+s[w]]=e[l++]);return B}function nr(e,i){var s=-1,u=e.length;for(i||(i=N(u));++s<u;)i[s]=e[s];return i}function Br(e,i,s,u){var l=!s;s||(s={});for(var y=-1,w=i.length;++y<w;){var E=i[y],R=u?u(s[E],e[E],E,s,e):t;R===t&&(R=e[E]),l?Yr(s,E,R):Cn(s,E,R)}return s}function Vd(e,i){return Br(e,Da(e),i)}function Gd(e,i){return Br(e,rh(e),i)}function Vs(e,i){return function(s,u){var l=_e(s)?Xf:gd,y=i?i():{};return l(s,e,se(u,2),y)}}function hn(e){return xe(function(i,s){var u=-1,l=s.length,y=l>1?s[l-1]:t,w=l>2?s[2]:t;for(y=e.length>3&&typeof y=="function"?(l--,y):t,w&&Xt(s[0],s[1],w)&&(y=l<3?t:y,l=1),i=We(i);++u<l;){var E=s[u];E&&e(i,E,u,y)}return i})}function ku(e,i){return function(s,u){if(s==null)return s;if(!sr(s))return e(s,u);for(var l=s.length,y=i?l:-1,w=We(s);(i?y--:++y<l)&&u(w[y],y,w)!==!1;);return s}}function Ku(e){return function(i,s,u){for(var l=-1,y=We(i),w=u(i),E=w.length;E--;){var R=w[e?E:++l];if(s(y[R],R,y)===!1)break}return i}}function Wd(e,i,s){var u=i&re,l=Ln(e);function y(){var w=this&&this!==Re&&this instanceof y?l:e;return w.apply(u?s:this,arguments)}return y}function Vu(e){return function(i){i=je(i);var s=rn(i)?Tr(i):t,u=s?s[0]:i.charAt(0),l=s?bi(s,1).join(""):i.slice(1);return u[e]()+l}}function ln(e){return function(i){return Xo(kh(Bh(i).replace(In,"")),e,"")}}function Ln(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var s=un(e.prototype),u=e.apply(s,i);return ut(u)?u:s}}function Jd(e,i,s){var u=Ln(e);function l(){for(var y=arguments.length,w=N(y),E=y,R=fn(l);E--;)w[E]=arguments[E];var q=y<3&&w[0]!==R&&w[y-1]!==R?[]:yi(w,R);if(y-=q.length,y<s)return Yu(e,i,Gs,l.placeholder,t,w,q,t,t,s-y);var M=this&&this!==Re&&this instanceof l?u:e;return qt(M,this,w)}return l}function Gu(e){return function(i,s,u){var l=We(i);if(!sr(i)){var y=se(s,3);i=Mt(i),s=function(E){return y(l[E],E,l)}}var w=e(i,s,u);return w>-1?l[y?i[w]:w]:t}}function Wu(e){return Zr(function(i){var s=i.length,u=s,l=br.prototype.thru;for(e&&i.reverse();u--;){var y=i[u];if(typeof y!="function")throw new wr(f);if(l&&!w&&Ys(y)=="wrapper")var w=new br([],!0)}for(u=w?u:s;++u<s;){y=i[u];var E=Ys(y),R=E=="wrapper"?Na(y):t;R&&La(R[0])&&R[1]==(U|fe|de|W)&&!R[4].length&&R[9]==1?w=w[Ys(R[0])].apply(w,R[3]):w=y.length==1&&La(y)?w[E]():w.thru(y)}return function(){var q=arguments,M=q[0];if(w&&q.length==1&&_e(M))return w.plant(M).value();for(var B=0,J=s?i[B].apply(this,q):M;++B<s;)J=i[B].call(this,J);return J}})}function Gs(e,i,s,u,l,y,w,E,R,q){var M=i&U,B=i&re,J=i&he,te=i&(fe|pe),oe=i&ve,Ee=J?t:Ln(e);function ae(){for(var Pe=arguments.length,Ae=N(Pe),gr=Pe;gr--;)Ae[gr]=arguments[gr];if(te)var Zt=fn(ae),yr=ap(Ae,Zt);if(u&&(Ae=Hu(Ae,u,l,te)),y&&(Ae=Bu(Ae,y,w,te)),Pe-=yr,te&&Pe<q){var Et=yi(Ae,Zt);return Yu(e,i,Gs,ae.placeholder,s,Ae,Et,E,R,q-Pe)}var $r=B?s:this,ii=J?$r[e]:e;return Pe=Ae.length,E?Ae=gg(Ae,E):oe&&Pe>1&&Ae.reverse(),M&&R<Pe&&(Ae.length=R),this&&this!==Re&&this instanceof ae&&(ii=Ee||Ln(ii)),ii.apply($r,Ae)}return ae}function Ju(e,i){return function(s,u){return Id(s,e,i(u),{})}}function Ws(e,i){return function(s,u){var l;if(s===t&&u===t)return i;if(s!==t&&(l=s),u!==t){if(l===t)return u;typeof s=="string"||typeof u=="string"?(s=pr(s),u=pr(u)):(s=Du(s),u=Du(u)),l=e(s,u)}return l}}function Ra(e){return Zr(function(i){return i=nt(i,fr(se())),xe(function(s){var u=this;return e(i,function(l){return qt(l,u,s)})})})}function Js(e,i){i=i===t?" ":pr(i);var s=i.length;if(s<2)return s?ba(i,e):i;var u=ba(i,Fs(e/nn(i)));return rn(i)?bi(Tr(u),0,e).join(""):u.slice(0,e)}function Qd(e,i,s,u){var l=i&re,y=Ln(e);function w(){for(var E=-1,R=arguments.length,q=-1,M=u.length,B=N(M+R),J=this&&this!==Re&&this instanceof w?y:e;++q<M;)B[q]=u[q];for(;R--;)B[q++]=arguments[++E];return qt(J,l?s:this,B)}return w}function Qu(e){return function(i,s,u){return u&&typeof u!="number"&&Xt(i,s,u)&&(s=u=t),i=ri(i),s===t?(s=i,i=0):s=ri(s),u=u===t?i<s?1:-1:ri(u),Fd(i,s,u,e)}}function Qs(e){return function(i,s){return typeof i=="string"&&typeof s=="string"||(i=Pr(i),s=Pr(s)),e(i,s)}}function Yu(e,i,s,u,l,y,w,E,R,q){var M=i&fe,B=M?w:t,J=M?t:w,te=M?y:t,oe=M?t:y;i|=M?de:L,i&=~(M?L:de),i&le||(i&=~(re|he));var Ee=[e,i,l,te,B,oe,J,E,R,q],ae=s.apply(t,Ee);return La(e)&&uh(ae,Ee),ae.placeholder=u,hh(ae,e,i)}function Aa(e){var i=Ft[e];return function(s,u){if(s=Pr(s),u=u==null?0:Kt(we(u),292),u&&hu(s)){var l=(je(s)+"e").split("e"),y=i(l[0]+"e"+(+l[1]+u));return l=(je(y)+"e").split("e"),+(l[0]+"e"+(+l[1]-u))}return i(s)}}var Yd=an&&1/Ps(new an([,-0]))[1]==ce?function(e){return new an(e)}:Ya;function Xu(e){return function(i){var s=Vt(i);return s==be?sa(i):s==Le?dp(i):op(i,e(i))}}function Xr(e,i,s,u,l,y,w,E){var R=i&he;if(!R&&typeof e!="function")throw new wr(f);var q=u?u.length:0;if(q||(i&=~(de|L),u=l=t),w=w===t?w:Lt(we(w),0),E=E===t?E:we(E),q-=l?l.length:0,i&L){var M=u,B=l;u=l=t}var J=R?t:Na(e),te=[e,i,s,u,l,M,B,y,w,E];if(J&&fg(te,J),e=te[0],i=te[1],s=te[2],u=te[3],l=te[4],E=te[9]=te[9]===t?R?0:e.length:Lt(te[9]-q,0),!E&&i&(fe|pe)&&(i&=~(fe|pe)),!i||i==re)var oe=Wd(e,i,s);else i==fe||i==pe?oe=Jd(e,i,E):(i==de||i==(re|de))&&!l.length?oe=Qd(e,i,s,u):oe=Gs.apply(t,te);var Ee=J?Nu:uh;return hh(Ee(oe,te),e,i)}function Zu(e,i,s,u){return e===t||Nr(e,on[s])&&!Me.call(u,s)?i:e}function eh(e,i,s,u,l,y){return ut(e)&&ut(i)&&(y.set(i,e),Bs(e,i,t,eh,y),y.delete(i)),e}function Xd(e){return Mn(e)?t:e}function th(e,i,s,u,l,y){var w=s&C,E=e.length,R=i.length;if(E!=R&&!(w&&R>E))return!1;var q=y.get(e),M=y.get(i);if(q&&M)return q==i&&M==e;var B=-1,J=!0,te=s&K?new Li:t;for(y.set(e,i),y.set(i,e);++B<E;){var oe=e[B],Ee=i[B];if(u)var ae=w?u(Ee,oe,B,i,e,y):u(oe,Ee,B,e,i,y);if(ae!==t){if(ae)continue;J=!1;break}if(te){if(!Zo(i,function(Pe,Ae){if(!Pn(te,Ae)&&(oe===Pe||l(oe,Pe,s,u,y)))return te.push(Ae)})){J=!1;break}}else if(!(oe===Ee||l(oe,Ee,s,u,y))){J=!1;break}}return y.delete(e),y.delete(i),J}function Zd(e,i,s,u,l,y,w){switch(s){case ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case $e:return!(e.byteLength!=i.byteLength||!y(new Cs(e),new Cs(i)));case $:case T:case Ne:return Nr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case ot:case Ye:return e==i+"";case be:var E=sa;case Le:var R=u&C;if(E||(E=Ps),e.size!=i.size&&!R)return!1;var q=w.get(e);if(q)return q==i;u|=K,w.set(e,i);var M=th(E(e),E(i),u,l,y,w);return w.delete(e),M;case Xe:if(Tn)return Tn.call(e)==Tn.call(i)}return!1}function eg(e,i,s,u,l,y){var w=s&C,E=Ta(e),R=E.length,q=Ta(i),M=q.length;if(R!=M&&!w)return!1;for(var B=R;B--;){var J=E[B];if(!(w?J in i:Me.call(i,J)))return!1}var te=y.get(e),oe=y.get(i);if(te&&oe)return te==i&&oe==e;var Ee=!0;y.set(e,i),y.set(i,e);for(var ae=w;++B<R;){J=E[B];var Pe=e[J],Ae=i[J];if(u)var gr=w?u(Ae,Pe,J,i,e,y):u(Pe,Ae,J,e,i,y);if(!(gr===t?Pe===Ae||l(Pe,Ae,s,u,y):gr)){Ee=!1;break}ae||(ae=J=="constructor")}if(Ee&&!ae){var Zt=e.constructor,yr=i.constructor;Zt!=yr&&"constructor"in e&&"constructor"in i&&!(typeof Zt=="function"&&Zt instanceof Zt&&typeof yr=="function"&&yr instanceof yr)&&(Ee=!1)}return y.delete(e),y.delete(i),Ee}function Zr(e){return qa(ah(e,t,yh),e+"")}function Ta(e){return bu(e,Mt,Da)}function Ca(e){return bu(e,or,rh)}var Na=js?function(e){return js.get(e)}:Ya;function Ys(e){for(var i=e.name+"",s=cn[i],u=Me.call(cn,i)?s.length:0;u--;){var l=s[u],y=l.func;if(y==null||y==e)return l.name}return i}function fn(e){var i=Me.call(d,"placeholder")?d:e;return i.placeholder}function se(){var e=d.iteratee||Ja;return e=e===Ja?xu:e,arguments.length?e(arguments[0],arguments[1]):e}function Xs(e,i){var s=e.__data__;return cg(i)?s[typeof i=="string"?"string":"hash"]:s.map}function $a(e){for(var i=Mt(e),s=i.length;s--;){var u=i[s],l=e[u];i[s]=[u,l,sh(l)]}return i}function Mi(e,i){var s=lp(e,i);return Iu(s)?s:t}function tg(e){var i=Me.call(e,Di),s=e[Di];try{e[Di]=t;var u=!0}catch{}var l=As.call(e);return u&&(i?e[Di]=s:delete e[Di]),l}var Da=aa?function(e){return e==null?[]:(e=We(e),di(aa(e),function(i){return cu.call(e,i)}))}:Xa,rh=aa?function(e){for(var i=[];e;)gi(i,Da(e)),e=Ns(e);return i}:Xa,Vt=Yt;(ca&&Vt(new ca(new ArrayBuffer(1)))!=ke||On&&Vt(new On)!=be||ua&&Vt(ua.resolve())!=xt||an&&Vt(new an)!=Le||Rn&&Vt(new Rn)!=Ue)&&(Vt=function(e){var i=Yt(e),s=i==Se?e.constructor:t,u=s?zi(s):"";if(u)switch(u){case jp:return ke;case qp:return be;case Mp:return xt;case zp:return Le;case Up:return Ue}return i});function rg(e,i,s){for(var u=-1,l=s.length;++u<l;){var y=s[u],w=y.size;switch(y.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=Kt(i,e+w);break;case"takeRight":e=Lt(e,i-w);break}}return{start:e,end:i}}function ig(e){var i=e.match(Qe);return i?i[1].split(At):[]}function ih(e,i,s){i=wi(i,e);for(var u=-1,l=i.length,y=!1;++u<l;){var w=kr(i[u]);if(!(y=e!=null&&s(e,w)))break;e=e[w]}return y||++u!=l?y:(l=e==null?0:e.length,!!l&&so(l)&&ei(w,l)&&(_e(e)||Ui(e)))}function ng(e){var i=e.length,s=new e.constructor(i);return i&&typeof e[0]=="string"&&Me.call(e,"index")&&(s.index=e.index,s.input=e.input),s}function nh(e){return typeof e.constructor=="function"&&!jn(e)?un(Ns(e)):{}}function sg(e,i,s){var u=e.constructor;switch(i){case $e:return Oa(e);case $:case T:return new u(+e);case ke:return Hd(e,s);case ht:case qe:case Pt:case Dt:case Ut:case Ht:case jt:case Wt:case rr:return zu(e,s);case be:return new u;case Ne:case Ye:return new u(e);case ot:return Bd(e);case Le:return new u;case Xe:return kd(e)}}function og(e,i){var s=i.length;if(!s)return e;var u=s-1;return i[u]=(s>1?"& ":"")+i[u],i=i.join(s>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function ag(e){return _e(e)||Ui(e)||!!(uu&&e&&e[uu])}function ei(e,i){var s=typeof e;return i=i??V,!!i&&(s=="number"||s!="symbol"&&jo.test(e))&&e>-1&&e%1==0&&e<i}function Xt(e,i,s){if(!ut(s))return!1;var u=typeof i;return(u=="number"?sr(s)&&ei(i,s.length):u=="string"&&i in s)?Nr(s[i],e):!1}function Fa(e,i){if(_e(e))return!1;var s=typeof e;return s=="number"||s=="symbol"||s=="boolean"||e==null||dr(e)?!0:St.test(e)||!it.test(e)||i!=null&&e in We(i)}function cg(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function La(e){var i=Ys(e),s=d[i];if(typeof s!="function"||!(i in Oe.prototype))return!1;if(e===s)return!0;var u=Na(s);return!!u&&e===u[0]}function ug(e){return!!su&&su in e}var hg=Os?ti:Za;function jn(e){var i=e&&e.constructor,s=typeof i=="function"&&i.prototype||on;return e===s}function sh(e){return e===e&&!ut(e)}function oh(e,i){return function(s){return s==null?!1:s[e]===i&&(i!==t||e in We(s))}}function lg(e){var i=io(e,function(u){return s.size===p&&s.clear(),u}),s=i.cache;return i}function fg(e,i){var s=e[1],u=i[1],l=s|u,y=l<(re|he|U),w=u==U&&s==fe||u==U&&s==W&&e[7].length<=i[8]||u==(U|W)&&i[7].length<=i[8]&&s==fe;if(!(y||w))return e;u&re&&(e[2]=i[2],l|=s&re?0:le);var E=i[3];if(E){var R=e[3];e[3]=R?Hu(R,E,i[4]):E,e[4]=R?yi(e[3],b):i[4]}return E=i[5],E&&(R=e[5],e[5]=R?Bu(R,E,i[6]):E,e[6]=R?yi(e[5],b):i[6]),E=i[7],E&&(e[7]=E),u&U&&(e[8]=e[8]==null?i[8]:Kt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function pg(e){var i=[];if(e!=null)for(var s in We(e))i.push(s);return i}function dg(e){return As.call(e)}function ah(e,i,s){return i=Lt(i===t?e.length-1:i,0),function(){for(var u=arguments,l=-1,y=Lt(u.length-i,0),w=N(y);++l<y;)w[l]=u[i+l];l=-1;for(var E=N(i+1);++l<i;)E[l]=u[l];return E[i]=s(w),qt(e,this,E)}}function ch(e,i){return i.length<2?e:qi(e,Ir(i,0,-1))}function gg(e,i){for(var s=e.length,u=Kt(i.length,s),l=nr(e);u--;){var y=i[u];e[u]=ei(y,s)?l[y]:t}return e}function ja(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var uh=lh(Nu),qn=Tp||function(e,i){return Re.setTimeout(e,i)},qa=lh(qd);function hh(e,i,s){var u=i+"";return qa(e,og(u,yg(ig(u),s)))}function lh(e){var i=0,s=0;return function(){var u=Dp(),l=ze-(u-s);if(s=u,l>0){if(++i>=Ce)return arguments[0]}else i=0;return e.apply(t,arguments)}}function Zs(e,i){var s=-1,u=e.length,l=u-1;for(i=i===t?u:i;++s<i;){var y=wa(s,l),w=e[y];e[y]=e[s],e[s]=w}return e.length=i,e}var fh=lg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ot,function(s,u,l,y){i.push(l?y.replace(Co,"$1"):u||s)}),i});function kr(e){if(typeof e=="string"||dr(e))return e;var i=e+"";return i=="0"&&1/e==-ce?"-0":i}function zi(e){if(e!=null){try{return Rs.call(e)}catch{}try{return e+""}catch{}}return""}function yg(e,i){return _r(qr,function(s){var u="_."+s[0];i&s[1]&&!Is(e,u)&&e.push(u)}),e.sort()}function ph(e){if(e instanceof Oe)return e.clone();var i=new br(e.__wrapped__,e.__chain__);return i.__actions__=nr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function vg(e,i,s){(s?Xt(e,i,s):i===t)?i=1:i=Lt(we(i),0);var u=e==null?0:e.length;if(!u||i<1)return[];for(var l=0,y=0,w=N(Fs(u/i));l<u;)w[y++]=Ir(e,l,l+=i);return w}function mg(e){for(var i=-1,s=e==null?0:e.length,u=0,l=[];++i<s;){var y=e[i];y&&(l[u++]=y)}return l}function _g(){var e=arguments.length;if(!e)return[];for(var i=N(e-1),s=arguments[0],u=e;u--;)i[u-1]=arguments[u];return gi(_e(s)?nr(s):[s],Bt(i,1))}var wg=xe(function(e,i){return bt(e)?Nn(e,Bt(i,1,bt,!0)):[]}),bg=xe(function(e,i){var s=xr(i);return bt(s)&&(s=t),bt(e)?Nn(e,Bt(i,1,bt,!0),se(s,2)):[]}),Eg=xe(function(e,i){var s=xr(i);return bt(s)&&(s=t),bt(e)?Nn(e,Bt(i,1,bt,!0),t,s):[]});function Ig(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===t?1:we(i),Ir(e,i<0?0:i,u)):[]}function xg(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===t?1:we(i),i=u-i,Ir(e,0,i<0?0:i)):[]}function Pg(e,i){return e&&e.length?Ks(e,se(i,3),!0,!0):[]}function Sg(e,i){return e&&e.length?Ks(e,se(i,3),!0):[]}function Og(e,i,s,u){var l=e==null?0:e.length;return l?(s&&typeof s!="number"&&Xt(e,i,s)&&(s=0,u=l),_d(e,i,s,u)):[]}function dh(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=s==null?0:we(s);return l<0&&(l=Lt(u+l,0)),xs(e,se(i,3),l)}function gh(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=u-1;return s!==t&&(l=we(s),l=s<0?Lt(u+l,0):Kt(l,u-1)),xs(e,se(i,3),l,!0)}function yh(e){var i=e==null?0:e.length;return i?Bt(e,1):[]}function Rg(e){var i=e==null?0:e.length;return i?Bt(e,ce):[]}function Ag(e,i){var s=e==null?0:e.length;return s?(i=i===t?1:we(i),Bt(e,i)):[]}function Tg(e){for(var i=-1,s=e==null?0:e.length,u={};++i<s;){var l=e[i];u[l[0]]=l[1]}return u}function vh(e){return e&&e.length?e[0]:t}function Cg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=s==null?0:we(s);return l<0&&(l=Lt(u+l,0)),tn(e,i,l)}function Ng(e){var i=e==null?0:e.length;return i?Ir(e,0,-1):[]}var $g=xe(function(e){var i=nt(e,Pa);return i.length&&i[0]===e[0]?ga(i):[]}),Dg=xe(function(e){var i=xr(e),s=nt(e,Pa);return i===xr(s)?i=t:s.pop(),s.length&&s[0]===e[0]?ga(s,se(i,2)):[]}),Fg=xe(function(e){var i=xr(e),s=nt(e,Pa);return i=typeof i=="function"?i:t,i&&s.pop(),s.length&&s[0]===e[0]?ga(s,t,i):[]});function Lg(e,i){return e==null?"":Np.call(e,i)}function xr(e){var i=e==null?0:e.length;return i?e[i-1]:t}function jg(e,i,s){var u=e==null?0:e.length;if(!u)return-1;var l=u;return s!==t&&(l=we(s),l=l<0?Lt(u+l,0):Kt(l,u-1)),i===i?yp(e,i,l):xs(e,Yc,l,!0)}function qg(e,i){return e&&e.length?Ru(e,we(i)):t}var Mg=xe(mh);function mh(e,i){return e&&e.length&&i&&i.length?_a(e,i):e}function zg(e,i,s){return e&&e.length&&i&&i.length?_a(e,i,se(s,2)):e}function Ug(e,i,s){return e&&e.length&&i&&i.length?_a(e,i,t,s):e}var Hg=Zr(function(e,i){var s=e==null?0:e.length,u=la(e,i);return Cu(e,nt(i,function(l){return ei(l,s)?+l:l}).sort(Uu)),u});function Bg(e,i){var s=[];if(!(e&&e.length))return s;var u=-1,l=[],y=e.length;for(i=se(i,3);++u<y;){var w=e[u];i(w,u,e)&&(s.push(w),l.push(u))}return Cu(e,l),s}function Ma(e){return e==null?e:Lp.call(e)}function kg(e,i,s){var u=e==null?0:e.length;return u?(s&&typeof s!="number"&&Xt(e,i,s)?(i=0,s=u):(i=i==null?0:we(i),s=s===t?u:we(s)),Ir(e,i,s)):[]}function Kg(e,i){return ks(e,i)}function Vg(e,i,s){return Ea(e,i,se(s,2))}function Gg(e,i){var s=e==null?0:e.length;if(s){var u=ks(e,i);if(u<s&&Nr(e[u],i))return u}return-1}function Wg(e,i){return ks(e,i,!0)}function Jg(e,i,s){return Ea(e,i,se(s,2),!0)}function Qg(e,i){var s=e==null?0:e.length;if(s){var u=ks(e,i,!0)-1;if(Nr(e[u],i))return u}return-1}function Yg(e){return e&&e.length?$u(e):[]}function Xg(e,i){return e&&e.length?$u(e,se(i,2)):[]}function Zg(e){var i=e==null?0:e.length;return i?Ir(e,1,i):[]}function ey(e,i,s){return e&&e.length?(i=s||i===t?1:we(i),Ir(e,0,i<0?0:i)):[]}function ty(e,i,s){var u=e==null?0:e.length;return u?(i=s||i===t?1:we(i),i=u-i,Ir(e,i<0?0:i,u)):[]}function ry(e,i){return e&&e.length?Ks(e,se(i,3),!1,!0):[]}function iy(e,i){return e&&e.length?Ks(e,se(i,3)):[]}var ny=xe(function(e){return _i(Bt(e,1,bt,!0))}),sy=xe(function(e){var i=xr(e);return bt(i)&&(i=t),_i(Bt(e,1,bt,!0),se(i,2))}),oy=xe(function(e){var i=xr(e);return i=typeof i=="function"?i:t,_i(Bt(e,1,bt,!0),t,i)});function ay(e){return e&&e.length?_i(e):[]}function cy(e,i){return e&&e.length?_i(e,se(i,2)):[]}function uy(e,i){return i=typeof i=="function"?i:t,e&&e.length?_i(e,t,i):[]}function za(e){if(!(e&&e.length))return[];var i=0;return e=di(e,function(s){if(bt(s))return i=Lt(s.length,i),!0}),ia(i,function(s){return nt(e,ea(s))})}function _h(e,i){if(!(e&&e.length))return[];var s=za(e);return i==null?s:nt(s,function(u){return qt(i,t,u)})}var hy=xe(function(e,i){return bt(e)?Nn(e,i):[]}),ly=xe(function(e){return xa(di(e,bt))}),fy=xe(function(e){var i=xr(e);return bt(i)&&(i=t),xa(di(e,bt),se(i,2))}),py=xe(function(e){var i=xr(e);return i=typeof i=="function"?i:t,xa(di(e,bt),t,i)}),dy=xe(za);function gy(e,i){return ju(e||[],i||[],Cn)}function yy(e,i){return ju(e||[],i||[],Fn)}var vy=xe(function(e){var i=e.length,s=i>1?e[i-1]:t;return s=typeof s=="function"?(e.pop(),s):t,_h(e,s)});function wh(e){var i=d(e);return i.__chain__=!0,i}function my(e,i){return i(e),e}function eo(e,i){return i(e)}var _y=Zr(function(e){var i=e.length,s=i?e[0]:0,u=this.__wrapped__,l=function(y){return la(y,e)};return i>1||this.__actions__.length||!(u instanceof Oe)||!ei(s)?this.thru(l):(u=u.slice(s,+s+(i?1:0)),u.__actions__.push({func:eo,args:[l],thisArg:t}),new br(u,this.__chain__).thru(function(y){return i&&!y.length&&y.push(t),y}))});function wy(){return wh(this)}function by(){return new br(this.value(),this.__chain__)}function Ey(){this.__values__===t&&(this.__values__=Dh(this.value()));var e=this.__index__>=this.__values__.length,i=e?t:this.__values__[this.__index__++];return{done:e,value:i}}function Iy(){return this}function xy(e){for(var i,s=this;s instanceof Ms;){var u=ph(s);u.__index__=0,u.__values__=t,i?l.__wrapped__=u:i=u;var l=u;s=s.__wrapped__}return l.__wrapped__=e,i}function Py(){var e=this.__wrapped__;if(e instanceof Oe){var i=e;return this.__actions__.length&&(i=new Oe(this)),i=i.reverse(),i.__actions__.push({func:eo,args:[Ma],thisArg:t}),new br(i,this.__chain__)}return this.thru(Ma)}function Sy(){return Lu(this.__wrapped__,this.__actions__)}var Oy=Vs(function(e,i,s){Me.call(e,s)?++e[s]:Yr(e,s,1)});function Ry(e,i,s){var u=_e(e)?Jc:md;return s&&Xt(e,i,s)&&(i=t),u(e,se(i,3))}function Ay(e,i){var s=_e(e)?di:_u;return s(e,se(i,3))}var Ty=Gu(dh),Cy=Gu(gh);function Ny(e,i){return Bt(to(e,i),1)}function $y(e,i){return Bt(to(e,i),ce)}function Dy(e,i,s){return s=s===t?1:we(s),Bt(to(e,i),s)}function bh(e,i){var s=_e(e)?_r:mi;return s(e,se(i,3))}function Eh(e,i){var s=_e(e)?Zf:mu;return s(e,se(i,3))}var Fy=Vs(function(e,i,s){Me.call(e,s)?e[s].push(i):Yr(e,s,[i])});function Ly(e,i,s,u){e=sr(e)?e:dn(e),s=s&&!u?we(s):0;var l=e.length;return s<0&&(s=Lt(l+s,0)),oo(e)?s<=l&&e.indexOf(i,s)>-1:!!l&&tn(e,i,s)>-1}var jy=xe(function(e,i,s){var u=-1,l=typeof i=="function",y=sr(e)?N(e.length):[];return mi(e,function(w){y[++u]=l?qt(i,w,s):$n(w,i,s)}),y}),qy=Vs(function(e,i,s){Yr(e,s,i)});function to(e,i){var s=_e(e)?nt:Pu;return s(e,se(i,3))}function My(e,i,s,u){return e==null?[]:(_e(i)||(i=i==null?[]:[i]),s=u?t:s,_e(s)||(s=s==null?[]:[s]),Au(e,i,s))}var zy=Vs(function(e,i,s){e[s?0:1].push(i)},function(){return[[],[]]});function Uy(e,i,s){var u=_e(e)?Xo:Zc,l=arguments.length<3;return u(e,se(i,4),s,l,mi)}function Hy(e,i,s){var u=_e(e)?ep:Zc,l=arguments.length<3;return u(e,se(i,4),s,l,mu)}function By(e,i){var s=_e(e)?di:_u;return s(e,no(se(i,3)))}function ky(e){var i=_e(e)?du:Ld;return i(e)}function Ky(e,i,s){(s?Xt(e,i,s):i===t)?i=1:i=we(i);var u=_e(e)?pd:jd;return u(e,i)}function Vy(e){var i=_e(e)?dd:Md;return i(e)}function Gy(e){if(e==null)return 0;if(sr(e))return oo(e)?nn(e):e.length;var i=Vt(e);return i==be||i==Le?e.size:va(e).length}function Wy(e,i,s){var u=_e(e)?Zo:zd;return s&&Xt(e,i,s)&&(i=t),u(e,se(i,3))}var Jy=xe(function(e,i){if(e==null)return[];var s=i.length;return s>1&&Xt(e,i[0],i[1])?i=[]:s>2&&Xt(i[0],i[1],i[2])&&(i=[i[0]]),Au(e,Bt(i,1),[])}),ro=Ap||function(){return Re.Date.now()};function Qy(e,i){if(typeof i!="function")throw new wr(f);return e=we(e),function(){if(--e<1)return i.apply(this,arguments)}}function Ih(e,i,s){return i=s?t:i,i=e&&i==null?e.length:i,Xr(e,U,t,t,t,t,i)}function xh(e,i){var s;if(typeof i!="function")throw new wr(f);return e=we(e),function(){return--e>0&&(s=i.apply(this,arguments)),e<=1&&(i=t),s}}var Ua=xe(function(e,i,s){var u=re;if(s.length){var l=yi(s,fn(Ua));u|=de}return Xr(e,u,i,s,l)}),Ph=xe(function(e,i,s){var u=re|he;if(s.length){var l=yi(s,fn(Ph));u|=de}return Xr(i,u,e,s,l)});function Sh(e,i,s){i=s?t:i;var u=Xr(e,fe,t,t,t,t,t,i);return u.placeholder=Sh.placeholder,u}function Oh(e,i,s){i=s?t:i;var u=Xr(e,pe,t,t,t,t,t,i);return u.placeholder=Oh.placeholder,u}function Rh(e,i,s){var u,l,y,w,E,R,q=0,M=!1,B=!1,J=!0;if(typeof e!="function")throw new wr(f);i=Pr(i)||0,ut(s)&&(M=!!s.leading,B="maxWait"in s,y=B?Lt(Pr(s.maxWait)||0,i):y,J="trailing"in s?!!s.trailing:J);function te(Et){var $r=u,ii=l;return u=l=t,q=Et,w=e.apply(ii,$r),w}function oe(Et){return q=Et,E=qn(Pe,i),M?te(Et):w}function Ee(Et){var $r=Et-R,ii=Et-q,Gh=i-$r;return B?Kt(Gh,y-ii):Gh}function ae(Et){var $r=Et-R,ii=Et-q;return R===t||$r>=i||$r<0||B&&ii>=y}function Pe(){var Et=ro();if(ae(Et))return Ae(Et);E=qn(Pe,Ee(Et))}function Ae(Et){return E=t,J&&u?te(Et):(u=l=t,w)}function gr(){E!==t&&qu(E),q=0,u=R=l=E=t}function Zt(){return E===t?w:Ae(ro())}function yr(){var Et=ro(),$r=ae(Et);if(u=arguments,l=this,R=Et,$r){if(E===t)return oe(R);if(B)return qu(E),E=qn(Pe,i),te(R)}return E===t&&(E=qn(Pe,i)),w}return yr.cancel=gr,yr.flush=Zt,yr}var Yy=xe(function(e,i){return vu(e,1,i)}),Xy=xe(function(e,i,s){return vu(e,Pr(i)||0,s)});function Zy(e){return Xr(e,ve)}function io(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new wr(f);var s=function(){var u=arguments,l=i?i.apply(this,u):u[0],y=s.cache;if(y.has(l))return y.get(l);var w=e.apply(this,u);return s.cache=y.set(l,w)||y,w};return s.cache=new(io.Cache||Qr),s}io.Cache=Qr;function no(e){if(typeof e!="function")throw new wr(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function ev(e){return xh(2,e)}var tv=Ud(function(e,i){i=i.length==1&&_e(i[0])?nt(i[0],fr(se())):nt(Bt(i,1),fr(se()));var s=i.length;return xe(function(u){for(var l=-1,y=Kt(u.length,s);++l<y;)u[l]=i[l].call(this,u[l]);return qt(e,this,u)})}),Ha=xe(function(e,i){var s=yi(i,fn(Ha));return Xr(e,de,t,i,s)}),Ah=xe(function(e,i){var s=yi(i,fn(Ah));return Xr(e,L,t,i,s)}),rv=Zr(function(e,i){return Xr(e,W,t,t,t,i)});function iv(e,i){if(typeof e!="function")throw new wr(f);return i=i===t?i:we(i),xe(e,i)}function nv(e,i){if(typeof e!="function")throw new wr(f);return i=i==null?0:Lt(we(i),0),xe(function(s){var u=s[i],l=bi(s,0,i);return u&&gi(l,u),qt(e,this,l)})}function sv(e,i,s){var u=!0,l=!0;if(typeof e!="function")throw new wr(f);return ut(s)&&(u="leading"in s?!!s.leading:u,l="trailing"in s?!!s.trailing:l),Rh(e,i,{leading:u,maxWait:i,trailing:l})}function ov(e){return Ih(e,1)}function av(e,i){return Ha(Sa(i),e)}function cv(){if(!arguments.length)return[];var e=arguments[0];return _e(e)?e:[e]}function uv(e){return Er(e,D)}function hv(e,i){return i=typeof i=="function"?i:t,Er(e,D,i)}function lv(e){return Er(e,A|D)}function fv(e,i){return i=typeof i=="function"?i:t,Er(e,A|D,i)}function pv(e,i){return i==null||yu(e,i,Mt(i))}function Nr(e,i){return e===i||e!==e&&i!==i}var dv=Qs(da),gv=Qs(function(e,i){return e>=i}),Ui=Eu(function(){return arguments}())?Eu:function(e){return vt(e)&&Me.call(e,"callee")&&!cu.call(e,"callee")},_e=N.isArray,yv=Qt?fr(Qt):xd;function sr(e){return e!=null&&so(e.length)&&!ti(e)}function bt(e){return vt(e)&&sr(e)}function vv(e){return e===!0||e===!1||vt(e)&&Yt(e)==$}var Ei=Cp||Za,mv=Ar?fr(Ar):Pd;function _v(e){return vt(e)&&e.nodeType===1&&!Mn(e)}function wv(e){if(e==null)return!0;if(sr(e)&&(_e(e)||typeof e=="string"||typeof e.splice=="function"||Ei(e)||pn(e)||Ui(e)))return!e.length;var i=Vt(e);if(i==be||i==Le)return!e.size;if(jn(e))return!va(e).length;for(var s in e)if(Me.call(e,s))return!1;return!0}function bv(e,i){return Dn(e,i)}function Ev(e,i,s){s=typeof s=="function"?s:t;var u=s?s(e,i):t;return u===t?Dn(e,i,t,s):!!u}function Ba(e){if(!vt(e))return!1;var i=Yt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Mn(e)}function Iv(e){return typeof e=="number"&&hu(e)}function ti(e){if(!ut(e))return!1;var i=Yt(e);return i==ee||i==ge||i==F||i==mt}function Th(e){return typeof e=="number"&&e==we(e)}function so(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=V}function ut(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function vt(e){return e!=null&&typeof e=="object"}var Ch=mr?fr(mr):Od;function xv(e,i){return e===i||ya(e,i,$a(i))}function Pv(e,i,s){return s=typeof s=="function"?s:t,ya(e,i,$a(i),s)}function Sv(e){return Nh(e)&&e!=+e}function Ov(e){if(hg(e))throw new ye(c);return Iu(e)}function Rv(e){return e===null}function Av(e){return e==null}function Nh(e){return typeof e=="number"||vt(e)&&Yt(e)==Ne}function Mn(e){if(!vt(e)||Yt(e)!=Se)return!1;var i=Ns(e);if(i===null)return!0;var s=Me.call(i,"constructor")&&i.constructor;return typeof s=="function"&&s instanceof s&&Rs.call(s)==Pp}var ka=Ur?fr(Ur):Rd;function Tv(e){return Th(e)&&e>=-V&&e<=V}var $h=xn?fr(xn):Ad;function oo(e){return typeof e=="string"||!_e(e)&&vt(e)&&Yt(e)==Ye}function dr(e){return typeof e=="symbol"||vt(e)&&Yt(e)==Xe}var pn=$i?fr($i):Td;function Cv(e){return e===t}function Nv(e){return vt(e)&&Vt(e)==Ue}function $v(e){return vt(e)&&Yt(e)==Ze}var Dv=Qs(ma),Fv=Qs(function(e,i){return e<=i});function Dh(e){if(!e)return[];if(sr(e))return oo(e)?Tr(e):nr(e);if(Sn&&e[Sn])return pp(e[Sn]());var i=Vt(e),s=i==be?sa:i==Le?Ps:dn;return s(e)}function ri(e){if(!e)return e===0?e:0;if(e=Pr(e),e===ce||e===-ce){var i=e<0?-1:1;return i*H}return e===e?e:0}function we(e){var i=ri(e),s=i%1;return i===i?s?i-s:i:0}function Fh(e){return e?ji(we(e),0,G):0}function Pr(e){if(typeof e=="number")return e;if(dr(e))return k;if(ut(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ut(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=eu(e);var s=Do.test(e);return s||Lo.test(e)?me(e.slice(2),s?2:8):$o.test(e)?k:+e}function Lh(e){return Br(e,or(e))}function Lv(e){return e?ji(we(e),-V,V):e===0?e:0}function je(e){return e==null?"":pr(e)}var jv=hn(function(e,i){if(jn(i)||sr(i)){Br(i,Mt(i),e);return}for(var s in i)Me.call(i,s)&&Cn(e,s,i[s])}),jh=hn(function(e,i){Br(i,or(i),e)}),ao=hn(function(e,i,s,u){Br(i,or(i),e,u)}),qv=hn(function(e,i,s,u){Br(i,Mt(i),e,u)}),Mv=Zr(la);function zv(e,i){var s=un(e);return i==null?s:gu(s,i)}var Uv=xe(function(e,i){e=We(e);var s=-1,u=i.length,l=u>2?i[2]:t;for(l&&Xt(i[0],i[1],l)&&(u=1);++s<u;)for(var y=i[s],w=or(y),E=-1,R=w.length;++E<R;){var q=w[E],M=e[q];(M===t||Nr(M,on[q])&&!Me.call(e,q))&&(e[q]=y[q])}return e}),Hv=xe(function(e){return e.push(t,eh),qt(qh,t,e)});function Bv(e,i){return Qc(e,se(i,3),Hr)}function kv(e,i){return Qc(e,se(i,3),pa)}function Kv(e,i){return e==null?e:fa(e,se(i,3),or)}function Vv(e,i){return e==null?e:wu(e,se(i,3),or)}function Gv(e,i){return e&&Hr(e,se(i,3))}function Wv(e,i){return e&&pa(e,se(i,3))}function Jv(e){return e==null?[]:Hs(e,Mt(e))}function Qv(e){return e==null?[]:Hs(e,or(e))}function Ka(e,i,s){var u=e==null?t:qi(e,i);return u===t?s:u}function Yv(e,i){return e!=null&&ih(e,i,wd)}function Va(e,i){return e!=null&&ih(e,i,bd)}var Xv=Ju(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=As.call(i)),e[i]=s},Wa(ar)),Zv=Ju(function(e,i,s){i!=null&&typeof i.toString!="function"&&(i=As.call(i)),Me.call(e,i)?e[i].push(s):e[i]=[s]},se),e0=xe($n);function Mt(e){return sr(e)?pu(e):va(e)}function or(e){return sr(e)?pu(e,!0):Cd(e)}function t0(e,i){var s={};return i=se(i,3),Hr(e,function(u,l,y){Yr(s,i(u,l,y),u)}),s}function r0(e,i){var s={};return i=se(i,3),Hr(e,function(u,l,y){Yr(s,l,i(u,l,y))}),s}var i0=hn(function(e,i,s){Bs(e,i,s)}),qh=hn(function(e,i,s,u){Bs(e,i,s,u)}),n0=Zr(function(e,i){var s={};if(e==null)return s;var u=!1;i=nt(i,function(y){return y=wi(y,e),u||(u=y.length>1),y}),Br(e,Ca(e),s),u&&(s=Er(s,A|x|D,Xd));for(var l=i.length;l--;)Ia(s,i[l]);return s});function s0(e,i){return Mh(e,no(se(i)))}var o0=Zr(function(e,i){return e==null?{}:$d(e,i)});function Mh(e,i){if(e==null)return{};var s=nt(Ca(e),function(u){return[u]});return i=se(i),Tu(e,s,function(u,l){return i(u,l[0])})}function a0(e,i,s){i=wi(i,e);var u=-1,l=i.length;for(l||(l=1,e=t);++u<l;){var y=e==null?t:e[kr(i[u])];y===t&&(u=l,y=s),e=ti(y)?y.call(e):y}return e}function c0(e,i,s){return e==null?e:Fn(e,i,s)}function u0(e,i,s,u){return u=typeof u=="function"?u:t,e==null?e:Fn(e,i,s,u)}var zh=Xu(Mt),Uh=Xu(or);function h0(e,i,s){var u=_e(e),l=u||Ei(e)||pn(e);if(i=se(i,4),s==null){var y=e&&e.constructor;l?s=u?new y:[]:ut(e)?s=ti(y)?un(Ns(e)):{}:s={}}return(l?_r:Hr)(e,function(w,E,R){return i(s,w,E,R)}),s}function l0(e,i){return e==null?!0:Ia(e,i)}function f0(e,i,s){return e==null?e:Fu(e,i,Sa(s))}function p0(e,i,s,u){return u=typeof u=="function"?u:t,e==null?e:Fu(e,i,Sa(s),u)}function dn(e){return e==null?[]:na(e,Mt(e))}function d0(e){return e==null?[]:na(e,or(e))}function g0(e,i,s){return s===t&&(s=i,i=t),s!==t&&(s=Pr(s),s=s===s?s:0),i!==t&&(i=Pr(i),i=i===i?i:0),ji(Pr(e),i,s)}function y0(e,i,s){return i=ri(i),s===t?(s=i,i=0):s=ri(s),e=Pr(e),Ed(e,i,s)}function v0(e,i,s){if(s&&typeof s!="boolean"&&Xt(e,i,s)&&(i=s=t),s===t&&(typeof i=="boolean"?(s=i,i=t):typeof e=="boolean"&&(s=e,e=t)),e===t&&i===t?(e=0,i=1):(e=ri(e),i===t?(i=e,e=0):i=ri(i)),e>i){var u=e;e=i,i=u}if(s||e%1||i%1){var l=lu();return Kt(e+l*(i-e+Ve("1e-"+((l+"").length-1))),i)}return wa(e,i)}var m0=ln(function(e,i,s){return i=i.toLowerCase(),e+(s?Hh(i):i)});function Hh(e){return Ga(je(e).toLowerCase())}function Bh(e){return e=je(e),e&&e.replace(Gr,cp).replace(Jo,"")}function _0(e,i,s){e=je(e),i=pr(i);var u=e.length;s=s===t?u:ji(we(s),0,u);var l=s;return s-=i.length,s>=0&&e.slice(s,l)==i}function w0(e){return e=je(e),e&&rt.test(e)?e.replace(Ri,up):e}function b0(e){return e=je(e),e&&Rt.test(e)?e.replace(dt,"\\$&"):e}var E0=ln(function(e,i,s){return e+(s?"-":"")+i.toLowerCase()}),I0=ln(function(e,i,s){return e+(s?" ":"")+i.toLowerCase()}),x0=Vu("toLowerCase");function P0(e,i,s){e=je(e),i=we(i);var u=i?nn(e):0;if(!i||u>=i)return e;var l=(i-u)/2;return Js(Ls(l),s)+e+Js(Fs(l),s)}function S0(e,i,s){e=je(e),i=we(i);var u=i?nn(e):0;return i&&u<i?e+Js(i-u,s):e}function O0(e,i,s){e=je(e),i=we(i);var u=i?nn(e):0;return i&&u<i?Js(i-u,s)+e:e}function R0(e,i,s){return s||i==null?i=0:i&&(i=+i),Fp(je(e).replace(gt,""),i||0)}function A0(e,i,s){return(s?Xt(e,i,s):i===t)?i=1:i=we(i),ba(je(e),i)}function T0(){var e=arguments,i=je(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var C0=ln(function(e,i,s){return e+(s?"_":"")+i.toLowerCase()});function N0(e,i,s){return s&&typeof s!="number"&&Xt(e,i,s)&&(i=s=t),s=s===t?G:s>>>0,s?(e=je(e),e&&(typeof i=="string"||i!=null&&!ka(i))&&(i=pr(i),!i&&rn(e))?bi(Tr(e),0,s):e.split(i,s)):[]}var $0=ln(function(e,i,s){return e+(s?" ":"")+Ga(i)});function D0(e,i,s){return e=je(e),s=s==null?0:ji(we(s),0,e.length),i=pr(i),e.slice(s,s+i.length)==i}function F0(e,i,s){var u=d.templateSettings;s&&Xt(e,i,s)&&(i=t),e=je(e),i=ao({},i,u,Zu);var l=ao({},i.imports,u.imports,Zu),y=Mt(l),w=na(l,y),E,R,q=0,M=i.interpolate||Wi,B="__p += '",J=oa((i.escape||Wi).source+"|"+M.source+"|"+(M===ct?No:Wi).source+"|"+(i.evaluate||Wi).source+"|$","g"),te="//# sourceURL="+(Me.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Qo+"]")+`
`;e.replace(J,function(ae,Pe,Ae,gr,Zt,yr){return Ae||(Ae=gr),B+=e.slice(q,yr).replace(qo,hp),Pe&&(E=!0,B+=`' +
__e(`+Pe+`) +
'`),Zt&&(R=!0,B+=`';
`+Zt+`;
__p += '`),Ae&&(B+=`' +
((__t = (`+Ae+`)) == null ? '' : __t) +
'`),q=yr+ae.length,ae}),B+=`';
`;var oe=Me.call(i,"variable")&&i.variable;if(!oe)B=`with (obj) {
`+B+`
}
`;else if(To.test(oe))throw new ye(g);B=(R?B.replace(Mr,""):B).replace(Jt,"$1").replace(Vr,"$1;"),B="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(E?", __e = _.escape":"")+(R?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+B+`return __p
}`;var Ee=Kh(function(){return Fe(y,te+"return "+B).apply(t,w)});if(Ee.source=B,Ba(Ee))throw Ee;return Ee}function L0(e){return je(e).toLowerCase()}function j0(e){return je(e).toUpperCase()}function q0(e,i,s){if(e=je(e),e&&(s||i===t))return eu(e);if(!e||!(i=pr(i)))return e;var u=Tr(e),l=Tr(i),y=tu(u,l),w=ru(u,l)+1;return bi(u,y,w).join("")}function M0(e,i,s){if(e=je(e),e&&(s||i===t))return e.slice(0,nu(e)+1);if(!e||!(i=pr(i)))return e;var u=Tr(e),l=ru(u,Tr(i))+1;return bi(u,0,l).join("")}function z0(e,i,s){if(e=je(e),e&&(s||i===t))return e.replace(gt,"");if(!e||!(i=pr(i)))return e;var u=Tr(e),l=tu(u,Tr(i));return bi(u,l).join("")}function U0(e,i){var s=ie,u=ue;if(ut(i)){var l="separator"in i?i.separator:l;s="length"in i?we(i.length):s,u="omission"in i?pr(i.omission):u}e=je(e);var y=e.length;if(rn(e)){var w=Tr(e);y=w.length}if(s>=y)return e;var E=s-nn(u);if(E<1)return u;var R=w?bi(w,0,E).join(""):e.slice(0,E);if(l===t)return R+u;if(w&&(E+=R.length-E),ka(l)){if(e.slice(E).search(l)){var q,M=R;for(l.global||(l=oa(l.source,je(vr.exec(l))+"g")),l.lastIndex=0;q=l.exec(M);)var B=q.index;R=R.slice(0,B===t?E:B)}}else if(e.indexOf(pr(l),E)!=E){var J=R.lastIndexOf(l);J>-1&&(R=R.slice(0,J))}return R+u}function H0(e){return e=je(e),e&&lt.test(e)?e.replace(fi,vp):e}var B0=ln(function(e,i,s){return e+(s?" ":"")+i.toUpperCase()}),Ga=Vu("toUpperCase");function kh(e,i,s){return e=je(e),i=s?t:i,i===t?fp(e)?wp(e):ip(e):e.match(i)||[]}var Kh=xe(function(e,i){try{return qt(e,t,i)}catch(s){return Ba(s)?s:new ye(s)}}),k0=Zr(function(e,i){return _r(i,function(s){s=kr(s),Yr(e,s,Ua(e[s],e))}),e});function K0(e){var i=e==null?0:e.length,s=se();return e=i?nt(e,function(u){if(typeof u[1]!="function")throw new wr(f);return[s(u[0]),u[1]]}):[],xe(function(u){for(var l=-1;++l<i;){var y=e[l];if(qt(y[0],this,u))return qt(y[1],this,u)}})}function V0(e){return vd(Er(e,A))}function Wa(e){return function(){return e}}function G0(e,i){return e==null||e!==e?i:e}var W0=Wu(),J0=Wu(!0);function ar(e){return e}function Ja(e){return xu(typeof e=="function"?e:Er(e,A))}function Q0(e){return Su(Er(e,A))}function Y0(e,i){return Ou(e,Er(i,A))}var X0=xe(function(e,i){return function(s){return $n(s,e,i)}}),Z0=xe(function(e,i){return function(s){return $n(e,s,i)}});function Qa(e,i,s){var u=Mt(i),l=Hs(i,u);s==null&&!(ut(i)&&(l.length||!u.length))&&(s=i,i=e,e=this,l=Hs(i,Mt(i)));var y=!(ut(s)&&"chain"in s)||!!s.chain,w=ti(e);return _r(l,function(E){var R=i[E];e[E]=R,w&&(e.prototype[E]=function(){var q=this.__chain__;if(y||q){var M=e(this.__wrapped__),B=M.__actions__=nr(this.__actions__);return B.push({func:R,args:arguments,thisArg:e}),M.__chain__=q,M}return R.apply(e,gi([this.value()],arguments))})}),e}function em(){return Re._===this&&(Re._=Sp),this}function Ya(){}function tm(e){return e=we(e),xe(function(i){return Ru(i,e)})}var rm=Ra(nt),im=Ra(Jc),nm=Ra(Zo);function Vh(e){return Fa(e)?ea(kr(e)):Dd(e)}function sm(e){return function(i){return e==null?t:qi(e,i)}}var om=Qu(),am=Qu(!0);function Xa(){return[]}function Za(){return!1}function cm(){return{}}function um(){return""}function hm(){return!0}function lm(e,i){if(e=we(e),e<1||e>V)return[];var s=G,u=Kt(e,G);i=se(i),e-=G;for(var l=ia(u,i);++s<e;)i(s);return l}function fm(e){return _e(e)?nt(e,kr):dr(e)?[e]:nr(fh(je(e)))}function pm(e){var i=++xp;return je(e)+i}var dm=Ws(function(e,i){return e+i},0),gm=Aa("ceil"),ym=Ws(function(e,i){return e/i},1),vm=Aa("floor");function mm(e){return e&&e.length?Us(e,ar,da):t}function _m(e,i){return e&&e.length?Us(e,se(i,2),da):t}function wm(e){return Xc(e,ar)}function bm(e,i){return Xc(e,se(i,2))}function Em(e){return e&&e.length?Us(e,ar,ma):t}function Im(e,i){return e&&e.length?Us(e,se(i,2),ma):t}var xm=Ws(function(e,i){return e*i},1),Pm=Aa("round"),Sm=Ws(function(e,i){return e-i},0);function Om(e){return e&&e.length?ra(e,ar):0}function Rm(e,i){return e&&e.length?ra(e,se(i,2)):0}return d.after=Qy,d.ary=Ih,d.assign=jv,d.assignIn=jh,d.assignInWith=ao,d.assignWith=qv,d.at=Mv,d.before=xh,d.bind=Ua,d.bindAll=k0,d.bindKey=Ph,d.castArray=cv,d.chain=wh,d.chunk=vg,d.compact=mg,d.concat=_g,d.cond=K0,d.conforms=V0,d.constant=Wa,d.countBy=Oy,d.create=zv,d.curry=Sh,d.curryRight=Oh,d.debounce=Rh,d.defaults=Uv,d.defaultsDeep=Hv,d.defer=Yy,d.delay=Xy,d.difference=wg,d.differenceBy=bg,d.differenceWith=Eg,d.drop=Ig,d.dropRight=xg,d.dropRightWhile=Pg,d.dropWhile=Sg,d.fill=Og,d.filter=Ay,d.flatMap=Ny,d.flatMapDeep=$y,d.flatMapDepth=Dy,d.flatten=yh,d.flattenDeep=Rg,d.flattenDepth=Ag,d.flip=Zy,d.flow=W0,d.flowRight=J0,d.fromPairs=Tg,d.functions=Jv,d.functionsIn=Qv,d.groupBy=Fy,d.initial=Ng,d.intersection=$g,d.intersectionBy=Dg,d.intersectionWith=Fg,d.invert=Xv,d.invertBy=Zv,d.invokeMap=jy,d.iteratee=Ja,d.keyBy=qy,d.keys=Mt,d.keysIn=or,d.map=to,d.mapKeys=t0,d.mapValues=r0,d.matches=Q0,d.matchesProperty=Y0,d.memoize=io,d.merge=i0,d.mergeWith=qh,d.method=X0,d.methodOf=Z0,d.mixin=Qa,d.negate=no,d.nthArg=tm,d.omit=n0,d.omitBy=s0,d.once=ev,d.orderBy=My,d.over=rm,d.overArgs=tv,d.overEvery=im,d.overSome=nm,d.partial=Ha,d.partialRight=Ah,d.partition=zy,d.pick=o0,d.pickBy=Mh,d.property=Vh,d.propertyOf=sm,d.pull=Mg,d.pullAll=mh,d.pullAllBy=zg,d.pullAllWith=Ug,d.pullAt=Hg,d.range=om,d.rangeRight=am,d.rearg=rv,d.reject=By,d.remove=Bg,d.rest=iv,d.reverse=Ma,d.sampleSize=Ky,d.set=c0,d.setWith=u0,d.shuffle=Vy,d.slice=kg,d.sortBy=Jy,d.sortedUniq=Yg,d.sortedUniqBy=Xg,d.split=N0,d.spread=nv,d.tail=Zg,d.take=ey,d.takeRight=ty,d.takeRightWhile=ry,d.takeWhile=iy,d.tap=my,d.throttle=sv,d.thru=eo,d.toArray=Dh,d.toPairs=zh,d.toPairsIn=Uh,d.toPath=fm,d.toPlainObject=Lh,d.transform=h0,d.unary=ov,d.union=ny,d.unionBy=sy,d.unionWith=oy,d.uniq=ay,d.uniqBy=cy,d.uniqWith=uy,d.unset=l0,d.unzip=za,d.unzipWith=_h,d.update=f0,d.updateWith=p0,d.values=dn,d.valuesIn=d0,d.without=hy,d.words=kh,d.wrap=av,d.xor=ly,d.xorBy=fy,d.xorWith=py,d.zip=dy,d.zipObject=gy,d.zipObjectDeep=yy,d.zipWith=vy,d.entries=zh,d.entriesIn=Uh,d.extend=jh,d.extendWith=ao,Qa(d,d),d.add=dm,d.attempt=Kh,d.camelCase=m0,d.capitalize=Hh,d.ceil=gm,d.clamp=g0,d.clone=uv,d.cloneDeep=lv,d.cloneDeepWith=fv,d.cloneWith=hv,d.conformsTo=pv,d.deburr=Bh,d.defaultTo=G0,d.divide=ym,d.endsWith=_0,d.eq=Nr,d.escape=w0,d.escapeRegExp=b0,d.every=Ry,d.find=Ty,d.findIndex=dh,d.findKey=Bv,d.findLast=Cy,d.findLastIndex=gh,d.findLastKey=kv,d.floor=vm,d.forEach=bh,d.forEachRight=Eh,d.forIn=Kv,d.forInRight=Vv,d.forOwn=Gv,d.forOwnRight=Wv,d.get=Ka,d.gt=dv,d.gte=gv,d.has=Yv,d.hasIn=Va,d.head=vh,d.identity=ar,d.includes=Ly,d.indexOf=Cg,d.inRange=y0,d.invoke=e0,d.isArguments=Ui,d.isArray=_e,d.isArrayBuffer=yv,d.isArrayLike=sr,d.isArrayLikeObject=bt,d.isBoolean=vv,d.isBuffer=Ei,d.isDate=mv,d.isElement=_v,d.isEmpty=wv,d.isEqual=bv,d.isEqualWith=Ev,d.isError=Ba,d.isFinite=Iv,d.isFunction=ti,d.isInteger=Th,d.isLength=so,d.isMap=Ch,d.isMatch=xv,d.isMatchWith=Pv,d.isNaN=Sv,d.isNative=Ov,d.isNil=Av,d.isNull=Rv,d.isNumber=Nh,d.isObject=ut,d.isObjectLike=vt,d.isPlainObject=Mn,d.isRegExp=ka,d.isSafeInteger=Tv,d.isSet=$h,d.isString=oo,d.isSymbol=dr,d.isTypedArray=pn,d.isUndefined=Cv,d.isWeakMap=Nv,d.isWeakSet=$v,d.join=Lg,d.kebabCase=E0,d.last=xr,d.lastIndexOf=jg,d.lowerCase=I0,d.lowerFirst=x0,d.lt=Dv,d.lte=Fv,d.max=mm,d.maxBy=_m,d.mean=wm,d.meanBy=bm,d.min=Em,d.minBy=Im,d.stubArray=Xa,d.stubFalse=Za,d.stubObject=cm,d.stubString=um,d.stubTrue=hm,d.multiply=xm,d.nth=qg,d.noConflict=em,d.noop=Ya,d.now=ro,d.pad=P0,d.padEnd=S0,d.padStart=O0,d.parseInt=R0,d.random=v0,d.reduce=Uy,d.reduceRight=Hy,d.repeat=A0,d.replace=T0,d.result=a0,d.round=Pm,d.runInContext=O,d.sample=ky,d.size=Gy,d.snakeCase=C0,d.some=Wy,d.sortedIndex=Kg,d.sortedIndexBy=Vg,d.sortedIndexOf=Gg,d.sortedLastIndex=Wg,d.sortedLastIndexBy=Jg,d.sortedLastIndexOf=Qg,d.startCase=$0,d.startsWith=D0,d.subtract=Sm,d.sum=Om,d.sumBy=Rm,d.template=F0,d.times=lm,d.toFinite=ri,d.toInteger=we,d.toLength=Fh,d.toLower=L0,d.toNumber=Pr,d.toSafeInteger=Lv,d.toString=je,d.toUpper=j0,d.trim=q0,d.trimEnd=M0,d.trimStart=z0,d.truncate=U0,d.unescape=H0,d.uniqueId=pm,d.upperCase=B0,d.upperFirst=Ga,d.each=bh,d.eachRight=Eh,d.first=vh,Qa(d,function(){var e={};return Hr(d,function(i,s){Me.call(d.prototype,s)||(e[s]=i)}),e}(),{chain:!1}),d.VERSION=n,_r(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),_r(["drop","take"],function(e,i){Oe.prototype[e]=function(s){s=s===t?1:Lt(we(s),0);var u=this.__filtered__&&!i?new Oe(this):this.clone();return u.__filtered__?u.__takeCount__=Kt(s,u.__takeCount__):u.__views__.push({size:Kt(s,G),type:e+(u.__dir__<0?"Right":"")}),u},Oe.prototype[e+"Right"]=function(s){return this.reverse()[e](s).reverse()}}),_r(["filter","map","takeWhile"],function(e,i){var s=i+1,u=s==m||s==Y;Oe.prototype[e]=function(l){var y=this.clone();return y.__iteratees__.push({iteratee:se(l,3),type:s}),y.__filtered__=y.__filtered__||u,y}}),_r(["head","last"],function(e,i){var s="take"+(i?"Right":"");Oe.prototype[e]=function(){return this[s](1).value()[0]}}),_r(["initial","tail"],function(e,i){var s="drop"+(i?"":"Right");Oe.prototype[e]=function(){return this.__filtered__?new Oe(this):this[s](1)}}),Oe.prototype.compact=function(){return this.filter(ar)},Oe.prototype.find=function(e){return this.filter(e).head()},Oe.prototype.findLast=function(e){return this.reverse().find(e)},Oe.prototype.invokeMap=xe(function(e,i){return typeof e=="function"?new Oe(this):this.map(function(s){return $n(s,e,i)})}),Oe.prototype.reject=function(e){return this.filter(no(se(e)))},Oe.prototype.slice=function(e,i){e=we(e);var s=this;return s.__filtered__&&(e>0||i<0)?new Oe(s):(e<0?s=s.takeRight(-e):e&&(s=s.drop(e)),i!==t&&(i=we(i),s=i<0?s.dropRight(-i):s.take(i-e)),s)},Oe.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Oe.prototype.toArray=function(){return this.take(G)},Hr(Oe.prototype,function(e,i){var s=/^(?:filter|find|map|reject)|While$/.test(i),u=/^(?:head|last)$/.test(i),l=d[u?"take"+(i=="last"?"Right":""):i],y=u||/^find/.test(i);l&&(d.prototype[i]=function(){var w=this.__wrapped__,E=u?[1]:arguments,R=w instanceof Oe,q=E[0],M=R||_e(w),B=function(Pe){var Ae=l.apply(d,gi([Pe],E));return u&&J?Ae[0]:Ae};M&&s&&typeof q=="function"&&q.length!=1&&(R=M=!1);var J=this.__chain__,te=!!this.__actions__.length,oe=y&&!J,Ee=R&&!te;if(!y&&M){w=Ee?w:new Oe(this);var ae=e.apply(w,E);return ae.__actions__.push({func:eo,args:[B],thisArg:t}),new br(ae,J)}return oe&&Ee?e.apply(this,E):(ae=this.thru(B),oe?u?ae.value()[0]:ae.value():ae)})}),_r(["pop","push","shift","sort","splice","unshift"],function(e){var i=Ss[e],s=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",u=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(u&&!this.__chain__){var y=this.value();return i.apply(_e(y)?y:[],l)}return this[s](function(w){return i.apply(_e(w)?w:[],l)})}}),Hr(Oe.prototype,function(e,i){var s=d[i];if(s){var u=s.name+"";Me.call(cn,u)||(cn[u]=[]),cn[u].push({name:i,func:s})}}),cn[Gs(t,he).name]=[{name:"wrapper",func:t}],Oe.prototype.clone=Hp,Oe.prototype.reverse=Bp,Oe.prototype.value=kp,d.prototype.at=_y,d.prototype.chain=wy,d.prototype.commit=by,d.prototype.next=Ey,d.prototype.plant=xy,d.prototype.reverse=Py,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=Sy,d.prototype.first=d.prototype.head,Sn&&(d.prototype[Sn]=Iy),d},sn=bp();wt?((wt.exports=sn)._=sn,Ge._=sn):Re._=sn}).call(Vn)})($c,$c.exports);var YI=Object.defineProperty,XI=Object.defineProperties,ZI=Object.getOwnPropertyDescriptors,Wl=Object.getOwnPropertySymbols,ex=Object.prototype.hasOwnProperty,tx=Object.prototype.propertyIsEnumerable,Jl=(a,r,t)=>r in a?YI(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,fo=(a,r)=>{for(var t in r||(r={}))ex.call(r,t)&&Jl(a,t,r[t]);if(Wl)for(var t of Wl(r))tx.call(r,t)&&Jl(a,t,r[t]);return a},rx=(a,r)=>XI(a,ZI(r));function Si(a,r,t){var n;const o=p1(a);return((n=r.rpcMap)==null?void 0:n[o.reference])||`${QI}?chainId=${o.namespace}:${o.reference}&projectId=${t}`}function Gi(a){return a.includes(":")?a.split(":")[1]:a}function Qf(a){return a.map(r=>`${r.split(":")[0]}:${r.split(":")[1]}`)}function ix(a,r){const t=Object.keys(r.namespaces).filter(o=>o.includes(a));if(!t.length)return[];const n=[];return t.forEach(o=>{const c=r.namespaces[o].accounts;n.push(...c)}),n}function nx(a={},r={}){const t=Ql(a),n=Ql(r);return $c.exports.merge(t,n)}function Ql(a){var r,t,n,o;const c={};if(!yo(a))return c;for(const[f,g]of Object.entries(a)){const _=lf(f)?[f]:g.chains,p=g.methods||[],b=g.events||[],A=g.rpcMap||{},x=Gn(f);c[x]=rx(fo(fo({},c[x]),g),{chains:rc(_,(r=c[x])==null?void 0:r.chains),methods:rc(p,(t=c[x])==null?void 0:t.methods),events:rc(b,(n=c[x])==null?void 0:n.events),rpcMap:fo(fo({},A),(o=c[x])==null?void 0:o.rpcMap)})}return c}function sx(a){return a.includes(":")?a.split(":")[2]:a}function ox(a){const r={};for(const[t,n]of Object.entries(a)){const o=n.methods||[],c=n.events||[],f=n.accounts||[],g=lf(t)?[t]:n.chains?n.chains:Qf(n.accounts);r[t]={chains:g,methods:o,events:c,accounts:f}}return r}function dc(a){return typeof a=="number"?a:a.includes("0x")?parseInt(a,16):a.includes(":")?Number(a.split(":")[1]):Number(a)}const Yf={},st=a=>Yf[a],gc=(a,r)=>{Yf[a]=r};class ax{constructor(r){this.name="polkadot",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const o=Gi(t);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Si(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new hi(new Oi(n,st("disableProviderPing")))}}class cx{constructor(r){this.name="eip155",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(r){switch(r.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(r);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(r.request.method)?await this.client.request(r):this.getHttpProvider().request(r.request)}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(parseInt(r),t),this.chainId=parseInt(r),this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}createHttpProvider(r,t){const n=t||Si(`${this.name}:${r}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new hi(new Oi(n,st("disableProviderPing")))}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const o=parseInt(Gi(t));r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const r=this.chainId,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}async handleSwitchChain(r){var t,n;let o=r.request.params?(t=r.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:r.topic,request:{method:r.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(r){return this.namespace.chains.includes(`${this.name}:${r}`)}}class ux{constructor(r){this.name="solana",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const o=Gi(t);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Si(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new hi(new Oi(n,st("disableProviderPing")))}}class hx{constructor(r){this.name="cosmos",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const o=Gi(t);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Si(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new hi(new Oi(n,st("disableProviderPing")))}}class lx{constructor(r){this.name="cip34",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{const n=this.getCardanoRPCUrl(t),o=Gi(t);r[o]=this.createHttpProvider(o,n)}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}getCardanoRPCUrl(r){const t=this.namespace.rpcMap;if(t)return t[r]}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||this.getCardanoRPCUrl(r);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new hi(new Oi(n,st("disableProviderPing")))}}class fx{constructor(r){this.name="elrond",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const o=Gi(t);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Si(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new hi(new Oi(n,st("disableProviderPing")))}}class px{constructor(r){this.name="multiversx",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){this.httpProviders[r]||this.setHttpProvider(r,t),this.chainId=r,this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${r}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}getAccounts(){const r=this.namespace.accounts;return r?[...new Set(r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;const o=Gi(t);r[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Si(r,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);return new hi(new Oi(n,st("disableProviderPing")))}}class dx{constructor(r){this.name="near",this.namespace=r.namespace,this.events=st("events"),this.client=st("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(r){this.namespace=Object.assign(this.namespace,r)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const r=this.namespace.chains[0];if(!r)throw new Error("ChainId not found");return r.split(":")[1]}request(r){return this.namespace.methods.includes(r.request.method)?this.client.request(r):this.getHttpProvider().request(r.request)}setDefaultChain(r,t){if(this.chainId=r,!this.httpProviders[r]){const n=t||Si(`${this.name}:${r}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${r}`);this.setHttpProvider(r,n)}this.events.emit(li.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const r=this.namespace.accounts;return r?r.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const r={};return this.namespace.chains.forEach(t=>{var n;r[t]=this.createHttpProvider(t,(n=this.namespace.rpcMap)==null?void 0:n[t])}),r}getHttpProvider(){const r=`${this.name}:${this.chainId}`,t=this.httpProviders[r];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${r} not found`);return t}setHttpProvider(r,t){const n=this.createHttpProvider(r,t);n&&(this.httpProviders[r]=n)}createHttpProvider(r,t){const n=t||Si(r,this.namespace);return typeof n>"u"?void 0:new hi(new Oi(n,st("disableProviderPing")))}}var gx=Object.defineProperty,yx=Object.defineProperties,vx=Object.getOwnPropertyDescriptors,Yl=Object.getOwnPropertySymbols,mx=Object.prototype.hasOwnProperty,_x=Object.prototype.propertyIsEnumerable,Xl=(a,r,t)=>r in a?gx(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,po=(a,r)=>{for(var t in r||(r={}))mx.call(r,t)&&Xl(a,t,r[t]);if(Yl)for(var t of Yl(r))_x.call(r,t)&&Xl(a,t,r[t]);return a},yc=(a,r)=>yx(a,vx(r));class Gc{constructor(r){this.events=new qc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=r,this.logger=typeof r?.logger<"u"&&typeof r?.logger!="string"?r.logger:Te.pino(Te.getDefaultLoggerOptions({level:r?.logger||Vl})),this.disableProviderPing=r?.disableProviderPing||!1}static async init(r){const t=new Gc(r);return await t.initialize(),t}async request(r,t){const[n,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:po({},r),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(r,t,n){this.request(r,n).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var r;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(r=this.session)==null?void 0:r.topic,reason:tr("USER_DISCONNECTED")}),await this.cleanup()}async connect(r){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(r),await this.cleanupPendingPairings(),!r.skipPairing)return await this.pair(r.pairingTopic)}on(r,t){this.events.on(r,t)}once(r,t){this.events.once(r,t)}removeListener(r,t){this.events.removeListener(r,t)}off(r,t){this.events.off(r,t)}get isWalletConnect(){return!0}async pair(r){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:r,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=ox(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==Wf)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(r,t){try{if(!this.session)return;const[n,o]=this.validateChain(r);this.getProvider(n).setDefaultChain(o,t)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(r={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(_n(t)){for(const n of t)r.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const r=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[r]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await BI.init({logger:this.providerOpts.logger||Vl,relayUrl:this.providerOpts.relayUrl||GI,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const r=[...new Set(Object.keys(this.session.namespaces).map(t=>Gn(t)))];gc("client",this.client),gc("events",this.events),gc("disableProviderPing",this.disableProviderPing),r.forEach(t=>{if(!this.session)return;const n=ix(t,this.session),o=Qf(n),c=nx(this.namespaces,this.optionalNamespaces),f=yc(po({},c[t]),{accounts:n,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new cx({namespace:f});break;case"solana":this.rpcProviders[t]=new ux({namespace:f});break;case"cosmos":this.rpcProviders[t]=new hx({namespace:f});break;case"polkadot":this.rpcProviders[t]=new ax({namespace:f});break;case"cip34":this.rpcProviders[t]=new lx({namespace:f});break;case"elrond":this.rpcProviders[t]=new fx({namespace:f});break;case"multiversx":this.rpcProviders[t]=new px({namespace:f});break;case"near":this.rpcProviders[t]=new dx({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",r=>{this.events.emit("session_ping",r)}),this.client.on("session_event",r=>{const{params:t}=r,{event:n}=t;if(n.name==="accountsChanged"){const o=n.data;o&&_n(o)&&this.events.emit("accountsChanged",o.map(sx))}else if(n.name==="chainChanged"){const o=t.chainId,c=t.event.data,f=Gn(o),g=dc(o)!==dc(c)?`${f}:${dc(c)}`:o;this.onChainChanged(g)}else this.events.emit(n.name,n.data);this.events.emit("session_event",r)}),this.client.on("session_update",({topic:r,params:t})=>{var n;const{namespaces:o}=t,c=(n=this.client)==null?void 0:n.session.get(r);this.session=yc(po({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:r,params:t})}),this.client.on("session_delete",async r=>{await this.cleanup(),this.events.emit("session_delete",r),this.events.emit("disconnect",yc(po({},tr("USER_DISCONNECTED")),{data:r.topic}))}),this.on(li.DEFAULT_CHAIN_CHANGED,r=>{this.onChainChanged(r,!0)})}getProvider(r){if(!this.rpcProviders[r])throw new Error(`Provider not found: ${r}`);return this.rpcProviders[r]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(r=>{var t;this.getProvider(r).updateNamespace((t=this.session)==null?void 0:t.namespaces[r])})}setNamespaces(r){const{namespaces:t,optionalNamespaces:n,sessionProperties:o}=r;t&&Object.keys(t).length&&(this.namespaces=t),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",n)}validateChain(r){const[t,n]=r?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,n];if(t&&!Object.keys(this.namespaces||{}).map(f=>Gn(f)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&n)return[t,n];const o=Gn(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[r]=this.validateChain();return await this.getProvider(r).requestAccounts()}onChainChanged(r,t=!1){var n;if(!this.namespaces)return;const[o,c]=this.validateChain(r);t||this.getProvider(o).setDefaultChain(c),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(r,t){this.client.core.storage.setItem(`${Gl}/${r}`,t)}async getFromStore(r){return await this.client.core.storage.getItem(`${Gl}/${r}`)}}const wx=Gc,bx="wc",Ex="ethereum_provider",Ix=`${bx}@2:${Ex}:`,xx="https://rpc.walletconnect.com/v1/",Dc=["eth_sendTransaction","personal_sign"],Px=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Fc=["chainChanged","accountsChanged"],Sx=["chainChanged","accountsChanged","message","disconnect","connect"];var Ox=Object.defineProperty,Rx=Object.defineProperties,Ax=Object.getOwnPropertyDescriptors,Zl=Object.getOwnPropertySymbols,Tx=Object.prototype.hasOwnProperty,Cx=Object.prototype.propertyIsEnumerable,ef=(a,r,t)=>r in a?Ox(a,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[r]=t,Jn=(a,r)=>{for(var t in r||(r={}))Tx.call(r,t)&&ef(a,t,r[t]);if(Zl)for(var t of Zl(r))Cx.call(r,t)&&ef(a,t,r[t]);return a},tf=(a,r)=>Rx(a,Ax(r));function Eo(a){return Number(a[0].split(":")[1])}function vc(a){return`0x${a.toString(16)}`}function Nx(a){const{chains:r,optionalChains:t,methods:n,optionalMethods:o,events:c,optionalEvents:f,rpcMap:g}=a;if(!_n(r))throw new Error("Invalid chains");const _={chains:r,methods:n||Dc,events:c||Fc,rpcMap:Jn({},r.length?{[Eo(r)]:g[Eo(r)]}:{})},p=c?.filter(D=>!Fc.includes(D)),b=n?.filter(D=>!Dc.includes(D));if(!t&&!f&&!o&&!(p!=null&&p.length)&&!(b!=null&&b.length))return{required:r.length?_:void 0};const A=p?.length&&b?.length||!t,x={chains:[...new Set(A?_.chains.concat(t||[]):t)],methods:[...new Set(_.methods.concat(o!=null&&o.length?o:Px))],events:[...new Set(_.events.concat(f!=null&&f.length?f:Sx))],rpcMap:g};return{required:r.length?_:void 0,optional:t.length?x:void 0}}class Wc{constructor(){this.events=new Or.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=Ix,this.on=(r,t)=>(this.events.on(r,t),this),this.once=(r,t)=>(this.events.once(r,t),this),this.removeListener=(r,t)=>(this.events.removeListener(r,t),this),this.off=(r,t)=>(this.events.off(r,t),this),this.parseAccount=r=>this.isCompatibleChainId(r)?this.parseAccountId(r).address:r,this.signer={},this.rpc={}}static async init(r){const t=new Wc;return await t.initialize(r),t}async request(r){return await this.signer.request(r,this.formatChainId(this.chainId))}sendAsync(r,t){this.signer.sendAsync(r,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(r);const{required:t,optional:n}=Nx(this.rpc);try{const o=await new Promise(async(f,g)=>{var _;this.rpc.showQrModal&&((_=this.modal)==null||_.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(tf(Jn({namespaces:Jn({},t&&{[this.namespace]:t})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:r?.pairingTopic})).then(p=>{f(p)}).catch(p=>{g(new Error(p.message))})});if(!o)return;const c=d1(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:vc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",r=>{const{params:t}=r,{event:n}=t;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",r)}),this.signer.on("chainChanged",r=>{const t=parseInt(r);this.chainId=t,this.events.emit("chainChanged",vc(this.chainId)),this.persist()}),this.signer.on("session_update",r=>{this.events.emit("session_update",r)}),this.signer.on("session_delete",r=>{this.reset(),this.events.emit("session_delete",r),this.events.emit("disconnect",tf(Jn({},tr("USER_DISCONNECTED")),{data:r.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",r=>{var t,n;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(n=this.modal)==null||n.openModal({uri:r})),this.events.emit("display_uri",r)})}switchEthereumChain(r){this.request({method:"wallet_switchEthereumChain",params:[{chainId:r.toString(16)}]})}isCompatibleChainId(r){return typeof r=="string"?r.startsWith(`${this.namespace}:`):!1}formatChainId(r){return`${this.namespace}:${r}`}parseChainId(r){return Number(r.split(":")[1])}setChainIds(r){const t=r.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",vc(this.chainId)),this.persist())}setChainId(r){if(this.isCompatibleChainId(r)){const t=this.parseChainId(r);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(r){const[t,n,o]=r.split(":");return{chainId:`${t}:${n}`,address:o}}setAccounts(r){this.accounts=r.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(r){var t,n;const o=(t=r?.chains)!=null?t:[],c=(n=r?.optionalChains)!=null?n:[],f=o.concat(c);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=o.length?r?.methods||Dc:[],_=o.length?r?.events||Fc:[],p=r?.optionalMethods||[],b=r?.optionalEvents||[],A=r?.rpcMap||this.buildRpcMap(f,r.projectId),x=r?.qrModalOptions||void 0;return{chains:o?.map(D=>this.formatChainId(D)),optionalChains:c.map(D=>this.formatChainId(D)),methods:g,events:_,optionalMethods:p,optionalEvents:b,rpcMap:A,showQrModal:!!(r!=null&&r.showQrModal),qrModalOptions:x,projectId:r.projectId,metadata:r.metadata}}buildRpcMap(r,t){const n={};return r.forEach(o=>{n[o]=this.getRpcUrl(o,t)}),n}async initialize(r){if(this.rpc=this.getRpcConfig(r),this.chainId=this.rpc.chains.length?Eo(this.rpc.chains):Eo(this.rpc.optionalChains),this.signer=await wx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:r.disableProviderPing,relayUrl:r.relayUrl,storageOptions:r.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:n}=await g1(()=>import("./index-af32a62f.js").then(o=>o.i),["assets/index-af32a62f.js","assets/index-97e4a7ae.js","assets/index-86f5da52.css"]);t=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Jn({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(r){if(!r)return;const{chains:t,optionalChains:n,rpcMap:o}=r;t&&_n(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)})),n&&_n(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n?.map(c=>this.formatChainId(c)),n.forEach(c=>{this.rpc.rpcMap[c]=o?.[c]||this.getRpcUrl(c)}))}getRpcUrl(r,t){var n;return((n=this.rpc.rpcMap)==null?void 0:n[r])||`${xx}?chainId=eip155:${r}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const r=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${r}`]?this.session.namespaces[`${this.namespace}:${r}`]:this.session.namespaces[this.namespace];this.setChainIds(r?[this.formatChainId(r)]:t?.accounts),this.setAccounts(t?.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(r){return typeof r=="string"||r instanceof String?[this.parseAccount(r)]:r.map(t=>this.parseAccount(t))}}const Kx=Wc;export{Kx as EthereumProvider,Sx as OPTIONAL_EVENTS,Px as OPTIONAL_METHODS,Fc as REQUIRED_EVENTS,Dc as REQUIRED_METHODS,Wc as default};
